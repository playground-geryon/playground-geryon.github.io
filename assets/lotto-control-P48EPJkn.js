import{_ as re}from"./tree-sitter-aGyQ8e2w.js";import{r,F as oe}from"./vendor-CRMzTT1s.js";const se=async()=>{const c=await re(()=>import("./excel-CUMakpxJ.js").then(a=>a.e),[]);return c.default??c},ae="lotto_combinations_db",E="saved_combinations",P="list",j=()=>new Promise((c,a)=>{if(typeof indexedDB>"u"){a(new Error("IndexedDB is not available."));return}const m=indexedDB.open(ae,1);m.onupgradeneeded=()=>{const d=m.result;d.objectStoreNames.contains(E)||d.createObjectStore(E)},m.onsuccess=()=>c(m.result),m.onerror=()=>a(m.error??new Error("Failed to open IndexedDB."))}),ue=async()=>{const c=await j();return new Promise((a,m)=>{const d=c.transaction(E,"readonly"),g=d.objectStore(E).get(P);g.onsuccess=()=>{a(g.result??[])},g.onerror=()=>m(g.error??new Error("Failed to read combinations.")),d.oncomplete=()=>c.close(),d.onerror=()=>c.close(),d.onabort=()=>c.close()})},ce=async c=>{const a=await j();return new Promise((m,d)=>{const s=a.transaction(E,"readwrite"),h=s.objectStore(E).put(c,P);h.onsuccess=()=>m(),h.onerror=()=>d(h.error??new Error("Failed to write combinations.")),s.oncomplete=()=>a.close(),s.onerror=()=>a.close(),s.onabort=()=>a.close()})},le=c=>c.filter(a=>Array.isArray(a)&&a.length>=8).map(a=>({round:a[0],numbers:a.slice(1,7),bonus:a[7]})).sort((a,m)=>m.round-a.round),de=()=>{const[c,a]=r.useState(!0),[m,d]=r.useState(null),[s,g]=r.useState([]),[h,B]=r.useState("number"),[C,x]=r.useState([]),[b,k]=r.useState([]),[N,O]=r.useState(!1),[v,w]=r.useState(1),[p,I]=r.useState(15),[D,_]=r.useState({from:null,to:null});r.useEffect(()=>{let e=!0;return(async()=>{a(!0),d(null);try{const t=await fetch("/data/lotto.json",{cache:"no-cache"});if(!t.ok)throw new Error("데이터를 불러오지 못했습니다.");const o=await t.json();if(!e)return;g(le(o))}catch(t){if(!e)return;d(t instanceof Error?t.message:"알 수 없는 오류가 발생했습니다.")}finally{e&&a(!1)}})(),()=>{e=!1}},[]),r.useEffect(()=>{s.length&&_(e=>e.from!==null||e.to!==null?e:{from:s[s.length-1].round,to:s[0].round})},[s]),r.useEffect(()=>{if(typeof window>"u")return;let e=!0;return ue().then(n=>{e&&Array.isArray(n)&&k(n.filter(t=>Array.isArray(t.numbers)&&t.numbers.length===6))}).catch(()=>{}).finally(()=>{e&&O(!0)}),()=>{e=!1}},[]),r.useEffect(()=>{typeof window>"u"||N&&ce(b).catch(()=>{})},[b,N]);const L=r.useMemo(()=>s.length?{min:s[s.length-1].round,max:s[0].round}:{min:null,max:null},[s]),S=r.useMemo(()=>{let e=D.from,n=D.to;return e!==null&&n!==null&&e>n&&([e,n]=[n,e]),{from:e,to:n}},[D]),l=r.useMemo(()=>s.filter(e=>!(S.from!==null&&e.round<S.from||S.to!==null&&e.round>S.to)),[s,S]),A=l.length,R=r.useMemo(()=>A*6,[A]),y=r.useMemo(()=>{const e=Array.from({length:45},()=>0);return l.forEach(n=>{n.numbers.forEach(t=>{t>=1&&t<=45&&(e[t-1]+=1)})}),e.map((n,t)=>({number:t+1,count:n,percent:R?n/R*100:0}))},[l,R]),T=r.useMemo(()=>{const e=Array.from({length:45},()=>0);return s.forEach(n=>{n.numbers.forEach(t=>{t>=1&&t<=45&&(e[t-1]+=1)})}),e.map((n,t)=>({number:t+1,count:n}))},[s]),q=r.useMemo(()=>{const e=[...y];return h==="frequency"&&e.sort((n,t)=>t.count===n.count?n.number-t.number:t.count-n.count),e},[y,h]),z=r.useMemo(()=>y.filter(e=>e.count===0).map(e=>e.number),[y]),J=r.useMemo(()=>{if(!l.length)return Array.from({length:45},(t,o)=>({number:o+1,streak:0}));const e=[...l].sort((t,o)=>o.round-t.round),n=Array.from({length:45},(t,o)=>{const i=o+1;let u=0;for(const f of e){if(f.numbers.includes(i))break;u+=1}return{number:i,streak:u}});return n.sort((t,o)=>o.streak===t.streak?t.number-o.number:o.streak-t.streak),n},[l]),W=r.useMemo(()=>{if(!l.length)return{avgSum:0,avgOdd:0,avgEven:0};let e=0,n=0;l.forEach(u=>{e+=u.numbers.reduce((f,F)=>f+F,0),n+=u.numbers.filter(f=>f%2===1).length});const t=e/l.length,o=n/l.length,i=6-o;return{avgSum:t,avgOdd:o,avgEven:i}},[l]),M=r.useMemo(()=>C.length?l.filter(e=>C.every(n=>e.numbers.includes(n))):l,[l,C]),Y=r.useMemo(()=>{const e=(v-1)*p;return M.slice(e,e+p)},[M,v,p]),$=Math.max(1,Math.ceil(M.length/p)),H=r.useCallback(e=>{x(n=>n.includes(e)?n.filter(t=>t!==e):n.length>=6?n:[...n,e]),w(1)},[]),K=r.useCallback(()=>{x([]),w(1)},[]),V=r.useCallback(e=>{const n=[...e].sort((t,o)=>t-o).slice(0,6);x(n),w(1)},[]),G=r.useCallback((e,n)=>{const t=[...e].sort((u,f)=>u-f);if(t.length!==6)return{ok:!1,message:"번호 6개를 선택하세요."};const o=t.join(",");if(b.some(u=>u.numbers.join(",")===o))return{ok:!1,message:"이미 저장된 조합입니다."};const i={id:`${Date.now()}_${Math.random().toString(16).slice(2)}`,createdAt:new Date().toISOString(),numbers:t,isFavorite:!1,memo:n?.trim()||""};return k(u=>[i,...u]),{ok:!0,message:"조합을 저장했습니다."}},[b]),Q=r.useCallback(e=>{k(n=>n.map(t=>t.id===e?{...t,isFavorite:!t.isFavorite}:t))},[]),U=r.useCallback((e,n)=>{k(t=>t.map(o=>o.id===e?{...o,memo:n}:o))},[]),X=r.useCallback(e=>{k(n=>n.filter(t=>t.id!==e))},[]),Z=r.useCallback(async()=>{if(!b.length)return{ok:!1,message:"저장된 조합이 없습니다."};const e=await se(),n=new e.Workbook,t=n.addWorksheet("Combinations");t.addRow(["No","CreatedAt","Title/Memo","Numbers","Favorite","n1","n2","n3","n4","n5","n6"]),b.forEach((i,u)=>{t.addRow([u+1,new Date(i.createdAt).toLocaleString(),i.memo??"",i.numbers.join(", "),i.isFavorite?"Y":"N",...i.numbers])}),t.columns?.forEach(i=>{let u=10;i.eachCell?.({includeEmpty:!0},f=>{const F=f.value==null?"":f.value.toString();u=Math.max(u,F.length)}),i.width=Math.min(40,Math.max(10,u+2))});const o=await n.xlsx.writeBuffer();return oe.saveAs(new Blob([o]),"lotto-combinations.xlsx"),{ok:!0,message:"엑셀로 내보냈습니다."}},[b]),ee=r.useCallback((e,n)=>{_(t=>{const o={...t,[e]:n};return o.from!==null&&o.to!==null&&o.from>o.to&&(e==="from"?o.to=n:o.from=n),o}),w(1)},[]),te=r.useCallback(()=>{s.length&&(_({from:s[s.length-1].round,to:s[0].round}),w(1))},[s]),ne=r.useCallback((e,n)=>{w(n)},[]);return{loading:c,error:m,draws:s,rangeFilteredDraws:l,roundBounds:L,roundRange:S,updateRoundRange:ee,resetFilters:te,rangeDrawCount:A,sortedStats:q,numberStats:y,allNumberStats:T,sortMode:h,setSortMode:B,selectedNumbers:C,toggleNumber:H,clearSelection:K,applyCombination:V,savedCombinations:b,saveCombination:G,toggleFavorite:Q,updateCombinationMemo:U,deleteCombination:X,exportCombinations:Z,paginatedDraws:Y,filteredDraws:M,page:v,pageCount:$,itemsPerPage:p,setItemsPerPage:I,handlePageChange:ne,neverDrawnNumbers:z,consecutiveMisses:J,patternSummary:W}};export{de as u};

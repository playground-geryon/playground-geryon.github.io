import{j as e,r as l}from"./vendor-CRMzTT1s.js";import{L as Le,u as Ae}from"./lotto-memo-dialog-DxJIdAft.js";import{as as Be,B as t,T as r,I as w,N as $e,S as i,o as $,a as d,bJ as Ee,a6 as ie,a7 as I,P as E,Y as q,bK as qe,bL as Ye,bM as _e,ba as Je,a1 as ee,y as Xe,z as B,g as se,bN as ne,bO as z,$ as Ge,bP as te,C as Ke,aJ as Ue,a3 as Qe}from"./mui-BTFQHN8y.js";import"./excel-CUMakpxJ.js";import"./tree-sitter-aGyQ8e2w.js";const Ve=({open:p,comboSearch:M,comboSort:h,savedCombinations:b,sortedCombinations:m,onClose:g,onOpen:u,onComboSearchChange:k,onComboSortChange:D,onExportCombinations:T,onClearCombinations:j,onApplyCombination:f,onToggleFavorite:P,onOpenMemoDialog:W,onDeleteCombination:R})=>e.jsxs(Be,{anchor:"bottom",open:p,onOpen:u,onClose:g,disableDiscovery:!0,swipeAreaWidth:56,ModalProps:{keepMounted:!0},PaperProps:{sx:{borderTopLeftRadius:16,borderTopRightRadius:16,maxHeight:"85vh",overflow:"hidden"}},children:[e.jsxs(t,{sx:{position:"relative",display:"flex",alignItems:"center",justifyContent:"space-between",px:2,pt:1.5,pb:1},children:[e.jsx(t,{sx:{width:36,height:4,borderRadius:999,bgcolor:"divider",position:"absolute",left:"50%",top:8,transform:"translateX(-50%)"}}),e.jsx(r,{variant:"subtitle1",fontWeight:600,children:"내 조합"}),e.jsx(w,{size:"small",onClick:g,children:e.jsx($e,{fontSize:"small"})})]}),e.jsx(t,{sx:{px:2,pb:2,overflowY:"auto"},children:e.jsxs(i,{spacing:1.25,children:[e.jsxs(i,{spacing:.75,children:[e.jsx($,{size:"small",fullWidth:!0,placeholder:"메모 검색",value:M,onChange:a=>k(a.target.value),sx:{"& .MuiInputBase-root":{height:32,fontSize:12}}}),e.jsxs(i,{direction:"row",spacing:1,alignItems:"center",justifyContent:"space-between",children:[e.jsx(d,{variant:"outlined",size:"small",color:"error",onClick:j,disabled:!b.length,sx:{height:32},children:"전체 삭제"}),e.jsxs(i,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(d,{variant:"outlined",size:"small",startIcon:e.jsx(Ee,{fontSize:"small"}),onClick:T,disabled:!b.length,sx:{height:32},children:"엑셀 내보내기"}),e.jsxs(ie,{size:"small",value:h,onChange:a=>D(a.target.value),sx:{minWidth:120,height:32,fontSize:12},children:[e.jsx(I,{value:"recent",children:"최신순"}),e.jsx(I,{value:"favorite",children:"즐겨찾기 우선"}),e.jsx(I,{value:"memo",children:"메모 우선"})]})]})]})]}),m.length?e.jsx(i,{spacing:1,children:m.map(a=>e.jsx(E,{variant:"outlined",sx:{p:1.25},children:e.jsxs(i,{spacing:.75,children:[e.jsxs(t,{onClick:()=>f(a.numbers),sx:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:1,cursor:"pointer"},children:[e.jsx(i,{direction:"row",spacing:.5,flexWrap:"wrap",children:a.numbers.map(c=>e.jsx(q,{size:"small",label:c},`${a.id}-${c}`))}),e.jsxs(i,{direction:"row",spacing:.5,alignItems:"center",children:[e.jsx(w,{size:"small",onClick:c=>{c.stopPropagation(),P(a.id)},children:a.isFavorite?e.jsx(qe,{fontSize:"small"}):e.jsx(Ye,{fontSize:"small"})}),e.jsx(w,{size:"small",onClick:c=>{c.stopPropagation(),W(a.id,a.memo)},children:e.jsx(_e,{fontSize:"small"})}),e.jsx(w,{size:"small",color:"error",onClick:c=>{c.stopPropagation(),R(a.id)},children:e.jsx(Je,{fontSize:"small"})})]})]}),e.jsx(r,{variant:"caption",color:"text.secondary",noWrap:!0,sx:{textOverflow:"ellipsis",overflow:"hidden"},children:a.memo?.trim()?a.memo:"메모 없음"})]})},a.id))}):e.jsx(r,{variant:"body2",color:"text.secondary",children:"저장된 조합이 없습니다. 번호 6개 선택 후 ‘조합 저장’을 눌러보세요."})]})})]}),Ze=({controller:p})=>{const{loading:M,error:h,sortedStats:b,sortMode:m,setSortMode:g,selectedNumbers:u,toggleNumber:k,clearSelection:D,applyCombination:T,savedCombinations:j,saveCombination:f,toggleFavorite:P,updateCombinationMemo:W,deleteCombination:R,exportCombinations:a,clearCombinations:c,paginatedDraws:re,filteredDraws:ae,allNumberStats:Y,page:oe,pageCount:le,itemsPerPage:ce,setItemsPerPage:de,handlePageChange:me,roundRange:_,updateRoundRange:J,roundBounds:v,resetFilters:xe,rangeDrawCount:C,neverDrawnNumbers:X,consecutiveMisses:ue,patternSummary:O}=p,[y,pe]=l.useState("stats"),[ge,F]=l.useState(!1),[N,he]=l.useState(""),[H,be]=l.useState("recent"),[je,L]=l.useState(!1),[G,fe]=l.useState(null),[K,U]=l.useState(""),[S,Q]=l.useState([]),[A,x]=l.useState({open:!1,message:"",severity:"success"}),ve=ae.length,Ce=C?O.avgSum.toFixed(1):"-",ye=C?O.avgOdd.toFixed(1):"-",Se=C?O.avgEven.toFixed(1):"-",we=u.length===6,ze=S.length===6,Ie=[...j.filter(s=>N.trim()?(s.memo??"").toLowerCase().includes(N.trim().toLowerCase()):!0)].sort((s,n)=>{if(H==="favorite"&&s.isFavorite!==n.isFavorite)return s.isFavorite?-1:1;if(H==="memo"){const o=(s.memo??"").trim().length>0,He=(n.memo??"").trim().length>0;if(o!==He)return o?-1:1}return new Date(n.createdAt).getTime()-new Date(s.createdAt).getTime()}),V=l.useMemo(()=>{const s=new Map;return Y.forEach(n=>{s.set(n.number,n.count)}),s},[Y]),Z=l.useMemo(()=>{const s=X.map(n=>({number:n,count:V.get(n)??0}));return m==="frequency"?s.sort((n,o)=>o.count===n.count?n.number-o.number:o.count-n.count):s.sort((n,o)=>n.number-o.number),s},[X,V,m]),Me=()=>{const s=f(u);x({open:!0,message:s.message,severity:s.ok?"success":"error"})},ke=()=>{const s=f(S);x({open:!0,message:s.message,severity:s.ok?"success":"error"})},De=async()=>{const s=await a();x({open:!0,message:s.message,severity:s.ok?"success":"error"})},Te=s=>{window.confirm("선택한 조합을 삭제할까요?")&&R(s)},Pe=()=>{window.confirm("저장된 조합을 모두 삭제할까요?")&&(c(),x({open:!0,message:"저장된 조합을 모두 삭제했습니다.",severity:"success"}))},We=s=>{T(s),x({open:!0,message:"조합이 적용되었습니다.",severity:"success"})},Re=(s,n)=>{fe(s),U(n??""),L(!0)},Oe=()=>{G&&(W(G,K),L(!1))},Fe=s=>{Q(n=>n.includes(s)?n.filter(o=>o!==s):n.length>=6?n:[...n,s])},Ne=()=>{Q([])};return e.jsxs(t,{sx:{display:"flex",flexDirection:"column",gap:1.25,flex:1,minHeight:0,height:"100%",width:1,maxWidth:"100%",overflowX:"hidden"},children:[h&&e.jsx(ee,{severity:"error",children:h}),e.jsx(E,{sx:{p:2,borderRadius:1,overflow:"hidden"},children:e.jsxs(i,{spacing:1.25,children:[e.jsxs(i,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(i,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx($,{size:"small",type:"number",label:"시작 회차",value:_.from??"",inputProps:{min:v.min??void 0,max:v.max??void 0,inputMode:"numeric"},onChange:s=>J("from",s.target.value?Number(s.target.value):null),sx:{width:110}}),e.jsx($,{size:"small",type:"number",label:"끝 회차",value:_.to??"",inputProps:{min:v.min??void 0,max:v.max??void 0,inputMode:"numeric"},onChange:s=>J("to",s.target.value?Number(s.target.value):null),sx:{width:110}})]}),e.jsx(d,{variant:"outlined",size:"small",onClick:xe,children:"필터 초기화"})]}),e.jsx(i,{direction:"row",spacing:1})]})}),e.jsxs(E,{sx:{p:2,borderRadius:1,overflow:"hidden",minHeight:0},children:[e.jsxs(Xe,{value:y,onChange:(s,n)=>pe(n),variant:"fullWidth",textColor:"primary",indicatorColor:"primary",sx:{minHeight:36},children:[e.jsx(B,{value:"stats",label:"번호 통계",sx:{minHeight:36,py:.5,fontWeight:600}}),e.jsx(B,{value:"missing",label:"미출현번호",sx:{minHeight:36,py:.5,fontWeight:600}}),e.jsx(B,{value:"streak",label:"연속 미출현",sx:{minHeight:36,py:.5,fontWeight:600}})]}),e.jsx(se,{sx:{my:1}}),y==="stats"&&e.jsxs(i,{spacing:1.25,children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsxs(ne,{size:"small",exclusive:!0,value:m,onChange:(s,n)=>n&&g(n),"aria-label":"정렬 기준",children:[e.jsx(z,{value:"number",children:"번호순"}),e.jsx(z,{value:"frequency",children:"당첨순"})]}),e.jsxs(t,{sx:{display:"flex",gap:1,ml:"auto"},children:[e.jsx(d,{size:"small",variant:"outlined",startIcon:e.jsx(Ge,{fontSize:"small"}),onClick:()=>F(!0),children:"내 조합"}),e.jsx(d,{size:"small",variant:"outlined",startIcon:e.jsx(te,{fontSize:"small"}),onClick:Me,disabled:!we,children:"조합 저장"}),e.jsx(d,{size:"small",variant:"outlined",onClick:D,disabled:!u.length,children:"선택 초기화"})]})]}),e.jsx(t,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:[{label:"평균 번호 합",value:Ce},{label:"평균 홀수",value:ye},{label:"평균 짝수",value:Se}].map((s,n,o)=>e.jsxs(t,{sx:{pr:1,borderRight:n<o.length-1?"1px solid":"none",borderColor:"divider",minWidth:72},children:[e.jsx(r,{variant:"subtitle2",children:s.value}),e.jsx(r,{variant:"caption",color:"text.secondary",children:s.label})]},s.label))}),e.jsx(t,{sx:{minHeight:0,overflowY:"auto",display:"grid",gridTemplateColumns:"repeat(6, minmax(0, 1fr))",gap:.75,maxHeight:360},children:b.map(s=>{const n=u.includes(s.number);return e.jsxs(t,{onClick:()=>k(s.number),sx:{borderRadius:1,border:"1px solid",borderColor:n?"primary.main":"divider",bgcolor:n?"primary.main":"background.paper",color:n?"primary.contrastText":"text.primary",p:.5,cursor:"pointer",transition:"all 0.15s ease",aspectRatio:"1 / 1",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:.25},children:[e.jsx(r,{variant:"subtitle2",fontWeight:700,children:s.number.toString().padStart(2,"0")}),e.jsxs(r,{variant:"caption",sx:{opacity:.7},children:[s.count,"회"]})]},s.number)})}),e.jsx(se,{sx:{my:.5}}),e.jsxs(i,{spacing:1,children:[e.jsxs(t,{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:1,children:[e.jsx(r,{variant:"subtitle2",fontWeight:700,children:"추첨 결과"}),e.jsxs(r,{variant:"caption",color:"text.secondary",children:["총 ",ve.toLocaleString(),"회"]})]}),e.jsx(t,{sx:{minHeight:0},children:M?e.jsx(t,{sx:{display:"flex",alignItems:"center",justifyContent:"center",py:2},children:e.jsx(Ke,{size:24})}):e.jsx(i,{spacing:.75,children:re.map(s=>e.jsxs(t,{sx:{display:"grid",gridTemplateColumns:"64px 1fr 36px",alignItems:"center",gap:1,borderBottom:"1px solid",borderColor:"divider",pb:.5},children:[e.jsxs(r,{variant:"caption",color:"text.secondary",children:[s.round,"회"]}),e.jsx(i,{direction:"row",spacing:.5,flexWrap:"wrap",children:s.numbers.map(n=>e.jsx(q,{size:"small",label:n,sx:{borderRadius:"50%",width:32,height:32,"& .MuiChip-label":{px:0,textAlign:"center",width:"100%"}}},`draw-${s.round}-${n}`))}),e.jsx(q,{size:"small",color:"warning",label:s.bonus,sx:{borderRadius:"50%",width:32,height:32,"& .MuiChip-label":{px:0,textAlign:"center",width:"100%"}}})]},`draw-${s.round}`))})}),e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:1},children:[e.jsxs(i,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(r,{variant:"body2",color:"text.secondary",children:"페이지당"}),e.jsx(ie,{size:"small",value:ce,onChange:s=>de(Number(s.target.value)),children:[5,10,15,20,30,50].map(s=>e.jsxs(I,{value:s,children:[s,"개"]},s))})]}),e.jsx(Ue,{count:le,page:oe,onChange:me,color:"primary"})]})]})]}),y==="missing"&&e.jsxs(i,{spacing:1,children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsxs(ne,{size:"small",exclusive:!0,value:m,onChange:(s,n)=>n&&g(n),"aria-label":"정렬 기준",children:[e.jsx(z,{value:"number",children:"번호순"}),e.jsx(z,{value:"frequency",children:"당첨순"})]}),e.jsxs(t,{sx:{display:"flex",gap:1,ml:"auto"},children:[e.jsx(d,{size:"small",variant:"outlined",startIcon:e.jsx(te,{fontSize:"small"}),onClick:ke,disabled:!ze,children:"조합 저장"}),e.jsx(d,{size:"small",variant:"outlined",onClick:Ne,disabled:!S.length,children:"선택 초기화"})]})]}),Z.length?e.jsxs(i,{spacing:.75,children:[e.jsx(r,{variant:"caption",color:"text.secondary",children:"당첨 회수"}),e.jsx(t,{sx:{minHeight:0,display:"grid",gridTemplateColumns:"repeat(6, minmax(0, 1fr))",gap:.75},children:Z.map(s=>{const n=S.includes(s.number);return e.jsxs(t,{onClick:()=>Fe(s.number),sx:{borderRadius:1,border:"1px solid",borderColor:n?"primary.main":"divider",bgcolor:n?"primary.main":"background.paper",color:n?"primary.contrastText":"text.primary",p:.5,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:.25,aspectRatio:"1 / 1",cursor:"pointer",transition:"all 0.15s ease"},children:[e.jsx(r,{variant:"subtitle2",fontWeight:700,children:s.number.toString().padStart(2,"0")}),e.jsxs(r,{variant:"caption",sx:{opacity:.7},children:[s.count,"회"]})]},`missing-${s.number}`)})})]}):e.jsx(r,{variant:"body2",color:"text.secondary",children:"지정된 범위에 없는 번호가 없습니다."})]}),y==="streak"&&e.jsx(i,{spacing:1,children:C?e.jsx(i,{spacing:.75,children:ue.map(s=>e.jsxs(t,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",borderBottom:"1px solid",borderColor:"divider",pb:.5},children:[e.jsx(r,{variant:"body2",fontWeight:600,children:s.number.toString().padStart(2,"0")}),e.jsx(r,{variant:"body2",color:"text.secondary",children:s.streak===0?"최근 등장":`${s.streak}회 연속 미출현`})]},`streak-list-${s.number}`))}):e.jsx(r,{variant:"body2",color:"text.secondary",children:"표시할 데이터가 없습니다."})})]}),e.jsx(Ve,{open:ge,onOpen:()=>F(!0),onClose:()=>F(!1),comboSearch:N,comboSort:H,savedCombinations:j,sortedCombinations:Ie,onComboSearchChange:he,onComboSortChange:be,onExportCombinations:De,onClearCombinations:Pe,onApplyCombination:We,onToggleFavorite:P,onOpenMemoDialog:Re,onDeleteCombination:Te}),e.jsx(Le,{open:je,memoDraft:K,onChange:U,onClose:()=>L(!1),onSave:Oe}),e.jsx(Qe,{open:A.open,autoHideDuration:2400,onClose:()=>x(s=>({...s,open:!1})),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(ee,{severity:A.severity,onClose:()=>x(s=>({...s,open:!1})),variant:"filled",children:A.message})})]})},as=()=>{const p=Ae();return e.jsx(Ze,{controller:p})};export{as as default};

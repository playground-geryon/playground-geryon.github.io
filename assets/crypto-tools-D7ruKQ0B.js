import{v as e,r as i,j as r}from"./vendor-CRMzTT1s.js";import{M as X}from"./monaco-editor-CJz8LXZx.js";import{u as ge,q as me,P as be,B as f,S as y,a4 as K,a5 as G,a6 as J,a7 as Q,o as W,a as T,l as fe,m as ye,n as Se,p as ve,T as M}from"./mui-DQUFsC14.js";import"./excel-CUMakpxJ.js";import"./tree-sitter-aGyQ8e2w.js";const xe=(t,d,l,n)=>{const a=e.enc.Utf8.parse(d),s={padding:e.pad.Pkcs7};switch(n.includes("CBC")&&(s.mode=e.mode.CBC,l&&(s.iv=e.enc.Utf8.parse(l))),n.includes("ECB")&&(s.mode=e.mode.ECB),!0){case n.startsWith("AES"):return e.AES.encrypt(t,a,s).toString();case n.startsWith("DES"):return e.DES.encrypt(t,a,s).toString();case n.startsWith("TripleDES"):return e.TripleDES.encrypt(t,a,s).toString();case n==="Rabbit":return e.Rabbit.encrypt(t,a,s).toString();case n==="RabbitLegacy":return e.RabbitLegacy.encrypt(t,a,s).toString();case n==="RC4":return e.RC4.encrypt(t,a,s).toString();case n==="RC4Drop":return e.RC4Drop.encrypt(t,a,s).toString();default:throw new Error("지원하지 않는 알고리즘")}},Ce=(t,d,l,n)=>{const a=e.enc.Utf8.parse(d),s={padding:e.pad.Pkcs7};n.includes("CBC")&&(s.mode=e.mode.CBC,l&&(s.iv=e.enc.Utf8.parse(l))),n.includes("ECB")&&(s.mode=e.mode.ECB);let c;switch(!0){case n.startsWith("AES"):c=e.AES.decrypt(t,a,s);break;case n.startsWith("DES"):c=e.DES.decrypt(t,a,s);break;case n.startsWith("TripleDES"):c=e.TripleDES.decrypt(t,a,s);break;case n==="Rabbit":c=e.Rabbit.decrypt(t,a,s);break;case n==="RabbitLegacy":c=e.RabbitLegacy.decrypt(t,a,s);break;case n==="RC4":c=e.RC4.decrypt(t,a,s);break;case n==="RC4Drop":c=e.RC4Drop.decrypt(t,a,s);break;default:throw new Error("지원하지 않는 알고리즘")}return c.toString(e.enc.Utf8)},Ee=(t,d,l="")=>{const n=`${t}${l}`;switch(d){case"SHA1":return e.SHA1(n).toString();case"SHA512":return e.SHA512(n).toString();case"MD5":return e.MD5(n).toString();case"SHA3":return e.SHA3(n,{outputLength:512}).toString();case"RIPEMD160":return e.RIPEMD160(n).toString();case"SHA256":default:return e.SHA256(n).toString()}},Y=(t,d,l)=>{switch(d){case"BASE64":return l==="encode"?e.enc.Base64.stringify(e.enc.Utf8.parse(t)):e.enc.Base64.parse(t).toString(e.enc.Utf8);case"BASE64_NOPAD":return l==="encode"?e.enc.Base64.stringify(e.enc.Utf8.parse(t)).replace(/=+$/u,""):e.enc.Base64.parse(t.padEnd(t.length+(4-t.length%4)%4,"=")).toString(e.enc.Utf8);case"BASE64_URLSAFE":{if(l==="encode")return e.enc.Base64.stringify(e.enc.Utf8.parse(t)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/u,"");const n=t.replace(/-/g,"+").replace(/_/g,"/"),a=(4-n.length%4)%4,s=n+"=".repeat(a);return e.enc.Base64.parse(s).toString(e.enc.Utf8)}case"BASE64_URLSAFE_PAD":{if(l==="encode")return e.enc.Base64.stringify(e.enc.Utf8.parse(t)).replace(/\+/g,"-").replace(/\//g,"_");const n=t.replace(/-/g,"+").replace(/_/g,"/");return e.enc.Base64.parse(n).toString(e.enc.Utf8)}case"URL":return l==="encode"?encodeURIComponent(t):decodeURIComponent(t);default:throw new Error("지원하지 않는 인코딩 유형입니다.")}},E={symmetric:{label:"양방향 (대칭키)",description:"동일한 키와 IV로 암호화/복호화합니다.",algorithms:[{label:"AES-128 (CBC)",value:"AES-128-CBC",keyLength:16,ivRequired:!0},{label:"AES-128 (ECB)",value:"AES-128-ECB",keyLength:16,ivRequired:!1},{label:"AES-192 (CBC)",value:"AES-192-CBC",keyLength:24,ivRequired:!0},{label:"AES-192 (ECB)",value:"AES-192-ECB",keyLength:24,ivRequired:!1},{label:"AES-256 (CBC)",value:"AES-256-CBC",keyLength:32,ivRequired:!0},{label:"AES-256 (ECB)",value:"AES-256-ECB",keyLength:32,ivRequired:!1},{label:"DES (CBC)",value:"DES-CBC",keyLength:8,ivRequired:!0},{label:"3DES (CBC)",value:"TripleDES-CBC",keyLength:24,ivRequired:!0},{label:"Rabbit",value:"Rabbit",keyLength:16,ivRequired:!1},{label:"Rabbit Legacy",value:"RabbitLegacy",keyLength:16,ivRequired:!1},{label:"RC4",value:"RC4",keyLength:16,ivRequired:!1},{label:"RC4Drop",value:"RC4Drop",keyLength:16,ivRequired:!1}]},oneway:{label:"단방향 (해시)",description:"복호화가 불가능한 해시 알고리즘입니다.",algorithms:[{label:"SHA-256 (256bit)",value:"SHA256"},{label:"SHA-512 (512bit)",value:"SHA512"},{label:"MD5 (128bit)",value:"MD5"},{label:"SHA-1 (160bit)",value:"SHA1"},{label:"SHA-3 (512bit)",value:"SHA3"},{label:"RIPEMD160",value:"RIPEMD160"}]},encoding:{label:"인코딩/디코딩",description:"Base64·URL 인코딩을 빠르게 확인합니다.",algorithms:[{label:"Base64",value:"BASE64"},{label:"Base64 (No Padding)",value:"BASE64_NOPAD"},{label:"Base64 (URL-Safe)",value:"BASE64_URLSAFE"},{label:"Base64 (URL-Safe + Padding)",value:"BASE64_URLSAFE_PAD"},{label:"URL Encoding",value:"URL"}]}},Re=()=>{const[t,d]=i.useState("symmetric"),[l,n]=i.useState(E.symmetric.algorithms[0]?.value??""),[a,s]=i.useState(""),[c,R]=i.useState(""),[k,L]=i.useState(""),b=i.useMemo(()=>E[t].algorithms.find(h=>h.value===l),[t,l]),g=i.useCallback(()=>{s(""),R(""),L("")},[]),I=i.useCallback(h=>{d(h);const u=E[h].algorithms[0]?.value??"";n(u),s(""),R(""),L("")},[]),x=i.useCallback(()=>b?b.keyLength&&a.length!==b.keyLength?`키는 ${b.keyLength}자리를 정확히 맞춰주세요.`:b.ivRequired&&c.length!==16?"IV는 16자리를 입력해야 합니다.":null:"알고리즘을 다시 선택해 주세요.",[c.length,a.length,b]),j=i.useCallback(h=>{if(!h.trim())return{ok:!1,error:"먼저 입력값을 채워주세요."};try{if(t==="symmetric"){const u=x();return u?{ok:!1,error:u}:{ok:!0,value:xe(h,a,c,l)}}return t==="encoding"?{ok:!0,value:Y(h,l,"encode")}:{ok:!0,value:Ee(h,l,k)}}catch(u){return console.error(u),{ok:!1,error:"암호화 처리 중 오류가 발생했습니다."}}},[c,a,t,k,x,l]),S=i.useCallback(h=>{if(t==="oneway")return{ok:!1,error:"단방향(해시)은 복호화할 수 없습니다."};if(!h.trim())return{ok:!1,error:"복호화할 값을 입력하세요."};try{if(t==="encoding")return{ok:!0,value:Y(h,l,"decode")};const u=x();return u?{ok:!1,error:u}:{ok:!0,value:Ce(h,a,c,l)}}catch(u){return console.error(u),{ok:!1,error:"복호화에 실패했습니다. 키/IV/암호문을 확인하세요."}}},[c,a,t,x,l]);return{mode:t,setMode:I,variant:l,setVariant:n,key:a,setKey:s,iv:c,setIv:R,salt:k,setSalt:L,selectedAlgorithm:b,groupMeta:E[t],encrypt:j,decrypt:S,resetFields:g}},Z="min(60dvh, calc(100dvh - 300px))",ee="calc(100dvh - 420px)",ke=({controller:t})=>{const{mode:d,setMode:l,variant:n,setVariant:a,key:s,setKey:c,iv:R,setIv:k,salt:L,setSalt:b,selectedAlgorithm:g,encrypt:I,decrypt:x}=t,j=ge(),S=me(j.breakpoints.up("md")),h=j.palette.mode==="dark"?"vs-dark":"vs-light",[u,D]=i.useState(""),[U,H]=i.useState(""),[q,v]=i.useState(null),[_,w]=i.useState(null),te=d==="encoding"?"Encode":"암호화 (Encrypt)",re=d==="encoding"?"Decode":"복호화 (Decrypt)",P=i.useRef(null),A=i.useRef(!1),[V,$]=i.useState(.5),ne=V,oe=1-V,z=i.useCallback(o=>Math.min(Math.max(o,.2),.8),[]),C=i.useCallback(o=>{if(!P.current)return;const p=P.current.getBoundingClientRect();if(p.width<=0)return;const m=(o-p.left)/p.width;$(z(m))},[z]),F=i.useCallback(()=>{A.current=!1,document.body.style.cursor="",document.body.style.userSelect=""},[]),N=i.useCallback(o=>{if(S)if(A.current=!0,document.body.style.cursor="col-resize",document.body.style.userSelect="none","touches"in o){const p=o.touches[0];p&&C(p.clientX)}else C(o.clientX)},[S,C]);i.useEffect(()=>{const o=B=>{A.current&&(B.preventDefault(),C(B.clientX))},p=B=>{if(!A.current)return;const O=B.touches[0];O&&(B.preventDefault(),C(O.clientX))},m=()=>F();return window.addEventListener("mousemove",o),window.addEventListener("mouseup",m),window.addEventListener("touchmove",p,{passive:!1}),window.addEventListener("touchend",m),window.addEventListener("touchcancel",m),()=>{window.removeEventListener("mousemove",o),window.removeEventListener("mouseup",m),window.removeEventListener("touchmove",p),window.removeEventListener("touchend",m),window.removeEventListener("touchcancel",m)}},[F,C]),i.useEffect(()=>{S||(A.current=!1,document.body.style.cursor="",document.body.style.userSelect="",$(.5))},[S]);const se=i.useMemo(()=>`${u.length} chars`,[u]),ae=i.useMemo(()=>`${U.length} chars`,[U]),le=o=>{l(o.target.value),D(""),H(""),v(null),w(null)},ie=()=>{const o=I(u);if(!o.ok){v(o.error),w(null);return}v(null),H(o.value),w("encrypt")},ce=()=>{const o=x(u);if(!o.ok){v(o.error),w(null);return}v(null),H(o.value),w("decrypt")},de=d==="oneway",ue=d==="oneway",he=g?.keyLength?Math.max(140,g.keyLength*9):180,pe=g?.ivRequired?140:160;return r.jsxs(be,{sx:{p:1.25,display:"flex",flexDirection:"column",gap:1.25,flex:1,minHeight:785,height:"100%",width:1,maxWidth:"100%",overflowX:"hidden"},children:[r.jsx(f,{sx:{p:1.25,border:"1px solid",borderColor:"divider",borderRadius:2,bgcolor:"background.paper"},children:r.jsx(y,{spacing:1.25,children:r.jsxs(y,{direction:"row",alignItems:"center",justifyContent:"space-between",spacing:1.5,children:[r.jsxs(y,{direction:"row",spacing:1.25,alignItems:"center",children:[r.jsxs(K,{size:"small",sx:{minWidth:200},children:[r.jsx(G,{id:"crypto-mode-label",children:"암복호화 유형"}),r.jsx(J,{labelId:"crypto-mode-label",value:d,label:"암복호화 유형",onChange:le,children:Object.entries(E).map(([o,p])=>r.jsx(Q,{value:o,children:p.label},o))})]}),r.jsxs(K,{size:"small",sx:{minWidth:220},children:[r.jsx(G,{id:"crypto-algorithm-label",children:"알고리즘"}),r.jsx(J,{labelId:"crypto-algorithm-label",value:n,label:"알고리즘",onChange:o=>a(o.target.value),children:E[d].algorithms.map(o=>r.jsx(Q,{value:o.value,children:o.label},o.value))})]}),d==="symmetric"&&r.jsx(W,{size:"small",label:g?.keyLength?`Key (${g.keyLength}자)`:"Key",value:s,onChange:o=>{const p=o.target.value,m=g?.keyLength??p.length;c(p.slice(0,m))},placeholder:g?.keyLength?`${g.keyLength}자 입력`:"필요 길이 입력",sx:{minWidth:he}}),g?.ivRequired&&r.jsx(W,{size:"small",label:"IV (16자)",value:R,onChange:o=>k(o.target.value.slice(0,16)),placeholder:"16자 입력",sx:{minWidth:pe}}),de&&r.jsx(W,{size:"small",label:"Salt",value:L,onChange:o=>b(o.target.value),placeholder:"선택 입력",sx:{minWidth:160}})]}),r.jsxs(y,{direction:"row",spacing:1,flexWrap:"nowrap",children:[r.jsx(T,{variant:"contained",onClick:ie,children:te}),r.jsx(T,{variant:"outlined",color:"primary",onClick:ce,disabled:ue,children:re})]})]})})}),r.jsxs(fe,{open:!!q,onClose:()=>v(null),children:[r.jsx(ye,{children:"오류"}),r.jsx(Se,{children:q}),r.jsx(ve,{children:r.jsx(T,{onClick:()=>v(null),children:"확인"})})]}),r.jsxs(f,{ref:P,sx:{flex:1,minHeight:0,width:1,display:{xs:"flex",md:"grid"},flexDirection:{xs:"column",md:"row"},gridTemplateColumns:{md:`minmax(0, ${ne}fr) 6px minmax(0, ${oe}fr)`},gap:{xs:2,md:0},columnGap:{md:1.5},alignItems:"stretch",overflow:"hidden",touchAction:"none",contain:"size layout paint"},children:[r.jsxs(y,{sx:{p:{xs:1,md:1.5},border:"1px solid",borderColor:"divider",borderRadius:2,bgcolor:"background.paper",display:"flex",flexDirection:"column",gap:1,minWidth:0,minHeight:0,overflow:"hidden"},children:[r.jsxs(y,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[r.jsx(M,{variant:"subtitle1",children:"입력 (Plain / Cipher)"}),r.jsx(M,{variant:"caption",color:"text.secondary",children:se})]}),r.jsx(f,{sx:{flex:1,height:{xs:Z,md:ee},border:"1px solid",borderColor:"divider",borderRadius:1.5,overflow:"hidden",bgcolor:"background.default"},children:r.jsx(X,{height:"100%",defaultLanguage:"plaintext",theme:h,value:u,onChange:o=>D(o??""),options:{wordWrap:"on",minimap:{enabled:!1},scrollBeyondLastLine:!1,automaticLayout:!0}})})]}),r.jsx(f,{sx:{display:{xs:"none",md:"flex"},width:6,justifySelf:"stretch",cursor:S?"col-resize":"default",bgcolor:"divider",borderRadius:1,alignItems:"center",justifyContent:"center",userSelect:"none"},role:"separator","aria-orientation":"vertical",onMouseDown:N,onTouchStart:N,children:r.jsxs(f,{sx:{display:"flex",flexDirection:"column",gap:.25},children:[r.jsx(f,{sx:{width:2,height:2,bgcolor:"text.secondary",borderRadius:"50%"}}),r.jsx(f,{sx:{width:2,height:2,bgcolor:"text.secondary",borderRadius:"50%"}}),r.jsx(f,{sx:{width:2,height:2,bgcolor:"text.secondary",borderRadius:"50%"}})]})}),r.jsxs(y,{sx:{p:{xs:1,md:1.5},border:"1px solid",borderColor:"divider",borderRadius:2,bgcolor:"background.paper",display:"flex",flexDirection:"column",gap:1,minWidth:0,minHeight:0,overflow:"hidden"},children:[r.jsxs(y,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[r.jsxs(M,{variant:"subtitle1",children:["결과 ",_?_==="encrypt"?"(암호문)":"(평문)":""]}),r.jsx(M,{variant:"caption",color:"text.secondary",children:ae})]}),r.jsx(f,{sx:{flex:1,height:{xs:Z,md:ee},border:"1px solid",borderColor:"divider",borderRadius:1.5,overflow:"hidden",bgcolor:"background.default"},children:r.jsx(X,{height:"100%",defaultLanguage:"plaintext",theme:h,value:U,onChange:()=>{},options:{wordWrap:"on",minimap:{enabled:!1},scrollBeyondLastLine:!1,automaticLayout:!0,readOnly:!0}})})]})]})]})},De=()=>{const t=Re();return r.jsx(ke,{controller:t})};export{De as default};

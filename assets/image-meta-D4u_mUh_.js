import{j as e,r as L}from"./vendor-CRMzTT1s.js";import{f as fe,a as ye,b as Z,u as ve}from"./image-meta-utils-C81JK1o9.js";import{B as g,S as r,T as c,a9 as y,I as f,bf as Ce,g as G,a as p,x as ke,L as we,bg as _,_ as De,b as Ie,bh as Se,Z as ze,d as We,bi as Fe,bj as Te,bk as Me,bl as q,bm as Be,bn as Pe,o as z,bo as Ne,P as K,Q as $e,R as Ae,U as V,V as D,W as Ee,l as W,m as F,bp as He,N as Re,n as T,a4 as Q,bq as U,as as Le,ab as j,at as X,br as S,ak as m,p as Y,bs as Ze,C as Ge}from"./mui-Ckr--VM5.js";import"./excel-CUMakpxJ.js";import"./tree-sitter-aGyQ8e2w.js";const _e=({images:o,selectedImage:l,fileInputRef:n,onFilesSelected:s,onSelect:a,onRemove:h,onClearAll:d})=>{const i=(t,x)=>e.jsx(De,{disablePadding:!0,secondaryAction:e.jsx(y,{title:"이미지 삭제",placement:"left",children:e.jsx(f,{edge:"end",size:"small",onClick:()=>h(x),children:e.jsx(Fe,{fontSize:"small"})})}),children:e.jsxs(Ie,{selected:l===t,onClick:()=>a(t),children:[e.jsx(Se,{children:e.jsx(ze,{variant:"rounded",src:t.preview,alt:t.file.name,sx:{width:46,height:46},children:e.jsx(_,{fontSize:"small"})})}),e.jsx(We,{primaryTypographyProps:{variant:"body2",noWrap:!0},secondaryTypographyProps:{variant:"caption",color:"text.secondary"},primary:t.file.name,secondary:`${fe(t.file.size)} | ${t.width}x${t.height}px`})]})},`${t.file.name}-${t.file.lastModified}-${x}`);return e.jsxs(g,{sx:{width:320,flexShrink:0,flexDirection:"column",gap:1.25,minHeight:770,border:"1px solid",borderColor:"divider",borderRadius:1,bgcolor:"background.paper",overflow:"auto",p:1.25},children:[e.jsxs(r,{direction:"row",spacing:1.25,alignItems:"flex-start",justifyContent:"space-between",children:[e.jsxs(r,{spacing:.5,children:[e.jsx(c,{variant:"subtitle1",fontWeight:700,children:"이미지 목록"}),e.jsx(c,{variant:"caption",color:"text.secondary",children:o.length?`${o.length}개의 파일`:"이미지를 업로드하거나 드래그 앤 드롭하세요."})]}),e.jsx(y,{title:"모든 이미지를 지웁니다",children:e.jsx("span",{children:e.jsx(f,{onClick:d,disabled:!o.length,size:"small",color:"error",children:e.jsx(Ce,{fontSize:"small"})})})})]}),e.jsx(G,{}),e.jsxs(r,{spacing:1.25,sx:{mb:1},children:[e.jsx("input",{type:"file",multiple:!0,accept:"image/*",hidden:!0,ref:n,onChange:t=>s(t.target.files)}),e.jsx(p,{variant:"contained",startIcon:e.jsx(ke,{}),onClick:()=>n.current?.click(),children:"이미지 업로드"})]}),e.jsx(G,{}),e.jsx(g,{sx:{minHeight:0,overflowY:"auto",height:"calc(100dvh - 315px)"},children:o.length?e.jsx(we,{dense:!0,disablePadding:!0,children:o.map((t,x)=>i(t,x))}):e.jsxs(r,{alignItems:"center",justifyContent:"center",sx:{height:"100%",color:"text.secondary",textAlign:"center",p:1.25},spacing:1,children:[e.jsx(_,{color:"disabled"}),e.jsx(c,{variant:"body2",children:"Drag & Drop 지원 - 다중 파일 업로드 가능"})]})})]})},Ve=({images:o,selectedImage:l,onOpenModal:n,onOpenExportDialog:s,onOpenCommentDialog:a})=>{const h=[[{label:"파일 크기",content:l?ye(l.file.size):"N/A",inline:!0},{label:"파일 형식",content:l?.file.type??"N/A",inline:!0},{label:"이미지 크기",content:l?`${l.width} x ${l.height}`:"N/A",inline:!0}],[{label:"생성일",content:Z(l?.createdDate),inline:!0},{label:"촬영일",content:Z(l?.takenDate),inline:!0}],[{label:"Google Maps",content:l?.gpsLocation?e.jsx(Te,{href:l.gpsLocation,target:"_blank",rel:"noreferrer",children:"위치 열기"}):"N/A",inline:!0}],[{label:"Comment",content:e.jsxs(r,{direction:"row",spacing:1,alignItems:"center",sx:{minWidth:0},children:[e.jsx(c,{variant:"body2",sx:{color:l?.comment?"text.primary":"text.secondary",wordBreak:"break-word"},children:l?.comment?l.comment:"등록된 코멘트가 없습니다."}),e.jsx(y,{title:"코멘트 수정",children:e.jsx("span",{children:e.jsx(f,{size:"small",onClick:a,disabled:!l,children:e.jsx(Me,{fontSize:"small"})})})})]}),inline:!0}]];return e.jsxs(r,{sx:{minHeight:0,minWidth:0,border:"1px solid",borderColor:"divider",borderRadius:1,bgcolor:"background.paper",p:1.25,gap:1.25},children:[e.jsxs(r,{direction:"row",spacing:1.25,justifyContent:"space-between",alignItems:"center",children:[e.jsxs(r,{spacing:.5,sx:{alignSelf:"flex-start",width:"100%"},children:[e.jsx(c,{variant:"subtitle1",fontWeight:700,children:"파일 기본 정보"}),e.jsx(c,{variant:"caption",color:"text.secondary",sx:{wordBreak:"break-all"},children:l?l.file.name:"이미지를 선택하세요."})]}),e.jsxs(r,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(p,{variant:"outlined",size:"small",startIcon:e.jsx(q,{fontSize:"small"}),onClick:n,disabled:!l,sx:{minWidth:"auto",px:1.25,whiteSpace:"nowrap"},children:"원본보기"}),e.jsx(p,{variant:"outlined",size:"small",startIcon:e.jsx(Be,{}),onClick:()=>s("pdf"),disabled:!o.length,children:"PDF"}),e.jsx(p,{variant:"outlined",size:"small",startIcon:e.jsx(Pe,{}),onClick:()=>s("excel"),disabled:!o.length,children:"Excel"})]})]}),e.jsx(r,{spacing:1,children:h.map((d,i)=>e.jsx(r,{direction:"row",spacing:1,sx:{border:"1px solid",borderColor:"divider",borderRadius:1,px:1.25,py:1,flexWrap:"wrap",rowGap:.75,alignItems:"center"},children:d.map((t,x)=>e.jsx(g,{sx:{flex:d.length>1?1:"1 0 100%",minWidth:d.length>1?0:"100%",display:"flex",alignItems:"center",gap:1,justifyContent:t.inline?"flex-start":"space-between",flexWrap:"wrap"},children:t.inline?e.jsxs(r,{direction:"row",spacing:.75,alignItems:"center",sx:{flexWrap:"wrap",width:"100%"},children:[e.jsx(c,{variant:"body2",color:"text.secondary",children:t.label}),e.jsx(c,{variant:"body2",color:"text.secondary",children:":"}),e.jsx(g,{sx:{minWidth:0,flex:1},children:typeof t.content=="string"?e.jsx(c,{variant:"body2",sx:{color:t.content==="N/A"?"text.secondary":"text.primary",wordBreak:"break-word",whiteSpace:"normal"},children:t.content}):t.content})]}):e.jsxs(e.Fragment,{children:[e.jsx(c,{variant:"body2",color:"text.secondary",children:t.label}),e.jsx(g,{sx:{display:"flex",alignItems:"center",gap:1,minWidth:0,justifyContent:"flex-end",flex:d.length===1?1:void 0},children:typeof t.content=="string"?e.jsx(c,{variant:"body2",sx:{color:t.content==="N/A"?"text.secondary":"text.primary",textAlign:"right",wordBreak:"break-word",whiteSpace:"normal"},children:t.content}):t.content})]})},`${t.label}-${x}`))},i))})]})},Qe=({selectedImage:o,filteredMeta:l,searchQuery:n,onSearchChange:s})=>e.jsxs(r,{sx:{minHeight:492,minWidth:0,border:"1px solid",borderColor:"divider",borderRadius:1,bgcolor:"background.paper",p:1.25,gap:1.25,height:"calc(100vh - 468px)"},children:[e.jsxs(r,{direction:"row",spacing:1,justifyContent:"space-between",children:[e.jsxs(r,{spacing:.3,children:[e.jsx(c,{variant:"subtitle1",fontWeight:700,children:"메타데이터"}),e.jsx(c,{variant:"caption",color:"text.secondary",children:o?`${l.length}개의 필터된 항목`:"이미지를 선택하면 메타데이터가 표시됩니다."})]}),e.jsx(z,{size:"small",label:"메타 키워드 검색",placeholder:"키 또는 값을 입력하세요",value:n,onChange:a=>s(a.target.value),disabled:!o,sx:{width:280}})]}),e.jsx(g,{sx:{flex:1,minHeight:0},children:o?l.length?e.jsx(Ne,{component:K,variant:"outlined",sx:{height:"100%"},children:e.jsxs($e,{size:"small",stickyHeader:!0,children:[e.jsx(Ae,{children:e.jsxs(V,{children:[e.jsx(D,{sx:{width:"30%"},children:"Key"}),e.jsx(D,{sx:{width:"70%",wordBreak:"break-word"},children:"Value"})]})}),e.jsx(Ee,{children:l.map(a=>e.jsxs(V,{children:[e.jsx(D,{sx:{fontWeight:500},children:a.key}),e.jsx(D,{sx:{wordBreak:"break-word"},children:e.jsx(c,{variant:"body2",sx:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:a.value})})]},`${a.key}-${a.value}`))})]})}):e.jsx(r,{alignItems:"center",justifyContent:"center",sx:{height:"100%",color:"text.secondary"},children:e.jsx(c,{variant:"body2",children:"해당 키워드로 일치하는 항목이 없습니다."})}):e.jsx(r,{alignItems:"center",justifyContent:"center",sx:{height:"100%",color:"text.secondary"},children:e.jsx(c,{variant:"body2",children:"좌측에서 이미지를 선택해 메타데이터를 확인하세요."})})})]}),Ue=({open:o,selectedImage:l,viewOriginalSize:n,modalZoom:s,minZoom:a,maxZoom:h,zoomPercent:d,onZoomIn:i,onZoomOut:t,onToggleOriginalSize:x,onClose:v})=>e.jsxs(W,{open:o,onClose:v,fullWidth:!0,maxWidth:"lg",children:[e.jsxs(F,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:["원본 이미지 미리보기",e.jsxs(r,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(y,{title:"축소",children:e.jsx("span",{children:e.jsx(f,{size:"small",onClick:t,disabled:!l||s<=a,children:e.jsx(He,{fontSize:"small"})})})}),e.jsxs(c,{variant:"body2",color:"text.secondary",sx:{minWidth:56,textAlign:"center"},children:[d,"%"]}),e.jsx(y,{title:"확대",children:e.jsx("span",{children:e.jsx(f,{size:"small",onClick:i,disabled:!l||s>=h,children:e.jsx(q,{fontSize:"small"})})})}),e.jsx(p,{size:"small",onClick:x,disabled:!l,children:n?"화면 맞춤":"원본 크기"}),e.jsx(f,{onClick:v,children:e.jsx(Re,{})})]})]}),e.jsx(T,{dividers:!0,sx:{bgcolor:"#000",minHeight:360,height:{xs:"60vh",md:"70vh"},maxHeight:{xs:"60vh",md:"70vh"},p:0},children:e.jsx(g,{sx:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",overflow:"auto",p:1.25},children:l?e.jsx(g,{component:"img",src:l.preview,alt:l.file.name,sx:{width:n?`${l.width*s}px`:`${s*100}%`,height:n?`${l.height*s}px`:"auto",maxWidth:n?"none":`${s*100}%`,maxHeight:!n&&s<=1?"100%":"none",objectFit:"contain",transition:"width 0.2s ease, height 0.2s ease"}}):e.jsx(c,{variant:"body2",color:"common.white",children:"선택된 이미지가 없습니다."})})})]}),Xe=({open:o,type:l,exportOptions:n,selectedImage:s,onChangeOptions:a,onClose:h,onConfirm:d})=>e.jsxs(W,{open:o,onClose:h,fullWidth:!0,maxWidth:"sm",children:[e.jsx(F,{children:"내보내기 옵션"}),e.jsx(T,{dividers:!0,children:e.jsxs(r,{spacing:1.25,children:[e.jsx(z,{label:"파일명",fullWidth:!0,size:"small",value:n.fileName,onChange:i=>a({...n,fileName:i.target.value}),helperText:l==="excel"?"확장자는 자동으로 .xlsx 로 저장됩니다.":"확장자는 자동으로 .pdf 로 저장됩니다."}),e.jsxs(Q,{children:[e.jsx(U,{children:"대상"}),e.jsxs(Le,{row:!0,value:n.scope,onChange:i=>a({...n,scope:i.target.value}),children:[e.jsx(j,{value:"all",control:e.jsx(X,{}),label:"전체 이미지"}),e.jsx(j,{value:"selected",control:e.jsx(X,{}),label:"선택한 이미지",disabled:!s})]})]}),e.jsxs(Q,{component:"fieldset",variant:"standard",children:[e.jsx(U,{children:"포함 항목"}),e.jsxs(S,{row:!0,children:[e.jsx(j,{control:e.jsx(m,{checked:n.includeBasicInfo,onChange:i=>a({...n,includeBasicInfo:i.target.checked})}),label:"파일 기본 정보"}),e.jsx(j,{control:e.jsx(m,{checked:n.includeMetadata,onChange:i=>a({...n,includeMetadata:i.target.checked})}),label:"메타데이터 전체"})]}),n.includeBasicInfo?e.jsxs(S,{row:!0,children:[e.jsx(j,{control:e.jsx(m,{checked:n.includeFileName,onChange:i=>a({...n,includeFileName:i.target.checked})}),label:"파일명"}),e.jsx(j,{control:e.jsx(m,{checked:n.includeFileSize,onChange:i=>a({...n,includeFileSize:i.target.checked})}),label:"파일 크기"}),e.jsx(j,{control:e.jsx(m,{checked:n.includeFileType,onChange:i=>a({...n,includeFileType:i.target.checked})}),label:"파일 형식"}),e.jsx(j,{control:e.jsx(m,{checked:n.includeDimensions,onChange:i=>a({...n,includeDimensions:i.target.checked})}),label:"이미지 해상도"})]}):null,n.includeBasicInfo?e.jsxs(S,{row:!0,children:[e.jsx(j,{control:e.jsx(m,{checked:n.includeComment,onChange:i=>a({...n,includeComment:i.target.checked})}),label:"코멘트"}),e.jsx(j,{control:e.jsx(m,{checked:n.includeGps,onChange:i=>a({...n,includeGps:i.target.checked})}),label:"위치 링크"}),e.jsx(j,{control:e.jsx(m,{checked:n.includeCreateDate,onChange:i=>a({...n,includeCreateDate:i.target.checked})}),label:"생성 일시"}),e.jsx(j,{control:e.jsx(m,{checked:n.includeTakenDate,onChange:i=>a({...n,includeTakenDate:i.target.checked})}),label:"촬영 일시"})]}):null]})]})}),e.jsxs(Y,{children:[e.jsx(p,{onClick:h,children:"취소"}),e.jsx(p,{variant:"contained",onClick:d,children:l==="excel"?"Excel 다운로드":"PDF 다운로드"})]})]}),qe=({open:o,commentInput:l,onChange:n,onClose:s,onSave:a,saveDisabled:h})=>e.jsxs(W,{open:o,onClose:s,fullWidth:!0,maxWidth:"sm",children:[e.jsx(F,{children:"Comment"}),e.jsx(T,{dividers:!0,children:e.jsx(z,{multiline:!0,minRows:4,fullWidth:!0,autoFocus:!0,value:l,onChange:d=>n(d.target.value),placeholder:"이미지에 대한 메모를 입력하세요."})}),e.jsxs(Y,{children:[e.jsx(p,{onClick:s,children:"취소"}),e.jsx(p,{variant:"contained",onClick:a,disabled:h,children:"저장"})]})]}),nn=()=>{const{fileInputRef:o,images:l,selectedImage:n,setSelectedImage:s,searchQuery:a,setSearchQuery:h,isModalOpen:d,setIsModalOpen:i,viewOriginalSize:t,setViewOriginalSize:x,isExporting:v,isCommentDialogOpen:J,setIsCommentDialogOpen:I,commentInput:M,setCommentInput:B,handleFiles:O,handleDrop:ee,handleRemoveImage:ne,handleClearAllImages:le,handleDownloadPDF:ie,handleDownloadExcel:te,filteredMeta:ae,saveCommentForSelected:se,modalZoom:P,setModalZoom:C}=ve(),[k,N]=L.useState(null),[w,re]=L.useState({scope:"all",includeBasicInfo:!0,includeMetadata:!0,fileName:"images_metadata",includeFileName:!0,includeFileSize:!0,includeFileType:!0,includeDimensions:!0,includeGps:!0,includeCreateDate:!0,includeTakenDate:!0,includeComment:!0}),$=.25,A=.5,E=4,oe=Math.round(P*100),H=u=>{C(b=>{const be=Math.min(E,Math.max(A,b+u));return Number(be.toFixed(2))})},ce=()=>H($),de=()=>H(-$),he=()=>{x(u=>{const b=!u;return b||C(1),b})},xe=()=>{n&&(C(1),x(!1),i(!0))},je=()=>{i(!1),x(!1),C(1)},ue=()=>{n&&(B(n.comment??""),I(!0))},me=()=>{se(M),I(!1)},ge=u=>{N(u)},R=()=>{N(null)},pe=()=>{if(!k)return;if(w.scope==="selected"&&!n){window.alert("선택된 이미지가 없습니다.");return}const u=w.fileName.trim()||"images_metadata",b={...w,fileName:u};k==="pdf"?ie(b):te(b),R()};return e.jsxs(K,{sx:{p:1.25,display:"flex",flexDirection:"column",gap:1.25,flex:1,minHeight:785,height:"100%",width:1,maxWidth:"100%",overflowX:"hidden"},onDragOver:u=>u.preventDefault(),onDrop:ee,children:[e.jsx(g,{sx:{minHeight:0,minWidth:0,width:"100%",height:"calc(100dvh - 300px)"},children:e.jsxs(r,{direction:"row",spacing:1.25,sx:{flex:1,minHeight:0,width:"100%"},alignItems:"stretch",children:[e.jsx(_e,{images:l,selectedImage:n,fileInputRef:o,onFilesSelected:O,onSelect:s,onRemove:ne,onClearAll:le}),e.jsxs(r,{spacing:1.25,sx:{flex:1,minHeight:0,minWidth:0},children:[e.jsx(Ve,{images:l,selectedImage:n,onOpenModal:xe,onOpenExportDialog:ge,onOpenCommentDialog:ue}),e.jsx(Qe,{selectedImage:n,filteredMeta:ae,searchQuery:a,onSearchChange:h})]})]})}),e.jsx(Ue,{open:d,selectedImage:n,viewOriginalSize:t,modalZoom:P,minZoom:A,maxZoom:E,zoomPercent:oe,onZoomIn:ce,onZoomOut:de,onToggleOriginalSize:he,onClose:je}),e.jsx(Xe,{open:!!k,type:k,exportOptions:w,selectedImage:n,onChangeOptions:re,onClose:R,onConfirm:pe}),e.jsx(qe,{open:J,commentInput:M,onChange:B,onClose:()=>I(!1),onSave:me,saveDisabled:!n}),e.jsx(Ze,{open:v,sx:{color:"#fff",zIndex:u=>u.zIndex.modal+1},children:e.jsx(Ge,{color:"inherit"})})]})};export{nn as default};

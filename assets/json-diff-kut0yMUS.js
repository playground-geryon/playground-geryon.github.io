import{r,p as te,j as t,o as Ve}from"./vendor-DyxFRNuv.js";import{u as et,q as tt,P as rt,S as T,a as K,af as nt,ac as Te,T as I,ag as ot,a1 as st,ad as at,B as R,a8 as De,l as Pe,m as Je,n as Ae,Y as me,Q as it,R as lt,U as Ie,V as G,W as ct,X as dt,p as ze}from"./mui-DxUmZoFs.js";import{M as Be}from"./monaco-editor-Dur63S1t.js";import"./excel-CUMakpxJ.js";import"./tree-sitter-DJeWk4Ia.js";const ut=({controller:h})=>{const{leftJson:x,rightJson:c,leftError:u,rightError:C,diffNodes:f,handleLeftUpload:pe,handleRightUpload:D,handleLeftTextChange:xe,handleRightTextChange:le,formatBothJson:be,handleCompare:ce,isComparing:re,sortBeforeCompare:de,setSortBeforeCompare:U}=h,ne=et(),oe=tt(ne.breakpoints.down("md")),[J,Z]=r.useState(!0),[w,b]=r.useState({added:!0,removed:!0,changed:!0}),[z,V]=r.useState(null),[B,_]=r.useState(!1),[se,Y]=r.useState(0),[ae,s]=r.useState(""),o=r.useId(),d=r.useId(),a=r.useRef(null),m=r.useRef(null),S=r.useRef(null),p=r.useRef(null),W=r.useRef([]),y=r.useRef([]),k=r.useRef({left:[],right:[]}),$=r.useRef(null),A=r.useRef(new Map),ye=r.useMemo(()=>ne.palette.mode==="dark"?"vs-dark":"vs-light",[ne.palette.mode]),We=r.useMemo(()=>B?te(x)??null:null,[x,B]),$e=r.useMemo(()=>B?te(c)??null:null,[c,B]),F=r.useMemo(()=>f.reduce((e,n)=>(e[n.type]+=1,e.total+=1,e),{added:0,removed:0,changed:0,total:0}),[f]),ue=r.useMemo(()=>f.filter(e=>w[e.type]),[f,w]),he=50,Fe=r.useMemo(()=>{const e=se*he;return ue.slice(e,e+he)},[ue,se]),[ve,we]=r.useState(.5),He=ve,Xe=1-ve,Ce=r.useMemo(()=>{const e=new Map;return f.forEach(n=>{e.set(n.path,n)}),e},[f]);r.useEffect(()=>{F.total===0&&(_(!1),V(null))},[F.total]),r.useEffect(()=>{Y(0)},[w,B,f]);const Se=r.useCallback(e=>{const n=Ce.get(e);n&&(V(n),_(!1))},[Ce]),qe=e=>{if(!e)return[];const n=[],l=/([^.\[\]]+)|\[(\d+)\]/g;let i;for(;(i=l.exec(e))!==null;)i[1]!==void 0?n.push(i[1]):i[2]!==void 0&&n.push(Number(i[2]));return n[0]==="root"&&n.shift(),n},Re=e=>{if(e===null)return"null";if(Array.isArray(e))return"array";switch(typeof e){case"object":return"object";case"string":return"string";case"number":return"number";case"boolean":return"boolean";default:return"string"}},ee=(e,n,l)=>{if(!e||!n)return null;const i=Ve(n,qe(l));if(!i)return null;const g=e.getPositionAt(i.offset),j=e.getPositionAt(i.offset+i.length);return{range:{startLineNumber:g.lineNumber,startColumn:g.column,endLineNumber:j.lineNumber,endColumn:j.column},nodeType:i.type}},Ne=r.useCallback(e=>{const n=a.current,l=m.current;if(!n||!l)return;const i=te(n.getValue())??null,g=te(l.getValue())??null,j=ee(n.getModel(),i,e),M=ee(l.getModel(),g,e);k.current.left=n.deltaDecorations(k.current.left,[]),k.current.right=l.deltaDecorations(k.current.right,[]);const E=[],N=[];j&&(n.revealRangeInCenter(j.range),n.setSelection(j.range),E.push({range:j.range,options:{className:"json-diff-focus",isWholeLine:!1}})),M&&(l.revealRangeInCenter(M.range),l.setSelection(M.range),N.push({range:M.range,options:{className:"json-diff-focus",isWholeLine:!1}})),k.current.left=n.deltaDecorations(k.current.left,E),k.current.right=l.deltaDecorations(k.current.right,N)},[]),P=r.useCallback(()=>{requestAnimationFrame(()=>{a.current?.layout(),m.current?.layout(),requestAnimationFrame(()=>{a.current?.layout(),m.current?.layout()})})},[]),fe=r.useCallback(e=>{const n=p.current;n&&e.onMouseDown(l=>{const i=l.target.position?.lineNumber??l.target.detail?.lineNumber??null;if(!i)return;const g=e.getModel();if(!g)return;const j=new n.Range(i,1,i,g.getLineMaxColumn(i)),E=(g.getDecorationsInRange(j)||[]).find(O=>(O.options?.className?.startsWith?.("json-diff-")||O.options?.glyphMarginClassName?.startsWith?.("json-diff-"))&&A.current.has(O.id));if(!E)return;const N=A.current.get(E.id);N&&(Ne(N.path),l?.target?.type===n.editor.MouseTargetType.GUTTER_GLYPH_MARGIN&&Se(N.path))})},[Ne,Se]),Ge=r.useCallback((e,n)=>{a.current=e,p.current=n,fe(e),requestAnimationFrame(()=>{e.layout(),requestAnimationFrame(()=>e.layout())})},[fe]),Ue=r.useCallback((e,n)=>{m.current=e,p.current=n,fe(e),requestAnimationFrame(()=>{e.layout(),requestAnimationFrame(()=>e.layout())})},[fe]);r.useEffect(()=>{P()},[oe,ye,P]);const ke=r.useCallback(e=>{if(oe)return;e.preventDefault(),e.stopPropagation();const n=S.current;if(!n)return;const l=n.getBoundingClientRect(),i=M=>{const N=(M.clientX-l.left)/l.width,O=Math.min(.8,Math.max(.2,N));we(O),P()},g=M=>{M.preventDefault();const N=((M.touches[0]?.clientX??0)-l.left)/l.width,O=Math.min(.8,Math.max(.2,N));we(O),P()},j=()=>{window.removeEventListener("mousemove",i),window.removeEventListener("touchmove",g),window.removeEventListener("mouseup",j),window.removeEventListener("touchend",j),window.removeEventListener("touchcancel",j),P()};window.addEventListener("mousemove",i),window.addEventListener("touchmove",g,{passive:!1}),window.addEventListener("mouseup",j),window.addEventListener("touchend",j),window.addEventListener("touchcancel",j)},[oe,P]);r.useEffect(()=>{if(!S.current)return;const e=new ResizeObserver(()=>P());return e.observe(S.current),()=>e.disconnect()},[P]),r.useEffect(()=>{if(!J)return;const e=a.current,n=m.current;if(!e||!n)return;const l=e.onDidScrollChange(g=>{if(J){if($.current==="left"){$.current=null;return}$.current="right",n.setScrollTop(g.scrollTop??0),n.setScrollLeft(g.scrollLeft??0)}}),i=n.onDidScrollChange(g=>{if(J){if($.current==="right"){$.current=null;return}$.current="left",e.setScrollTop(g.scrollTop??0),e.setScrollLeft(g.scrollLeft??0)}});return()=>{l.dispose(),i.dispose()}},[J]);const Me=r.useCallback(()=>{const e=p.current,n=a.current,l=m.current;if(!e||!n||!l)return;const i=n.getModel(),g=l.getModel(),j=i?te(i.getValue())??null:null,M=g?te(g.getValue())??null:null,E=[],N=[],O=[],je=[],ge=(H,v,L)=>({isWholeLine:!1,className:H,glyphMarginClassName:`${H}-glyph`,glyphMarginHoverMessage:{value:`${v} ${L}`},hoverMessage:{value:`${v} ${L}`}});f.forEach(H=>{const{path:v,type:L,leftValue:Ke,rightValue:Ze}=H;if(!w[L])return;const X=ee(i,j,v),q=ee(g,M,v),Ee=X?X.nodeType===Re(Ke):!1,Oe=q?q.nodeType===Re(Ze):!1;L==="added"?q&&Oe&&(N.push({range:q.range,options:ge("json-diff-added","ðŸŸ¢ ì¶”ê°€",v)}),je.push({side:"right",path:v,range:q.range})):L==="removed"?X&&Ee&&(E.push({range:X.range,options:ge("json-diff-removed","ðŸ”´ ì‚­ì œ",v)}),O.push({side:"left",path:v,range:X.range})):(X&&Ee&&(E.push({range:X.range,options:ge("json-diff-changed","ðŸŸ  ìˆ˜ì •",v)}),O.push({side:"left",path:v,range:X.range})),q&&Oe&&(N.push({range:q.range,options:ge("json-diff-changed","ðŸŸ  ìˆ˜ì •",v)}),je.push({side:"right",path:v,range:q.range})))}),W.current=n.deltaDecorations(W.current,E),y.current=l.deltaDecorations(y.current,N),A.current.clear(),W.current.forEach((H,v)=>{const L=O[v];L&&A.current.set(H,L)}),y.current.forEach((H,v)=>{const L=je[v];L&&A.current.set(H,L)})},[f,w]);r.useEffect(()=>{Me(),P()},[Me,x,c,P]);const _e=t.jsx("style",{children:`
        .monaco-editor .json-diff-added { background-color: rgba(16,185,129,0.25); border-bottom: 2px solid rgba(16,185,129,0.9); }
        .monaco-editor .json-diff-removed { background-color: rgba(239,68,68,0.25); border-bottom: 2px solid rgba(239,68,68,0.9); }
        .monaco-editor .json-diff-changed { background-color: rgba(245,158,11,0.25); border-bottom: 2px solid rgba(245,158,11,0.9); }
        .monaco-editor .json-diff-added-glyph,
        .monaco-editor .json-diff-removed-glyph,
        .monaco-editor .json-diff-changed-glyph { margin-left:6px; margin-top:2px; width:8px; height:8px; border-radius:50%;}
        .monaco-editor .json-diff-added-glyph    { background: rgba(16,185,129,0.9); }
        .monaco-editor .json-diff-removed-glyph  { background: rgba(239,68,68,0.9); }
        .monaco-editor .json-diff-changed-glyph  { background: rgba(245,158,11,0.9); }
        .monaco-editor .json-diff-focus { outline:2px solid rgba(59,130,246,0.9); background-color: rgba(59,130,246,0.12); }
        .monaco-editor, .monaco-editor .overflow-guard { overscroll-behavior: contain; }
        .monaco-editor .margin {
  cursor: pointer;
}
      `}),Ye=r.useMemo(()=>{const e=(x?.trim().length??0)>0&&!u,n=(c?.trim().length??0)>0&&!C;return e&&n},[x,c,u,C]),Qe=()=>{if(!Ye){const e=[];x?.trim()||e.push("ì™¼ìª½ JSONì´ ë¹„ì–´ ìžˆìŠµë‹ˆë‹¤."),c?.trim()||e.push("ì˜¤ë¥¸ìª½ JSONì´ ë¹„ì–´ ìžˆìŠµë‹ˆë‹¤."),u&&e.push(`ì™¼ìª½ íŒŒì‹± ì˜¤ë¥˜: ${u}`),C&&e.push(`ì˜¤ë¥¸ìª½ íŒŒì‹± ì˜¤ë¥˜: ${C}`),s(e.join(" "));return}s(""),ce()},Le="calc(100vh - 360px)",Q={minHeight:32,height:32,px:1.25};return t.jsxs(rt,{sx:{p:1.25,display:"flex",flexDirection:"column",gap:1.25,flex:1,minHeight:785,height:"100%",width:1,maxWidth:"100%",overflowX:"hidden"},children:[_e,t.jsxs(T,{direction:"row",spacing:1,alignItems:"center",justifyContent:"space-between",children:[t.jsx(T,{direction:"row",spacing:1,alignItems:"center",children:t.jsx(K,{variant:"outlined",size:"small",sx:{...Q,minWidth:140},onClick:be,disabled:!x.trim()&&!c.trim(),children:"JSON í¬ë§·"})}),t.jsxs(T,{direction:"row",spacing:1.25,alignItems:"center",justifyContent:"flex-end",children:[t.jsxs(T,{direction:"row",spacing:1,alignItems:"center",children:[t.jsx(nt,{fontSize:"small",color:J?"primary":"disabled"}),t.jsx(Te,{size:"small",checked:J,onChange:e=>Z(e.target.checked)}),t.jsx(I,{variant:"caption",children:"ìŠ¤í¬ë¡¤ ë™ê¸°í™”"})]}),t.jsxs(T,{direction:"row",spacing:1,alignItems:"center",children:[t.jsx(I,{variant:"caption",children:"í‚¤ ì •ë ¬"}),t.jsx(Te,{size:"small",checked:de,onChange:e=>U(e.target.checked)})]}),t.jsx(K,{variant:"outlined",size:"small",color:"primary",onClick:()=>_(!0),disabled:F.total===0||re,sx:Q,children:"ìš”ì•½ ë³´ê¸°"}),t.jsx(K,{variant:"contained",size:"small",color:"primary",startIcon:t.jsx(ot,{}),onClick:Qe,disabled:re,sx:Q,children:"ë¹„êµ"})]})]}),(u||C||ae)&&t.jsx(st,{severity:"error",children:t.jsxs(I,{variant:"body2",children:[ae,ae&&(u||C)?" / ":"",u?`ì™¼ìª½: ${u}`:"",u&&C?" / ":"",C?`ì˜¤ë¥¸ìª½: ${C}`:""]})}),re&&t.jsx(at,{}),t.jsxs(R,{ref:S,sx:{flex:1,minHeight:0,width:1,display:"grid",flexDirection:"row",gridTemplateColumns:`minmax(0, ${He}fr) 6px minmax(0, ${Xe}fr)`,columnGap:1,gap:1,alignItems:"stretch",touchAction:"none",overflow:"hidden",overscrollBehavior:"contain",contain:"layout size paint"},children:[t.jsxs(T,{sx:{p:1.25,border:"1px solid",borderColor:"divider",borderRadius:1,bgcolor:"background.paper",display:"flex",flexDirection:"column",gap:1,minWidth:0,minHeight:0,overflow:"hidden"},children:[t.jsxs(T,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[t.jsx(I,{variant:"subtitle2",children:"JSON (ì›ë³¸)"}),t.jsxs(R,{children:[t.jsx("input",{id:o,type:"file",accept:".json,application/json",hidden:!0,onChange:e=>pe(e.target.files?.[0]??null)}),t.jsx("label",{htmlFor:o,children:t.jsx(K,{component:"span",variant:"contained",size:"small",startIcon:t.jsx(De,{}),sx:{...Q,minWidth:150},children:"JSON ì—…ë¡œë“œ"})})]})]}),t.jsx(R,{sx:{flex:1,height:Le,minHeight:200,border:"1px solid",borderColor:"divider",borderRadius:1,overflow:"hidden",overscrollBehavior:"contain",position:"relative"},children:t.jsx(Be,{height:"100%",language:"json",theme:ye,value:x,onChange:e=>xe(e??""),onMount:Ge,options:{automaticLayout:!0,minimap:{enabled:!0},scrollBeyondLastLine:!1,lineNumbers:"on",glyphMargin:!0}})})]}),t.jsx(R,{sx:{width:6,justifySelf:"stretch",cursor:"col-resize",bgcolor:"divider","&:hover":{bgcolor:"action.hover"},borderRadius:1,display:"flex",alignItems:"center",justifyContent:"center",userSelect:"none"},onMouseDown:ke,onTouchStart:ke,children:t.jsxs(R,{sx:{display:"flex",flexDirection:"column",gap:.25},children:[t.jsx(R,{sx:{width:2,height:2,bgcolor:"text.secondary",borderRadius:"50%"}}),t.jsx(R,{sx:{width:2,height:2,bgcolor:"text.secondary",borderRadius:"50%"}}),t.jsx(R,{sx:{width:2,height:2,bgcolor:"text.secondary",borderRadius:"50%"}})]})}),t.jsxs(T,{sx:{p:1.25,border:"1px solid",borderColor:"divider",borderRadius:1,bgcolor:"background.paper",display:"flex",flexDirection:"column",gap:1,minWidth:0,minHeight:0,overflow:"hidden"},children:[t.jsxs(T,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[t.jsx(I,{variant:"subtitle2",children:"JSON (ë¹„êµ)"}),t.jsxs(R,{children:[t.jsx("input",{id:d,type:"file",accept:".json,application/json",hidden:!0,onChange:e=>D(e.target.files?.[0]??null)}),t.jsx("label",{htmlFor:d,children:t.jsx(K,{component:"span",variant:"contained",size:"small",startIcon:t.jsx(De,{}),sx:{...Q,minWidth:150},children:"JSON ì—…ë¡œë“œ"})})]})]}),t.jsx(R,{sx:{flex:1,height:Le,minHeight:200,border:"1px solid",borderColor:"divider",borderRadius:1,overflow:"hidden",overscrollBehavior:"contain",position:"relative"},children:t.jsx(Be,{height:"100%",language:"json",theme:ye,value:c,onChange:e=>le(e??""),onMount:Ue,options:{automaticLayout:!0,minimap:{enabled:!0},scrollBeyondLastLine:!1,lineNumbers:"on",glyphMargin:!0}})})]})]}),t.jsxs(Pe,{open:B,onClose:()=>_(!1),maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{maxWidth:680}},children:[t.jsx(Je,{sx:{fontSize:14,fontWeight:600},children:"ìš”ì•½ ë³´ê¸°"}),t.jsx(Ae,{dividers:!0,sx:{display:"flex",flexDirection:"column",gap:1.25},children:F.total===0?t.jsx(I,{variant:"body2",color:"text.secondary",children:"ë¹„êµëœ ë³€ê²½ ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤. JSONì„ ìž…ë ¥í•˜ê³  â€œë¹„êµâ€ë¥¼ ëˆŒëŸ¬ ì£¼ì„¸ìš”."}):t.jsxs(t.Fragment,{children:[t.jsxs(T,{direction:"row",spacing:1,alignItems:"center",justifyContent:"space-between",children:[t.jsxs(T,{direction:"row",spacing:1,alignItems:"center",children:[t.jsx(me,{label:`ì¶”ê°€ ${F.added}`,size:"small",color:"success",variant:w.added?"filled":"outlined",onClick:()=>b(e=>({...e,added:!e.added}))}),t.jsx(me,{label:`ì‚­ì œ ${F.removed}`,size:"small",color:"error",variant:w.removed?"filled":"outlined",onClick:()=>b(e=>({...e,removed:!e.removed}))}),t.jsx(me,{label:`ìˆ˜ì • ${F.changed}`,size:"small",color:"warning",variant:w.changed?"filled":"outlined",onClick:()=>b(e=>({...e,changed:!e.changed}))})]}),t.jsx(me,{label:`ë³€ê²½ëœ í‚¤ ${F.total}ê°œ`,size:"small",variant:"outlined"})]}),t.jsx(R,{sx:{maxHeight:360,overflowY:"auto"},children:ue.length===0?t.jsx(I,{variant:"body2",color:"text.secondary",children:"ì„ íƒí•œ ìœ í˜•ì˜ ë³€ê²½ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤."}):t.jsxs(it,{size:"small",sx:{tableLayout:"fixed","& th, & td":{fontSize:12}},children:[t.jsx(lt,{children:t.jsxs(Ie,{children:[t.jsx(G,{sx:{bgcolor:"action.hover",fontWeight:700,width:64},children:"êµ¬ë¶„"}),t.jsx(G,{sx:{bgcolor:"action.hover",fontWeight:700,width:72},children:"LINE"}),t.jsx(G,{sx:{bgcolor:"action.hover",fontWeight:700},children:"ì›ë³¸"}),t.jsx(G,{sx:{bgcolor:"action.hover",fontWeight:700},children:"ë¹„êµ"})]})}),t.jsx(ct,{children:Fe.map(e=>{const n=e.type!=="added"?ee(a.current?.getModel()??null,We,e.path)?.range?.startLineNumber:null,l=e.type!=="removed"?ee(m.current?.getModel()??null,$e,e.path)?.range?.startLineNumber:null,i=n??l??"-";return t.jsxs(Ie,{children:[t.jsx(G,{sx:{width:64},children:e.type==="added"?"ì¶”ê°€":e.type==="removed"?"ì‚­ì œ":"ìˆ˜ì •"}),t.jsx(G,{sx:{width:72},children:i}),t.jsx(G,{sx:{maxWidth:200,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e.type!=="added"?JSON.stringify(e.leftValue):"-"}),t.jsx(G,{sx:{maxWidth:200,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e.type!=="removed"?JSON.stringify(e.rightValue):"-"})]},e.path)})})]})}),t.jsx(dt,{component:"div",rowsPerPageOptions:[he],count:ue.length,rowsPerPage:he,page:se,onPageChange:(e,n)=>Y(n),onRowsPerPageChange:()=>{}})]})}),t.jsx(ze,{children:t.jsx(K,{size:"small",sx:Q,onClick:()=>_(!1),children:"ë‹«ê¸°"})})]}),t.jsxs(Pe,{open:!!z,onClose:()=>V(null),maxWidth:"md",fullWidth:!0,children:[t.jsxs(Je,{children:["Diff ìƒì„¸ â€“ ",z?.path]}),t.jsxs(Ae,{dividers:!0,sx:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(240px, 1fr))",gap:1.25},children:[t.jsxs(R,{children:[t.jsx(I,{variant:"subtitle2",gutterBottom:!0,children:"ì™¼ìª½ (ì›ë³¸)"}),t.jsx(R,{component:"pre",sx:{m:0,p:1,borderRadius:1,bgcolor:"background.default",border:"1px solid",borderColor:"divider",fontSize:13,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:z?.type!=="added"?JSON.stringify(z?.leftValue,null,2):"(í•´ë‹¹ ì—†ìŒ)"})]}),t.jsxs(R,{children:[t.jsx(I,{variant:"subtitle2",gutterBottom:!0,children:"ì˜¤ë¥¸ìª½ (ë¹„êµ)"}),t.jsx(R,{component:"pre",sx:{m:0,p:1,borderRadius:1,bgcolor:"background.default",border:"1px solid",borderColor:"divider",fontSize:13,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:z?.type!=="removed"?JSON.stringify(z?.rightValue,null,2):"(í•´ë‹¹ ì—†ìŒ)"})]})]}),t.jsx(ze,{children:t.jsx(K,{size:"small",sx:Q,onClick:()=>V(null),children:"ë‹«ê¸°"})})]})]})},ie=h=>Array.isArray(h)?h.map(ie):h&&typeof h=="object"?Object.entries(h).sort(([c],[u])=>c.localeCompare(u)).reduce((c,[u,C])=>(c[u]=ie(C),c),{}):h,ht=(h,x)=>{const c=JSON.parse(h),u=x?ie(c):c;return JSON.stringify(u,null,2)},ft=()=>r.useCallback(async h=>h?new Promise((x,c)=>{const u=new FileReader;u.onerror=()=>c(new Error("íŒŒì¼ì„ ì½ëŠ” ì¤‘ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")),u.onload=C=>{const f=C.target?.result;typeof f=="string"?x(f):c(new Error("íŒŒì¼ ë‚´ìš©ì´ ë¹„ì–´ ìžˆìŠµë‹ˆë‹¤."))},u.readAsText(h)}):"",[]),gt=()=>{const[h,x]=r.useState("{}"),[c,u]=r.useState("{}"),[C,f]=r.useState(null),[pe,D]=r.useState(null),[xe,le]=r.useState([]),[be,ce]=r.useState(null),[re,de]=r.useState(null),[U,ne]=r.useState(!1),[oe,J]=r.useState(!1),Z=ft(),w=r.useCallback((s,o,d,a=!1)=>{try{const m=ht(s,a);return o(m),d(null),m}catch(m){const S=m instanceof Error?m.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜";return d(`ìœ íš¨í•œ JSONì´ ì•„ë‹™ë‹ˆë‹¤. (${S})`),null}},[]),b=r.useCallback(()=>{le([]),ce(null),de(null)},[]),z=r.useCallback(async s=>{try{const o=await Z(s);if(o&&!w(o,x,f))return;b()}catch(o){f(o instanceof Error?o.message:"ì™¼ìª½ JSONì„ ì½ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")}D(null)},[w,Z,b]),V=r.useCallback(async s=>{try{const o=await Z(s);if(o&&!w(o,u,D))return;b()}catch(o){D(o instanceof Error?o.message:"ì˜¤ë¥¸ìª½ JSONì„ ì½ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")}f(null)},[w,Z,b]),B=r.useCallback(s=>{x(s),f(null),b()},[b]),_=r.useCallback(s=>{u(s),D(null),b()},[b]),se=r.useCallback(()=>{const s=w(h,x,f),o=w(c,u,D);(s||o)&&b()},[w,h,b,c]),Y=r.useCallback((s,o,d="root")=>{const a=[],m=S=>JSON.stringify(S);if(Array.isArray(s)&&Array.isArray(o)){const S=Math.max(s.length,o.length);for(let p=0;p<S;p+=1){const W=d==="root"?`[${p}]`:`${d}[${p}]`;p>=s.length?a.push({path:W,type:"added",rightValue:o[p]}):p>=o.length?a.push({path:W,type:"removed",leftValue:s[p]}):a.push(...Y(s[p],o[p],W))}return a}if(s&&typeof s=="object"&&o&&typeof o=="object"){const S=Object.entries(s),p=Object.entries(o);return Array.from(new Set([...S.map(([y])=>y),...p.map(([y])=>y)])).sort((y,k)=>y.localeCompare(k)).forEach(y=>{const k=Object.prototype.hasOwnProperty.call(s,y),$=Object.prototype.hasOwnProperty.call(o,y),A=d==="root"?y:`${d}.${y}`;$?k?a.push(...Y(s[y],o[y],A)):a.push({path:A,type:"added",rightValue:o[y]}):a.push({path:A,type:"removed",leftValue:s[y]})}),a}return m(s)!==m(o)&&a.push({path:d,type:"changed",leftValue:s,rightValue:o}),a},[]),ae=r.useCallback(async()=>{let s,o;J(!0);try{try{s=JSON.parse(h),f(null)}catch(d){const a=d instanceof Error?d.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜";return f(`ìœ íš¨í•œ JSONì´ ì•„ë‹™ë‹ˆë‹¤. (${a})`),b(),!1}try{o=JSON.parse(c),D(null)}catch(d){const a=d instanceof Error?d.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜";return D(`ìœ íš¨í•œ JSONì´ ì•„ë‹™ë‹ˆë‹¤. (${a})`),b(),!1}try{await new Promise(p=>setTimeout(p,0));const d=U?ie(s):s,a=U?ie(o):o,m=JSON.stringify(d,null,2),S=JSON.stringify(a,null,2);le(Y(d,a)),ce(m),de(S),U&&(x(m),u(S))}catch(d){const a=d instanceof Error?d.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜";return f(a),D(a),b(),!1}return!0}finally{J(!1)}},[Y,h,b,c,U]);return{leftJson:h,rightJson:c,leftError:C,rightError:pe,handleLeftUpload:z,handleRightUpload:V,handleLeftTextChange:B,handleRightTextChange:_,formatBothJson:se,handleCompare:ae,isComparing:oe,diffNodes:xe,comparisonLeft:be,comparisonRight:re,sortBeforeCompare:U,setSortBeforeCompare:ne}},jt=()=>{const h=gt();return t.jsx(ut,{controller:h})};export{jt as default};

import{r as o,j as e}from"./vendor-DyxFRNuv.js";import{S as m,o as G,K as ee,I as T,ah as te,T as P,ai as ne,aj as oe,ab as re,ak as se,a as J,al as ae,ae as ie,u as ce,q as le,P as de,B as b,a8 as ue}from"./mui-Dn-s4uu_.js";import{M as X}from"./monaco-editor-C1_Zlzod.js";import"./excel-CUMakpxJ.js";import"./tree-sitter-DJeWk4Ia.js";const he=n=>{if(!n.trim())return null;try{return JSON.parse(n)}catch(r){return r instanceof Error?r.message:String(r)}},B=n=>Array.isArray(n)?n.map(B):n&&typeof n=="object"?Object.keys(n).sort((r,i)=>r.localeCompare(i)).reduce((r,i)=>(r[i]=B(n[i]),r),{}):n,me=(n,r)=>JSON.stringify(n,null,r),fe=()=>{const[n,r]=o.useState(""),[i,d]=o.useState(""),[f,c]=o.useState(null),[p,u]=o.useState(2),[R,M]=o.useState(!1),j=a=>r(a),w=a=>{const h=a.target.files?.[0];if(!h)return;const l=new FileReader;l.onload=()=>{const C=l.result;typeof C=="string"&&r(C)},l.readAsText(h)},I=o.useCallback(()=>{const a=he(n);if(typeof a=="string"){c(a);return}if(a===null){d(""),c(null);return}const h=R?B(a):a;d(me(h,p)),c(null)},[n,p,R]);return{raw:n,formatted:i,error:f,indent:p,sortKeys:R,setIndent:u,setSortKeys:M,handleRawChange:j,handleUpload:w,handleFormat:I,handleDownload:()=>{const a=new Blob([i],{type:"application/json"}),h=URL.createObjectURL(a),l=document.createElement("a");l.href=h,l.download="formatted.json",l.click(),URL.revokeObjectURL(h)}}},pe=(n,r)=>{if(!n||!r.trim())return{decorations:[],ranges:[]};const i=n.findMatches(r,!1,!1,!1,null,!0,200),d=i.map(c=>({range:c.range,options:{inlineClassName:"formatter-search-hit"}})),f=i.map(c=>c.range);return{decorations:d,ranges:f}},xe=({searchTerm:n,matchCount:r,matchIndex:i,onSearchTermChange:d,onPrevMatch:f,onNextMatch:c})=>e.jsxs(m,{direction:{xs:"column",md:"row"},justifyContent:"space-between",alignItems:{md:"center"},spacing:1,children:[e.jsx(G,{fullWidth:!0,size:"small",placeholder:"키/값 검색",value:n,onChange:p=>d(p.target.value),InputProps:{endAdornment:n?e.jsx(ee,{position:"end",children:e.jsx(T,{size:"small",onClick:()=>d(""),children:e.jsx(te,{fontSize:"small"})})}):void 0},sx:{minWidth:220}}),e.jsx(m,{direction:"row",spacing:1,alignItems:"center",sx:{width:"auto"},children:e.jsxs(m,{direction:"row",spacing:.5,alignItems:"center",sx:{whiteSpace:"nowrap"},children:[e.jsx(P,{variant:"caption",color:"text.secondary",children:r?`${i+1}/${r}`:"0/0"}),e.jsx(T,{size:"small",onClick:f,disabled:!r,sx:{bgcolor:"action.hover"},children:e.jsx(ne,{fontSize:"small"})}),e.jsx(T,{size:"small",onClick:c,disabled:!r,sx:{bgcolor:"action.hover"},children:e.jsx(oe,{fontSize:"small"})})]})})]}),ge=({indent:n,sortKeys:r,formatted:i,onIndentChange:d,onSortKeysChange:f,onFormat:c,onDownload:p})=>e.jsx(m,{children:e.jsx(m,{direction:"row",justifyContent:"end",alignItems:{md:"center"},spacing:1,flexWrap:"wrap",children:e.jsxs(m,{direction:"row",spacing:1,alignItems:{md:"center"},flexWrap:"wrap",children:[e.jsx(re,{control:e.jsx(se,{size:"small",checked:r,onChange:u=>f(u.target.checked)}),label:e.jsx(P,{variant:"body2",children:"키 정렬"})}),e.jsxs(m,{direction:"row",spacing:1,alignItems:"center",flexWrap:"wrap",children:[e.jsx(P,{variant:"body2",color:"text.secondary",children:"공백 크기"}),e.jsx(G,{select:!0,size:"small",value:n,onChange:u=>d(Number(u.target.value)),SelectProps:{native:!0},sx:{width:80},children:[2,4,8].map(u=>e.jsx("option",{value:u,children:u},u))})]}),e.jsx(J,{variant:"contained",size:"small",startIcon:e.jsx(ae,{}),onClick:c,children:"포맷"}),e.jsx(J,{variant:"outlined",size:"small",color:"primary",startIcon:e.jsx(ie,{}),onClick:p,disabled:!i,children:"다운로드"})]})})}),$="calc(100dvh - 380px)",be=({raw:n,formatted:r,indent:i,sortKeys:d,setIndent:f,setSortKeys:c,handleRawChange:p,handleUpload:u,handleFormat:R,handleDownload:M})=>{const j=ce(),w=le(j.breakpoints.up("md")),I=j.palette.mode==="dark"?"vs-dark":"vs-light",k=o.useRef(null),a=o.useRef(!1),h=o.useRef(null),l=o.useRef(null),C=o.useRef(null),O=o.useRef([]),U=o.useRef([]),[D,W]=o.useState(.5),[z,_]=o.useState(""),[E,F]=o.useState(-1),[S,q]=o.useState(0),Q=D,V=1-D,L=o.useCallback(()=>{h.current?.layout(),l.current?.layout()},[]);o.useEffect(()=>{L()},[D,L]);const A=o.useCallback(t=>Math.min(Math.max(t,.2),.8),[]),v=o.useCallback(t=>{if(!k.current)return;const s=k.current.getBoundingClientRect();s.width<=0||W(A((t-s.left)/s.width))},[A]),N=o.useCallback(()=>{a.current=!1,document.body.style.cursor="",document.body.style.userSelect=""},[]),H=o.useCallback(t=>{if(w)if(a.current=!0,document.body.style.cursor="col-resize",document.body.style.userSelect="none","touches"in t){const s=t.touches[0];s&&v(s.clientX)}else v(t.clientX)},[w,v]);o.useEffect(()=>{const t=y=>{a.current&&(y.preventDefault(),v(y.clientX))},s=y=>{if(!a.current)return;const x=y.touches[0];x&&(y.preventDefault(),v(x.clientX))},g=()=>N();return window.addEventListener("mousemove",t),window.addEventListener("mouseup",g),window.addEventListener("touchmove",s,{passive:!1}),window.addEventListener("touchend",g),window.addEventListener("touchcancel",g),()=>{window.removeEventListener("mousemove",t),window.removeEventListener("mouseup",g),window.removeEventListener("touchmove",s),window.removeEventListener("touchend",g),window.removeEventListener("touchcancel",g)}},[N,v]),o.useEffect(()=>{w||(a.current=!1,document.body.style.cursor="",document.body.style.userSelect="",W(.5))},[w]);const K=o.useCallback(t=>{const s=l.current;if(!s)return;const g=s.getModel(),{decorations:y,ranges:x}=pe(g,t);O.current=s.deltaDecorations(O.current,y),U.current=x,q(x.length),F(x.length?0:-1),x[0]&&(s.revealRangeInCenter(x[0]),s.setSelection(x[0]))},[]);o.useEffect(()=>{K(z)},[r,z,K]),o.useEffect(()=>{if(E<0)return;const t=l.current,s=U.current[E];t&&s&&(t.revealRangeInCenter(s),t.setSelection(s))},[E]);const Y=()=>{S&&F(t=>t<=0?S-1:t-1)},Z=()=>{S&&F(t=>t>=S-1||t<0?0:t+1)};return e.jsxs(de,{sx:{p:1.25,display:"flex",flexDirection:"column",gap:1.25,flex:1,minHeight:785,height:"100%",width:1,maxWidth:"100%",overflowX:"hidden"},children:[e.jsx(ge,{indent:i,sortKeys:d,formatted:r,onIndentChange:f,onSortKeysChange:c,onFormat:R,onDownload:M}),e.jsxs(b,{ref:k,sx:{display:"grid",flexDirection:"row",gridTemplateColumns:`minmax(0, ${Q}fr) 6px minmax(0, ${V}fr)`,gap:0,columnGap:{md:1},minHeight:0,flex:1,touchAction:"none"},children:[e.jsxs(m,{sx:{p:1.25,border:"1px solid",borderColor:"divider",borderRadius:1,bgcolor:"background.paper",display:"flex",flexDirection:"column",gap:1,minWidth:0,minHeight:0,overflow:"hidden"},children:[e.jsxs(m,{direction:"row",justifyContent:"flex-end",alignItems:"center",spacing:1,children:[e.jsx("input",{ref:C,type:"file",accept:"application/json",hidden:!0,onChange:u}),e.jsx(J,{variant:"outlined",size:"small",color:"primary",startIcon:e.jsx(ue,{}),onClick:()=>C.current?.click(),children:"JSON 업로드"})]}),e.jsx(b,{sx:{flex:1,height:$,border:"1px solid",borderColor:"divider",borderRadius:1,overflow:"hidden"},children:e.jsx(X,{height:"100%",language:"json",theme:I,value:n,onMount:t=>{h.current=t,L()},onChange:t=>p(t??""),options:{automaticLayout:!0,minimap:{enabled:!0},fontSize:12,padding:{top:1.25,bottom:8},scrollBeyondLastLine:!1}})})]}),w&&e.jsx(b,{sx:{width:6,justifySelf:"stretch",cursor:"col-resize",bgcolor:"divider","&:hover":{bgcolor:"action.hover"},borderRadius:1,display:"flex",alignItems:"center",justifyContent:"center",userSelect:"none"},onMouseDown:H,onTouchStart:H,children:e.jsxs(b,{sx:{display:"flex",flexDirection:"column",gap:.25},children:[e.jsx(b,{sx:{width:2,height:2,bgcolor:"text.secondary",borderRadius:"50%"}}),e.jsx(b,{sx:{width:2,height:2,bgcolor:"text.secondary",borderRadius:"50%"}}),e.jsx(b,{sx:{width:2,height:2,bgcolor:"text.secondary",borderRadius:"50%"}})]})}),e.jsxs(m,{sx:{p:1.25,border:"1px solid",borderColor:"divider",borderRadius:1,bgcolor:"background.paper",display:"flex",flexDirection:"column",gap:1,minWidth:0,minHeight:0,overflow:"hidden","& .formatter-search-hit":{backgroundColor:j.palette.warning.light,color:j.palette.getContrastText(j.palette.warning.light)}},children:[e.jsx(xe,{searchTerm:z,matchCount:S,matchIndex:E,onSearchTermChange:_,onPrevMatch:Y,onNextMatch:Z}),e.jsx(b,{sx:{flex:1,height:$,border:"1px solid",borderColor:"divider",borderRadius:1,overflow:"hidden"},children:e.jsx(X,{height:"100%",language:"json",theme:I,value:r,onMount:t=>{l.current=t,L()},options:{readOnly:!0,automaticLayout:!0,minimap:{enabled:!0},fontSize:12,padding:{top:1.25,bottom:8},scrollBeyondLastLine:!1}})})]})]})]})},Ce=()=>{const n=fe();return e.jsx(be,{...n})};export{Ce as default};

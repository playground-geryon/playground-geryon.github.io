import{j as e,r as s,w as Oe}from"./vendor-DyxFRNuv.js";import{B as J,S as m,I as ae,g as Ae,J as ze,T as g,a9 as Pe,P as K,ab as be,ac as je,h as he,y as pe,z as Q,a as me,ao as _e,az as De,o as Be,bF as Fe,K as Ge,O as Ve,bG as qe,bH as Ue,aa as Ke,aZ as Qe,a2 as Je,u as Xe}from"./mui-B8yGrLIc.js";import{M as ye}from"./monaco-editor-M5VMZYyH.js";import"./excel-CUMakpxJ.js";import"./tree-sitter-DJeWk4Ia.js";const Ze=({index:r,style:c,data:n})=>{const{nodes:d,expandedSet:l,selectedNodeId:j,onSelect:x,onToggle:T,matchSet:C,activeMatchId:R}=n,{node:a,depth:H}=d[r],E=l.has(a.id),D=a.children.length>0,G=a.id===j,O=C.has(a.id),v=a.id===R;return e.jsx(J,{style:c,children:e.jsxs(m,{direction:"row",alignItems:"center",spacing:.5,sx:{pl:.5+H*1.25,pr:.75,py:.1,borderRadius:.75,cursor:"pointer",border:v?"1px solid":void 0,borderColor:v?"primary.main":void 0,bgcolor:G?"action.selected":O?"action.hover":void 0,"&:hover":{bgcolor:"action.hover"}},onClick:()=>x(a.id),children:[D?e.jsx(ae,{size:"small",onClick:M=>{M.stopPropagation(),T(a.id)},children:E?e.jsx(Ae,{fontSize:"small"}):e.jsx(ze,{fontSize:"small"})}):e.jsx(J,{sx:{width:32}}),e.jsxs(m,{direction:"row",spacing:.5,sx:{minWidth:0,flexWrap:"wrap"},children:[e.jsx(g,{variant:"body2",fontWeight:700,color:"primary.main",sx:{minWidth:0,whiteSpace:"pre-wrap",wordBreak:"break-all"},children:`<${a.tag}`}),a.elementId&&e.jsx(g,{variant:"body2",fontWeight:600,color:"info.main",sx:{minWidth:0,whiteSpace:"pre-wrap",wordBreak:"break-all"},children:`#${a.elementId}`}),a.classNames.length>0&&e.jsx(g,{variant:"body2",fontWeight:600,color:"success.main",sx:{minWidth:0,whiteSpace:"pre-wrap",wordBreak:"break-all"},children:a.classNames.join(" ")}),e.jsx(g,{variant:"body2",fontWeight:700,color:"primary.main",sx:{minWidth:0,whiteSpace:"pre-wrap",wordBreak:"break-all"},children:">"})]}),a.previewText&&e.jsx(Pe,{title:a.previewText,placement:"top",arrow:!0,children:e.jsx(g,{variant:"caption",color:"text.secondary",sx:{whiteSpace:"pre-wrap",wordBreak:"break-all",textOverflow:"ellipsis",overflow:"hidden"},children:a.previewText})})]})})},Ye=({editorTheme:r,htmlText:c,onHtmlChange:n,onEditorMount:d,stripScripts:l,stripMeta:j,onStripScriptsChange:x,onStripMetaChange:T,onGenerate:C,hasSelectedNode:R,flatNodes:a,visibleNodes:H,expandedSet:E,selectedNodeId:D,onSelectNode:G,onToggleNode:O,searchDraft:v,onSearchDraftChange:M,onTriggerSearch:I,onMatchStep:q,matchSummary:z,hasMatches:B,matchSet:U,activeMatchId:L,selectedPath:X,statusMessage:re,listRef:Z,suggestionOptions:$})=>{const Y=s.useRef(null),[ee,F]=s.useState(320),[A,y]=s.useState("dom"),S=s.useMemo(()=>{const i=v.trim().toLowerCase();if(!i)return $.slice(0,12);const u=i[0],h=u==="<",W=u==="#"||u==="."||h?i.slice(1):i,P=$.filter(N=>!N.startsWith("#")&&!N.startsWith("."));return h?W?P.filter(N=>N.toLowerCase().startsWith(W)).slice(0,12):P.slice(0,12):$.filter(N=>{const _=N.toLowerCase();return u==="#"&&!_.startsWith("#")||u==="."&&!_.startsWith(".")||h&&(_.startsWith("#")||_.startsWith("."))?!1:_.replace(/^[#.]/,"").startsWith(W)}).slice(0,12)},[v,$]);return s.useEffect(()=>{const i=Y.current;if(!i||typeof ResizeObserver>"u")return;const u=()=>{F(Math.max(160,i.clientHeight))};u();const h=new ResizeObserver(u);return h.observe(i),()=>h.disconnect()},[]),e.jsxs(K,{variant:"outlined",sx:{flex:"1 1 55%",height:"calc(100vh - 200px)",p:1.25,display:"flex",flexDirection:"column",gap:1.25,minHeight:765,minWidth:0,overflow:"hidden",maxWidth:"100%"},children:[e.jsxs(m,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[e.jsx(m,{spacing:.25,children:e.jsx(g,{variant:"subtitle1",fontWeight:600,children:"HTML 입력 · DOM 선택"})}),e.jsx(m,{direction:"row",spacing:1,alignItems:"center",flexWrap:"wrap",justifyContent:"flex-end",children:e.jsxs(m,{direction:"row",spacing:.75,alignItems:"center",children:[e.jsx(be,{control:e.jsx(je,{size:"small",checked:l,onChange:i=>x(i.target.checked)}),label:"script 제거"}),e.jsx(be,{control:e.jsx(je,{size:"small",checked:j,onChange:i=>T(i.target.checked)}),label:"meta 제거"})]})})]}),e.jsx(J,{sx:i=>({border:"1px solid",borderColor:"divider",borderRadius:1,overflow:"hidden",flex:1,minHeight:280,"& .html-explorer-selection":{backgroundColor:i.palette.mode==="dark"?"rgba(59,130,246,0.35)":"rgba(59,130,246,0.2)",borderRadius:0,paddingTop:"2px",paddingBottom:"2px"}}),children:e.jsx(ye,{height:"100%",defaultLanguage:"html",language:"html",theme:r,value:c,onChange:i=>n(i??""),onMount:(i,u)=>d(i,u),options:{minimap:{enabled:!1},fontSize:12,lineNumbers:"on",scrollBeyondLastLine:!1,wordWrap:"on"}})}),e.jsx(he,{}),e.jsxs(m,{spacing:.75,sx:{flex:1,minHeight:0},children:[e.jsxs(m,{direction:"row",spacing:1,alignItems:"center",justifyContent:"space-between",sx:{minWidth:0},children:[e.jsxs(pe,{value:A,onChange:(i,u)=>y(u),textColor:"primary",indicatorColor:"primary",variant:"scrollable",allowScrollButtonsMobile:!0,sx:{flex:1,minWidth:0,"& .MuiTab-root":{minWidth:0,whiteSpace:"nowrap"}},children:[e.jsx(Q,{value:"dom",label:`DOM 구조 (${a.length})`}),e.jsx(Q,{value:"selected",label:"선택됨"})]}),e.jsx(me,{variant:"contained",startIcon:e.jsx(_e,{}),onClick:C,disabled:!R,children:"코드 생성"})]}),e.jsx(he,{}),A==="dom"&&e.jsxs(m,{spacing:.75,sx:{flex:1,minHeight:0},children:[e.jsxs(m,{direction:"row",spacing:.5,alignItems:"center",children:[e.jsx(De,{freeSolo:!0,fullWidth:!0,size:"small",disableClearable:!0,options:S,filterOptions:i=>i,value:v,inputValue:v,onInputChange:(i,u,h)=>{M(u),(h==="reset"||h==="selectOption")&&I(u)},onChange:(i,u)=>{if(typeof u=="string"){const W=v.trim().startsWith("<")?`<${u.replace(/^<|>$/g,"")}>`:u;M(W),I(W)}},renderOption:(i,u)=>{const h=u,W=h.startsWith("#"),P=h.startsWith("."),N=h.replace(/^[#.]/,""),_=v.trim().startsWith("<");return e.jsx("li",{...i,children:e.jsxs(m,{direction:"row",spacing:.5,alignItems:"center",children:[e.jsx(g,{variant:"caption",fontWeight:700,color:W?"info.main":P?"success.main":"primary.main",children:W?"#ID":P?".CLASS":"<TAG>"}),e.jsx(g,{variant:"body2",children:_&&!W&&!P?`<${N}>`:N})]})})},renderInput:i=>e.jsx(Be,{...i,placeholder:"DOM 경로 / 텍스트 검색",InputProps:{...i.InputProps,startAdornment:e.jsx(Ge,{position:"start",children:e.jsx(Ve,{fontSize:"small"})}),endAdornment:e.jsxs(e.Fragment,{children:[v?e.jsx(ae,{size:"small",onClick:()=>{M(""),I()},"aria-label":"검색어 지우기",children:e.jsx(Fe,{fontSize:"small"})}):null,i.InputProps.endAdornment]})},onKeyDown:u=>{u.key==="Enter"&&(u.preventDefault(),I())}})}),e.jsxs(m,{direction:"row",spacing:.25,alignItems:"center",children:[e.jsx(me,{variant:"outlined",size:"small",onClick:()=>I(),children:"검색"}),e.jsx(ae,{size:"small",disabled:!B,onClick:()=>q("prev"),children:e.jsx(qe,{fontSize:"small"})}),e.jsx(ae,{size:"small",disabled:!B,onClick:()=>q("next"),children:e.jsx(Ue,{fontSize:"small"})}),e.jsx(g,{variant:"caption",color:"text.secondary",sx:{minWidth:48,textAlign:"center"},children:z})]})]}),e.jsx(J,{ref:Y,sx:{border:"1px solid",borderColor:"divider",borderRadius:1,minHeight:0,flex:1,bgcolor:"background.paper",overflow:"hidden"},children:H.length?e.jsx(Oe,{ref:Z,height:ee,width:"100%",itemCount:H.length,itemSize:32,overscanCount:6,itemData:{nodes:H,expandedSet:E,selectedNodeId:D,onSelect:G,onToggle:O,matchSet:U,activeMatchId:L},children:Ze}):e.jsxs(m,{spacing:.5,alignItems:"center",justifyContent:"center",sx:{minHeight:140},children:[e.jsx(Ke,{color:"disabled",fontSize:"small"}),e.jsx(g,{variant:"body2",color:"text.secondary",align:"center",children:"HTML에서 DOM 요소를 찾을 수 없습니다."})]})})]}),A==="selected"&&e.jsxs(m,{spacing:.75,sx:{flex:1,minHeight:0,minWidth:0},children:[e.jsxs(m,{spacing:.25,children:[e.jsx(g,{variant:"caption",color:"text.secondary",children:"선택된 경로"}),e.jsx(g,{variant:"body2",sx:{fontFamily:"monospace",borderRadius:1,border:"1px solid",borderColor:"divider",px:1,py:.5,bgcolor:"background.default",whiteSpace:"pre-wrap",wordBreak:"break-all",overflowWrap:"anywhere"},children:X})]}),re&&e.jsxs(m,{direction:"row",spacing:.5,alignItems:"center",color:"warning.main",children:[e.jsx(Qe,{fontSize:"small"}),e.jsx(g,{variant:"body2",children:re})]})]})]})]})},et=({tab:r,onTabChange:c,codeTab:n,onCodeTabChange:d,extraction:l,selectedPath:j,editorTheme:x,nodeScript:T,pythonScript:C,copyHint:R,onCopyCode:a})=>e.jsxs(K,{variant:"outlined",sx:{flex:"1 1 45%",height:"calc(100vh - 195px)",p:1.25,display:"flex",flexDirection:"column",gap:1,minHeight:0,minWidth:0,overflow:"hidden",maxWidth:"100%"},children:[e.jsxs(m,{spacing:.75,children:[e.jsxs(m,{spacing:.25,sx:{minWidth:0},children:[e.jsx(g,{variant:"caption",color:"text.secondary",children:"선택됨"}),e.jsx(g,{variant:"body2",sx:{fontFamily:"monospace",borderRadius:1,border:"1px solid",borderColor:"divider",px:1,py:.5,bgcolor:"background.default",whiteSpace:"pre-wrap",wordBreak:"break-all",overflowWrap:"anywhere"},children:j})]}),e.jsxs(pe,{value:r,onChange:(H,E)=>c(E),textColor:"primary",indicatorColor:"primary",variant:"scrollable",allowScrollButtonsMobile:!0,sx:{minHeight:36,"& .MuiTab-root":{minWidth:0,whiteSpace:"nowrap"}},children:[e.jsx(Q,{label:"결과",value:"result"}),e.jsx(Q,{label:"코드",value:"code"})]})]}),e.jsx(he,{}),r==="result"&&e.jsx(J,{sx:{flex:1,overflow:"auto",minWidth:0,maxWidth:"100%"},children:l?e.jsxs(m,{spacing:1,sx:{minWidth:0,maxWidth:"100%"},children:[e.jsxs(m,{spacing:.25,children:[e.jsx(g,{variant:"subtitle1",fontWeight:600,children:"추출 요약"}),e.jsx(g,{variant:"body2",color:"text.secondary",children:"선택된 경로의 텍스트와 HTML을 그대로 출력합니다."})]}),e.jsxs(m,{spacing:.25,children:[e.jsx(g,{variant:"caption",color:"text.secondary",children:"텍스트"}),e.jsx(K,{variant:"outlined",sx:{p:1,bgcolor:"background.default",minHeight:96,minWidth:0},children:e.jsx(g,{variant:"body2",sx:{whiteSpace:"pre-wrap",wordBreak:"break-all",overflowWrap:"anywhere"},children:l.text||"텍스트가 없는 노드입니다."})})]}),e.jsxs(m,{spacing:.25,children:[e.jsx(g,{variant:"caption",color:"text.secondary",children:"HTML"}),e.jsx(K,{variant:"outlined",sx:{p:1,bgcolor:"background.default",minHeight:120,minWidth:0},children:e.jsx(g,{variant:"body2",sx:{fontFamily:"monospace",whiteSpace:"pre-wrap",wordBreak:"break-all",overflowWrap:"anywhere"},children:l.html||"HTML이 없는 노드입니다."})})]})]}):e.jsx(m,{spacing:.75,alignItems:"flex-start",children:e.jsx(g,{variant:"body2",color:"text.secondary",children:"DOM 노드를 선택하고 “코드 생성”을 눌러 결과를 확인하세요."})})}),r==="code"&&e.jsx(m,{spacing:1,sx:{flex:1,minWidth:0,maxWidth:"100%"},children:l?e.jsxs(e.Fragment,{children:[e.jsxs(pe,{value:n,onChange:(H,E)=>d(E),indicatorColor:"primary",textColor:"primary",children:[e.jsx(Q,{value:"node",label:"Node.js"}),e.jsx(Q,{value:"python",label:"Python"})]}),e.jsx(K,{variant:"outlined",sx:{flex:1,p:0,bgcolor:"background.default",overflow:"hidden",minWidth:0},children:e.jsx(J,{sx:{height:"100%",minHeight:200},children:e.jsx(ye,{height:"100%",defaultLanguage:n==="node"?"javascript":"python",language:n==="node"?"javascript":"python",value:n==="node"?T:C,options:{readOnly:!0,minimap:{enabled:!1},wordWrap:"on",scrollBeyondLastLine:!1,fontSize:12,lineNumbers:"on",renderLineHighlight:"all",scrollbar:{vertical:"visible",horizontal:"auto"}},theme:x})})}),e.jsxs(m,{direction:"row",spacing:.5,alignItems:"center",children:[e.jsx(me,{variant:"outlined",startIcon:e.jsx(Je,{}),onClick:()=>a(n==="node"?T:C),children:"코드 복사"}),e.jsx(g,{variant:"caption",color:"text.secondary",children:R==="copied"?"클립보드에 복사했습니다.":"URL과 selectors를 직접 수정해 주세요."})]})]}):e.jsx(m,{spacing:.75,alignItems:"flex-start",children:e.jsx(g,{variant:"body2",color:"text.secondary",children:"생성된 코드가 없습니다. 먼저 “결과” 탭에서 확인 가능한 DOM 추출을 실행해 주세요."})})})]}),Se=`
<main class="landing">
  <section class="hero">
    <h1>크롤링 샘플 페이지</h1>
    <p>HTML Explorer는 DOM 구조를 살펴보고 크롤링 코드를 생성합니다.</p>
  </section>
  <section class="news">
    <article class="card">
      <h2>서비스 안내</h2>
      <p class="meta">2024-11-12</p>
      <p>새로운 자동화 도구를 소개합니다.</p>
    </article>
    <article class="card">
      <h2>릴리즈 노트</h2>
      <p class="meta">2024-11-05</p>
      <p>HTML 파서를 개선하고 새로운 API를 추가했습니다.</p>
    </article>
  </section>
  <footer>
    <small>ⓒ Example Inc.</small>
  </footer>
</main>
`.trim(),Ce=(r,c)=>{if(typeof window>"u")return r;if(/<\s*(html|head|body)\b/i.test(r)){const j=new DOMParser().parseFromString(r,"text/html");return j.querySelectorAll(c.join(",")).forEach(x=>x.remove()),j.documentElement.outerHTML}const d=document.createElement("template");return d.innerHTML=r,d.content.querySelectorAll(c.join(",")).forEach(l=>l.remove()),d.innerHTML},tt=r=>Ce(r,["script"]),nt=r=>Ce(r,["meta"]),we=r=>{const c=r.trim();if(!c)return"";const n=c.replace(/>\s+</g,"><").replace(/\r?\n/g,"").split(/(?=<)/g).map(x=>x.trim()).filter(Boolean);let d=0;const l="  ",j=[];return n.forEach(x=>{/^<\//.test(x)&&(d=Math.max(d-1,0)),j.push(`${l.repeat(d)}${x}`),/^<[^!?/][^>]*[^/]>$/.test(x)&&(d+=1)}),j.join(`
`)},st=r=>{if(r.id)return`#${r.id}`;const c=r.tagName.toLowerCase(),n=Array.from(r.classList).filter(Boolean),d=n.length?`.${n.slice(0,2).join(".")}`:"",l=r.parentElement;if(!l)return`${c}${d}`;const j=Array.from(l.children).filter(T=>T.tagName===r.tagName);if(j.length<=1)return`${c}${d}`;const x=j.indexOf(r);return`${c}${d}:nth-of-type(${x+1})`},rt=r=>{if(typeof window>"u")return[];const c=/<\s*(html|head|body)\b/i.test(r),n=document.createElement("template");n.innerHTML=r;const d=new DOMParser,l=c?d.parseFromString(r,"text/html"):null;let j=0;const x=(C,R)=>C.map(a=>{const H=`dom-node-${j++}`,E=st(a),D=R?`${R} > ${E}`:E,G=(a.textContent??"").replace(/\s+/g," ").trim().slice(0,80),O=Array.from(a.attributes),v=O.map(L=>L.name),M=O.map(L=>L.value),I=M.map(L=>L.replace(/^#/,"")),q=M.join(" "),z=O.map(L=>`${L.name}=${L.value}`).join(" "),B=Array.from(a.classList).filter(Boolean),U=x(Array.from(a.children),D);return{id:H,tag:a.tagName.toLowerCase(),label:`${a.tagName.toLowerCase()}${a.id?`#${a.id}`:""}${B.length?`.${B.join(".")}`:""}`,elementId:a.id??"",classNames:B,attributeNames:v,attributeValues:M,attributeValueText:q,attributeValueTokens:I,attributesText:z,path:D,previewText:G,outerHTML:(a.outerHTML??"").trim(),innerText:(a.textContent??"").trim(),children:U}}),T=c&&l?[l.documentElement]:Array.from(n.content.children);return x(T,"")},ot=r=>{const c=[],n=d=>{d.forEach(l=>{c.push(l),l.children.length&&n(l.children)})};return n(r),c},at=r=>{const c=[],n=d=>{d.forEach(l=>{c.push(l.id),l.children.length&&n(l.children)})};return n(r),c},ve=r=>r.replace(/\\/g,"\\\\").replace(/'/g,"\\'"),it=r=>`/**
 * 실행 방법
 * 1) npm init -y
 * 2) npm install axios
 * 3) npm install cheerio
 * 4) node test.js
 */
import axios from 'axios'
import * as cheerio from 'cheerio'

const TARGET_URL = 'https://example.com'
const SELECTOR_PATH = '${ve(r)}'

async function scrape() {
  const res = await axios.get(TARGET_URL, {
    timeout: 15000,
  })

  const html = res.data
  const $ = cheerio.load(html)

  const elements = $(SELECTOR_PATH)
  if (elements.length === 0) {
    console.error('선택자에 매칭되는 요소가 없습니다:', SELECTOR_PATH)
    return
  }

  const results = elements
    .map((_, el) => {
      const text = $(el).text().trim()
      const html = $.html(el) ?? ''
      return { text, html }
    })
    .get()

  console.log(results)
}

scrape().catch((error) => {
  console.error('크롤링 실패:', error?.message ?? error)
})
`,lt=r=>`"""
실행 방법
1) python -m venv .venv
2) source .venv/bin/activate (Windows: .venv\\Scripts\\activate)
3) pip install requests beautifulsoup4
4) python test.py
"""
import requests
from bs4 import BeautifulSoup

TARGET_URL = "https://example.com"
SELECTOR_PATH = "${ve(r)}"


def scrape():
  response = requests.get(TARGET_URL, timeout=15)
  response.raise_for_status()
  soup = BeautifulSoup(response.text, "html.parser")
  elements = soup.select(SELECTOR_PATH)
  if not elements:
    print(f"선택자에 매칭되는 요소가 없습니다: {SELECTOR_PATH}")
    return

  results = []
  for element in elements:
    text = element.get_text(strip=True)
    html = str(element)
    results.append({ "text": text, "html": html })

  for item in results:
    print(item)


if __name__ == "__main__":
  scrape()
`,ct=()=>{const[r,c]=s.useState(()=>we(Se)),[n,d]=s.useState(()=>we(Se)),[l,j]=s.useState([]),[x,T]=s.useState(null),[C,R]=s.useState(null),[a,H]=s.useState("result"),[E,D]=s.useState("node"),[G,O]=s.useState(""),[v,M]=s.useState("idle"),[I,q]=s.useState(!1),[z,B]=s.useState(!1),[U,L]=s.useState(""),[X,re]=s.useState(""),[Z,$]=s.useState(0),Y=s.useRef(null),ee=s.useRef(null),F=s.useRef([]),A=s.useMemo(()=>rt(n),[n]),y=s.useMemo(()=>ot(A),[A]),S=s.useMemo(()=>y.find(t=>t.id===x)??null,[y,x]),i=s.useMemo(()=>C?it(C.path):"",[C]),u=s.useMemo(()=>C?lt(C.path):"",[C]),h=U.trim().toLowerCase(),W=h.startsWith("#"),P=h.startsWith("."),N=h.startsWith("<"),_=h.length>0&&!W&&!P&&!N&&/^[a-z][a-z0-9-]*$/i.test(h),b=s.useMemo(()=>{if(!h)return[];if(N){const t=h.replace(/[<>]/g,"").trim();return t?y.filter(o=>o.tag.toLowerCase()===t).map(o=>o.id):[]}if(W){const t=h.slice(1);return y.filter(o=>o.elementId.toLowerCase()===t).map(o=>o.id)}if(P){const t=h.slice(1);return y.filter(o=>o.classNames.some(f=>f.toLowerCase()===t)).map(o=>o.id)}return _?y.filter(t=>t.tag.toLowerCase()===h).map(t=>t.id):y.filter(t=>[t.label,t.tag,t.elementId,t.classNames.join(" "),t.attributeNames.join(" "),t.attributeValues.join(" "),t.attributeValueText,t.attributeValueTokens.join(" "),t.attributesText,t.path,t.previewText,t.outerHTML].filter(Boolean).join(" ").toLowerCase().includes(h)).map(t=>t.id)},[h,y]),Te=s.useMemo(()=>new Set(b),[b]),oe=b.length?Math.min(Z,b.length-1):0,Me=b.length?b[oe]:null,Ie=b.length?`${oe+1}/${b.length}`:"0/0",ie=s.useMemo(()=>new Set(l),[l]),Le=s.useMemo(()=>{const t=new Set,o=new Set,f=new Set;return y.forEach(p=>{p.tag&&t.add(p.tag),p.elementId&&o.add(`#${p.elementId}`),p.classNames.length&&p.classNames.forEach(w=>f.add(`.${w}`))}),[...t,...o,...f].sort((p,w)=>p.localeCompare(w))},[y]),le=s.useMemo(()=>{const t=[],o=(f,p)=>{f.forEach(w=>{t.push({node:w,depth:p}),w.children.length&&ie.has(w.id)&&o(w.children,p+1)})};return o(A,0),t},[A,ie]),ue=s.useMemo(()=>{const t=new Map;return le.forEach(({node:o},f)=>{t.set(o.id,f)}),t},[le]);s.useEffect(()=>{j(at(A))},[A]),s.useEffect(()=>{T(t=>y.length?t&&y.some(o=>o.id===t)?t:y[0]?.id??null:null)},[y]),s.useEffect(()=>{if(v==="copied"){const t=setTimeout(()=>M("idle"),2e3);return()=>clearTimeout(t)}},[v]),s.useEffect(()=>{(b.length===0||Z>=b.length)&&$(0)},[b.length,Z]),s.useEffect(()=>{b.length&&T(b[oe])},[b,oe]),s.useEffect(()=>{$(0)},[U]),s.useEffect(()=>{if(!x)return;const t=ue.get(x);t!==void 0&&Y.current?.scrollToItem(t,"smart")},[x,ue]),s.useEffect(()=>{if(!S){const ne=ee.current;ne&&(F.current=ne.deltaDecorations(F.current,[]));return}const t=ee.current,o=t?.getModel();if(!t||!o)return;const f=o.getValue();if(!f)return;const p=f.replace(/\r\n/g,`
`),w=(S.outerHTML??"").replace(/\r\n/g,`
`).trim();let k=w?p.indexOf(w):-1,te=k!==-1?k+w.length:-1;if(k===-1){const ne=w&&w.includes(">")?w.slice(0,w.indexOf(">")+1):`<${S.tag}`;if(k=p.indexOf(ne),k===-1&&S.elementId){const de=`id="${S.elementId}"`,V=p.indexOf(de);if(V!==-1){k=p.lastIndexOf("<",V);const se=p.indexOf(">",V);k!==-1&&se!==-1&&(te=se+1)}}if(k===-1&&S.classNames.length){const de=`class="${S.classNames[0]}`,V=p.indexOf(de);if(V!==-1){k=p.lastIndexOf("<",V);const se=p.indexOf(">",V);k!==-1&&se!==-1&&(te=se+1)}}if(k===-1){F.current=t.deltaDecorations(F.current,[]);return}te===-1&&(te=k+ne.length)}const fe=o.getPositionAt(k),ge=o.getPositionAt(te),ce={startLineNumber:fe.lineNumber,startColumn:fe.column,endLineNumber:ge.lineNumber,endColumn:ge.column};F.current=t.deltaDecorations(F.current,[{range:ce,options:{inlineClassName:"html-explorer-selection"}}]),t.hasTextFocus()||(t.revealRangeInCenter(ce),t.setSelection(ce))},[S]);const xe=s.useCallback((t,o=I,f=z)=>{let p=t;return o&&(p=tt(p)),f&&(p=nt(p)),p},[I,z]),We=s.useCallback((t,o)=>{ee.current=t;const f=t.getModel();f&&o&&o.editor.setModelLanguage(f,"html")},[]),ke=s.useCallback(()=>{if(!S){O("DOM 트리에서 노드를 선택해 주세요.");return}R({path:S.path,html:S.outerHTML,text:S.innerText,label:S.label}),M("idle"),H("result"),O("")},[S]),He=s.useCallback(async t=>{if(t)try{await navigator.clipboard.writeText(t),M("copied")}catch{M("idle")}},[]),Ee=s.useCallback(t=>{b.length&&$(o=>{const f=b.length,w=(o+(t==="next"?1:-1)+f)%f;return T(b[w]),w})},[b]),Ne=s.useCallback(t=>{j(o=>{const f=new Set(o);return f.has(t)?f.delete(t):f.add(t),Array.from(f)})},[]),$e=s.useCallback(t=>{const o=(t??X).trim();if(!o){L(""),$(0);return}L(o),$(0)},[X]),Re=s.useCallback(t=>{D(t),M("idle")},[]);return{htmlText:n,stripScripts:I,stripMeta:z,flatNodes:y,visibleNodes:le,expandedSet:ie,selectedNodeId:x,searchDraft:X,matchSummary:Ie,hasMatches:b.length>0,matchSet:Te,activeMatchId:Me,statusMessage:G,selectedPath:S?S.path:"선택된 노드가 없습니다.",suggestionOptions:Le,listRef:Y,tab:a,codeTab:E,extraction:C,nodeScript:i,pythonScript:u,copyHint:v,hasSelectedNode:!!S,onHtmlChange:t=>{d(t),!I&&!z&&c(t)},onEditorMount:We,onStripScriptsChange:t=>{q(t),d(xe(r,t,z))},onStripMetaChange:t=>{B(t),d(xe(r,I,t))},onGenerate:ke,onSelectNode:T,onToggleNode:Ne,onSearchDraftChange:re,onTriggerSearch:$e,onMatchStep:Ee,onTabChange:H,onCodeTabChange:Re,onCopyCode:He}},xt=()=>{const c=Xe().palette.mode==="dark"?"vs-dark":"vs",n=ct();return e.jsx(K,{sx:{p:1.25,display:"flex",flexDirection:"column",gap:1.25,flex:1,minHeight:785,height:"100%",width:1,maxWidth:"100%",overflowX:"hidden"},children:e.jsxs(m,{direction:"row",spacing:1.25,alignItems:"stretch",sx:{flex:1,minHeight:0,minWidth:0},children:[e.jsx(Ye,{editorTheme:c,htmlText:n.htmlText,onHtmlChange:n.onHtmlChange,onEditorMount:n.onEditorMount,stripScripts:n.stripScripts,stripMeta:n.stripMeta,onStripScriptsChange:n.onStripScriptsChange,onStripMetaChange:n.onStripMetaChange,onGenerate:n.onGenerate,hasSelectedNode:n.hasSelectedNode,flatNodes:n.flatNodes,visibleNodes:n.visibleNodes,expandedSet:n.expandedSet,selectedNodeId:n.selectedNodeId,onSelectNode:n.onSelectNode,onToggleNode:n.onToggleNode,searchDraft:n.searchDraft,onSearchDraftChange:n.onSearchDraftChange,onTriggerSearch:n.onTriggerSearch,onMatchStep:n.onMatchStep,matchSummary:n.matchSummary,hasMatches:n.hasMatches,matchSet:n.matchSet,activeMatchId:n.activeMatchId,selectedPath:n.selectedPath,statusMessage:n.statusMessage,listRef:n.listRef,suggestionOptions:n.suggestionOptions}),e.jsx(et,{tab:n.tab,onTabChange:n.onTabChange,codeTab:n.codeTab,onCodeTabChange:n.onCodeTabChange,extraction:n.extraction,selectedPath:n.selectedPath,nodeScript:n.nodeScript,pythonScript:n.pythonScript,copyHint:n.copyHint,onCopyCode:n.onCopyCode,editorTheme:c})]})})};export{xt as default};

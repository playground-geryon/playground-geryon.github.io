import{r as o,j as e}from"./vendor-CRMzTT1s.js";import{M as K}from"./monaco-editor-q_TX_2JT.js";import{S as m,o as $,K as Z,I as P,ah as ee,T as D,ai as te,aj as ne,a as J,a8 as oe,ab as re,ak as se,al as ae,ae as ie,u as ce,q as le,P as de,B as g}from"./mui-CAFjvBaw.js";import"./excel-CUMakpxJ.js";import"./tree-sitter-aGyQ8e2w.js";const ue=n=>{if(!n.trim())return null;try{return JSON.parse(n)}catch(r){return r instanceof Error?r.message:String(r)}},O=n=>Array.isArray(n)?n.map(O):n&&typeof n=="object"?Object.keys(n).sort((r,i)=>r.localeCompare(i)).reduce((r,i)=>(r[i]=O(n[i]),r),{}):n,he=(n,r)=>JSON.stringify(n,null,r),me=()=>{const[n,r]=o.useState(""),[i,d]=o.useState(""),[f,c]=o.useState(null),[p,C]=o.useState(2),[b,u]=o.useState(!1),w=a=>r(a),y=a=>{const h=a.target.files?.[0];if(!h)return;const l=new FileReader;l.onload=()=>{const S=l.result;typeof S=="string"&&r(S)},l.readAsText(h)},k=o.useCallback(()=>{const a=ue(n);if(typeof a=="string"){c(a);return}if(a===null){d(""),c(null);return}const h=b?O(a):a;d(he(h,p)),c(null)},[n,p,b]);return{raw:n,formatted:i,error:f,indent:p,sortKeys:b,setIndent:C,setSortKeys:u,handleRawChange:w,handleUpload:y,handleFormat:k,handleDownload:()=>{const a=new Blob([i],{type:"application/json"}),h=URL.createObjectURL(a),l=document.createElement("a");l.href=h,l.download="formatted.json",l.click(),URL.revokeObjectURL(h)}}},fe=(n,r)=>{if(!n||!r.trim())return{decorations:[],ranges:[]};const i=n.findMatches(r,!1,!1,!1,null,!0,200),d=i.map(c=>({range:c.range,options:{inlineClassName:"formatter-search-hit"}})),f=i.map(c=>c.range);return{decorations:d,ranges:f}},pe=({searchTerm:n,matchCount:r,matchIndex:i,onSearchTermChange:d,onPrevMatch:f,onNextMatch:c})=>e.jsxs(m,{direction:{xs:"column",md:"row"},justifyContent:"space-between",alignItems:{md:"center"},spacing:1,children:[e.jsx($,{fullWidth:!0,size:"small",placeholder:"키/값 검색",value:n,onChange:p=>d(p.target.value),InputProps:{endAdornment:n?e.jsx(Z,{position:"end",children:e.jsx(P,{size:"small",onClick:()=>d(""),children:e.jsx(ee,{fontSize:"small"})})}):void 0},sx:{minWidth:220}}),e.jsx(m,{direction:"row",spacing:1,alignItems:"center",sx:{width:"auto"},children:e.jsxs(m,{direction:"row",spacing:.5,alignItems:"center",sx:{whiteSpace:"nowrap"},children:[e.jsx(D,{variant:"caption",color:"text.secondary",children:r?`${i+1}/${r}`:"0/0"}),e.jsx(P,{size:"small",onClick:f,disabled:!r,sx:{bgcolor:"action.hover"},children:e.jsx(te,{fontSize:"small"})}),e.jsx(P,{size:"small",onClick:c,disabled:!r,sx:{bgcolor:"action.hover"},children:e.jsx(ne,{fontSize:"small"})})]})})]}),xe=({indent:n,sortKeys:r,formatted:i,onUpload:d,onIndentChange:f,onSortKeysChange:c,onFormat:p,onDownload:C})=>{const b=o.useRef(null);return e.jsxs(m,{spacing:1,children:[e.jsx("input",{ref:b,type:"file",accept:"application/json",hidden:!0,onChange:d}),e.jsxs(m,{direction:"row",justifyContent:"space-between",alignItems:{md:"center"},spacing:1.25,flexWrap:"wrap",children:[e.jsx(J,{variant:"outlined",size:"small",color:"primary",startIcon:e.jsx(oe,{}),onClick:()=>b.current?.click(),children:"JSON 업로드"}),e.jsxs(m,{direction:"row",spacing:1,alignItems:{md:"center"},flexWrap:"wrap",children:[e.jsx(re,{control:e.jsx(se,{size:"small",checked:r,onChange:u=>c(u.target.checked)}),label:e.jsx(D,{variant:"body2",children:"키 정렬"})}),e.jsxs(m,{direction:"row",spacing:1,alignItems:"center",flexWrap:"wrap",children:[e.jsx(D,{variant:"body2",color:"text.secondary",children:"공백 크기"}),e.jsx($,{select:!0,size:"small",value:n,onChange:u=>f(Number(u.target.value)),SelectProps:{native:!0},sx:{width:80},children:[2,4,8].map(u=>e.jsx("option",{value:u,children:u},u))})]}),e.jsx(J,{variant:"contained",size:"small",startIcon:e.jsx(ae,{}),onClick:p,children:"포맷"}),e.jsx(J,{variant:"outlined",size:"small",color:"primary",startIcon:e.jsx(ie,{}),onClick:C,disabled:!i,children:"다운로드"})]})]})]})},X="calc(100dvh - 320px)",ge=({raw:n,formatted:r,indent:i,sortKeys:d,setIndent:f,setSortKeys:c,handleRawChange:p,handleUpload:C,handleFormat:b,handleDownload:u})=>{const w=ce(),y=le(w.breakpoints.up("md")),k=w.palette.mode==="dark"?"vs-dark":"vs-light",E=o.useRef(null),a=o.useRef(!1),h=o.useRef(null),l=o.useRef(null),S=o.useRef([]),U=o.useRef([]),[z,B]=o.useState(.5),[F,G]=o.useState(""),[L,T]=o.useState(-1),[I,_]=o.useState(0),q=z,Q=1-z,M=o.useCallback(()=>{h.current?.layout(),l.current?.layout()},[]);o.useEffect(()=>{M()},[z,M]);const H=o.useCallback(t=>Math.min(Math.max(t,.2),.8),[]),R=o.useCallback(t=>{if(!E.current)return;const s=E.current.getBoundingClientRect();s.width<=0||B(H((t-s.left)/s.width))},[H]),N=o.useCallback(()=>{a.current=!1,document.body.style.cursor="",document.body.style.userSelect=""},[]),W=o.useCallback(t=>{if(y)if(a.current=!0,document.body.style.cursor="col-resize",document.body.style.userSelect="none","touches"in t){const s=t.touches[0];s&&R(s.clientX)}else R(t.clientX)},[y,R]);o.useEffect(()=>{const t=v=>{a.current&&(v.preventDefault(),R(v.clientX))},s=v=>{if(!a.current)return;const x=v.touches[0];x&&(v.preventDefault(),R(x.clientX))},j=()=>N();return window.addEventListener("mousemove",t),window.addEventListener("mouseup",j),window.addEventListener("touchmove",s,{passive:!1}),window.addEventListener("touchend",j),window.addEventListener("touchcancel",j),()=>{window.removeEventListener("mousemove",t),window.removeEventListener("mouseup",j),window.removeEventListener("touchmove",s),window.removeEventListener("touchend",j),window.removeEventListener("touchcancel",j)}},[N,R]),o.useEffect(()=>{y||(a.current=!1,document.body.style.cursor="",document.body.style.userSelect="",B(.5))},[y]);const A=o.useCallback(t=>{const s=l.current;if(!s)return;const j=s.getModel(),{decorations:v,ranges:x}=fe(j,t);S.current=s.deltaDecorations(S.current,v),U.current=x,_(x.length),T(x.length?0:-1),x[0]&&(s.revealRangeInCenter(x[0]),s.setSelection(x[0]))},[]);o.useEffect(()=>{A(F)},[r,F,A]),o.useEffect(()=>{if(L<0)return;const t=l.current,s=U.current[L];t&&s&&(t.revealRangeInCenter(s),t.setSelection(s))},[L]);const V=()=>{I&&T(t=>t<=0?I-1:t-1)},Y=()=>{I&&T(t=>t>=I-1||t<0?0:t+1)};return e.jsxs(de,{sx:{p:1.25,display:"flex",flexDirection:"column",gap:1.25,flex:1,minHeight:785,height:"100%",width:1,maxWidth:"100%",overflowX:"hidden"},children:[e.jsx(xe,{indent:i,sortKeys:d,formatted:r,onUpload:C,onIndentChange:f,onSortKeysChange:c,onFormat:b,onDownload:u}),e.jsxs(g,{ref:E,sx:{display:"grid",flexDirection:"row",gridTemplateColumns:`minmax(0, ${q}fr) 6px minmax(0, ${Q}fr)`,gap:{xs:2,md:0},columnGap:{md:1},minHeight:0,flex:1,touchAction:"none"},children:[e.jsxs(m,{sx:{p:1.25,border:"1px solid",borderColor:"divider",borderRadius:1,bgcolor:"background.paper",display:"flex",flexDirection:"column",gap:1,minWidth:0,minHeight:0,overflow:"hidden"},children:[e.jsxs(m,{direction:"row",justifyContent:"space-between",alignItems:"center",spacing:1,children:[e.jsx(D,{variant:"subtitle2",color:"text.secondary",children:"원본 JSON"}),e.jsx(g,{sx:{width:220,height:40}})]}),e.jsx(g,{sx:{flex:1,height:X,minHeight:685,border:"1px solid",borderColor:"divider",borderRadius:1,overflow:"hidden"},children:e.jsx(K,{height:"100%",language:"json",theme:k,value:n,onMount:t=>{h.current=t,M()},onChange:t=>p(t??""),options:{automaticLayout:!0,minimap:{enabled:!0},fontSize:13,padding:{top:1.25,bottom:8},scrollBeyondLastLine:!1}})})]}),y&&e.jsx(g,{sx:{width:6,justifySelf:"stretch",cursor:"col-resize",bgcolor:"divider","&:hover":{bgcolor:"action.hover"},borderRadius:1,display:"flex",alignItems:"center",justifyContent:"center",userSelect:"none"},onMouseDown:W,onTouchStart:W,children:e.jsxs(g,{sx:{display:"flex",flexDirection:"column",gap:.25},children:[e.jsx(g,{sx:{width:2,height:2,bgcolor:"text.secondary",borderRadius:"50%"}}),e.jsx(g,{sx:{width:2,height:2,bgcolor:"text.secondary",borderRadius:"50%"}}),e.jsx(g,{sx:{width:2,height:2,bgcolor:"text.secondary",borderRadius:"50%"}})]})}),e.jsxs(m,{sx:{p:1.25,border:"1px solid",borderColor:"divider",borderRadius:1,bgcolor:"background.paper",display:"flex",flexDirection:"column",gap:1,minWidth:0,minHeight:0,overflow:"hidden","& .formatter-search-hit":{backgroundColor:w.palette.warning.light,color:w.palette.getContrastText(w.palette.warning.light)}},children:[e.jsx(pe,{searchTerm:F,matchCount:I,matchIndex:L,onSearchTermChange:G,onPrevMatch:V,onNextMatch:Y}),e.jsx(g,{sx:{flex:1,height:X,minHeight:685,border:"1px solid",borderColor:"divider",borderRadius:1,overflow:"hidden"},children:e.jsx(K,{height:"100%",language:"json",theme:k,value:r,onMount:t=>{l.current=t,M()},options:{readOnly:!0,automaticLayout:!0,minimap:{enabled:!0},fontSize:13,padding:{top:1.25,bottom:8},scrollBeyondLastLine:!1}})})]})]})]})},Re=()=>{const n=me();return e.jsx(ge,{...n})};export{Re as default};

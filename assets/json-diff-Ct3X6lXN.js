import{r,p as te,j as t,o as tt}from"./vendor-DyxFRNuv.js";import{u as rt,q as nt,P as ot,S as D,a as X,af as st,ac as ze,T as A,ag as at,l as we,m as Ce,n as Se,p as Re,ad as it,B as S,a8 as Be,Y as me,Q as lt,R as ct,U as $e,V as q,W as dt,X as ut}from"./mui-Dn-s4uu_.js";import{M as We}from"./monaco-editor-C1_Zlzod.js";import"./excel-CUMakpxJ.js";import"./tree-sitter-DJeWk4Ia.js";const ht=({controller:f})=>{const{leftJson:x,rightJson:c,leftError:d,rightError:w,diffNodes:g,handleLeftUpload:xe,handleRightUpload:T,handleLeftTextChange:be,handleRightTextChange:ce,formatBothJson:ye,handleCompare:de,isComparing:re,sortBeforeCompare:ue,setSortBeforeCompare:G}=f,ne=rt(),oe=nt(ne.breakpoints.down("md")),[J,Q]=r.useState(!0),[C,b]=r.useState({added:!0,removed:!0,changed:!0}),[z,K]=r.useState(null),[B,U]=r.useState(!1),[se,_]=r.useState(0),[Z,s]=r.useState(""),[o,l]=r.useState(!1),u=r.useId(),R=r.useId(),y=r.useRef(null),h=r.useRef(null),I=r.useRef(null),m=r.useRef(null),Y=r.useRef([]),ae=r.useRef([]),k=r.useRef({left:[],right:[]}),V=r.useRef(null),ie=r.useRef(new Map),je=r.useMemo(()=>ne.palette.mode==="dark"?"vs-dark":"vs-light",[ne.palette.mode]),Fe=r.useMemo(()=>B?te(x)??null:null,[x,B]),He=r.useMemo(()=>B?te(c)??null:null,[c,B]),$=r.useMemo(()=>g.reduce((e,n)=>(e[n.type]+=1,e.total+=1,e),{added:0,removed:0,changed:0,total:0}),[g]),he=r.useMemo(()=>g.filter(e=>C[e.type]),[g,C]),fe=50,Xe=r.useMemo(()=>{const e=se*fe;return he.slice(e,e+fe)},[he,se]),[Ne,ke]=r.useState(.5),qe=Ne,Ge=1-Ne,Me=r.useMemo(()=>{const e=new Map;return g.forEach(n=>{e.set(n.path,n)}),e},[g]);r.useEffect(()=>{$.total===0&&(U(!1),K(null))},[$.total]),r.useEffect(()=>{_(0)},[C,B,g]),r.useEffect(()=>{(d||w||Z)&&l(!0)},[d,w,Z]);const Le=r.useCallback(e=>{const n=Me.get(e);n&&(K(n),U(!1))},[Me]),Ue=e=>{if(!e)return[];const n=[],i=/([^.\[\]]+)|\[(\d+)\]/g;let a;for(;(a=i.exec(e))!==null;)a[1]!==void 0?n.push(a[1]):a[2]!==void 0&&n.push(Number(a[2]));return n[0]==="root"&&n.shift(),n},Ee=e=>{if(e===null)return"null";if(Array.isArray(e))return"array";switch(typeof e){case"object":return"object";case"string":return"string";case"number":return"number";case"boolean":return"boolean";default:return"string"}},ee=(e,n,i)=>{if(!e||!n)return null;const a=tt(n,Ue(i));if(!a)return null;const p=e.getPositionAt(a.offset),j=e.getPositionAt(a.offset+a.length);return{range:{startLineNumber:p.lineNumber,startColumn:p.column,endLineNumber:j.lineNumber,endColumn:j.column},nodeType:a.type}},Oe=r.useCallback(e=>{const n=y.current,i=h.current;if(!n||!i)return;const a=te(n.getValue())??null,p=te(i.getValue())??null,j=ee(n.getModel(),a,e),M=ee(i.getModel(),p,e);k.current.left=n.deltaDecorations(k.current.left,[]),k.current.right=i.deltaDecorations(k.current.right,[]);const E=[],N=[];j&&(n.revealRangeInCenter(j.range),n.setSelection(j.range),E.push({range:j.range,options:{className:"json-diff-focus",isWholeLine:!1}})),M&&(i.revealRangeInCenter(M.range),i.setSelection(M.range),N.push({range:M.range,options:{className:"json-diff-focus",isWholeLine:!1}})),k.current.left=n.deltaDecorations(k.current.left,E),k.current.right=i.deltaDecorations(k.current.right,N)},[]),P=r.useCallback(()=>{requestAnimationFrame(()=>{y.current?.layout(),h.current?.layout(),requestAnimationFrame(()=>{y.current?.layout(),h.current?.layout()})})},[]),ge=r.useCallback(e=>{const n=m.current;n&&e.onMouseDown(i=>{const a=i.target.position?.lineNumber??i.target.detail?.lineNumber??null;if(!a)return;const p=e.getModel();if(!p)return;const j=new n.Range(a,1,a,p.getLineMaxColumn(a)),E=(p.getDecorationsInRange(j)||[]).find(O=>(O.options?.className?.startsWith?.("json-diff-")||O.options?.glyphMarginClassName?.startsWith?.("json-diff-"))&&ie.current.has(O.id));if(!E)return;const N=ie.current.get(E.id);N&&(Oe(N.path),i?.target?.type===n.editor.MouseTargetType.GUTTER_GLYPH_MARGIN&&Le(N.path))})},[Oe,Le]),_e=r.useCallback((e,n)=>{y.current=e,m.current=n,ge(e),requestAnimationFrame(()=>{e.layout(),requestAnimationFrame(()=>e.layout())})},[ge]),Ye=r.useCallback((e,n)=>{h.current=e,m.current=n,ge(e),requestAnimationFrame(()=>{e.layout(),requestAnimationFrame(()=>e.layout())})},[ge]);r.useEffect(()=>{P()},[oe,je,P]);const De=r.useCallback(e=>{if(oe)return;e.preventDefault(),e.stopPropagation();const n=I.current;if(!n)return;const i=n.getBoundingClientRect(),a=M=>{const N=(M.clientX-i.left)/i.width,O=Math.min(.8,Math.max(.2,N));ke(O),P()},p=M=>{M.preventDefault();const N=((M.touches[0]?.clientX??0)-i.left)/i.width,O=Math.min(.8,Math.max(.2,N));ke(O),P()},j=()=>{window.removeEventListener("mousemove",a),window.removeEventListener("touchmove",p),window.removeEventListener("mouseup",j),window.removeEventListener("touchend",j),window.removeEventListener("touchcancel",j),P()};window.addEventListener("mousemove",a),window.addEventListener("touchmove",p,{passive:!1}),window.addEventListener("mouseup",j),window.addEventListener("touchend",j),window.addEventListener("touchcancel",j)},[oe,P]);r.useEffect(()=>{if(!I.current)return;const e=new ResizeObserver(()=>P());return e.observe(I.current),()=>e.disconnect()},[P]),r.useEffect(()=>{if(!J)return;const e=y.current,n=h.current;if(!e||!n)return;const i=e.onDidScrollChange(p=>{if(J){if(V.current==="left"){V.current=null;return}V.current="right",n.setScrollTop(p.scrollTop??0),n.setScrollLeft(p.scrollLeft??0)}}),a=n.onDidScrollChange(p=>{if(J){if(V.current==="right"){V.current=null;return}V.current="left",e.setScrollTop(p.scrollTop??0),e.setScrollLeft(p.scrollLeft??0)}});return()=>{i.dispose(),a.dispose()}},[J]);const Te=r.useCallback(()=>{const e=m.current,n=y.current,i=h.current;if(!e||!n||!i)return;const a=n.getModel(),p=i.getModel(),j=a?te(a.getValue())??null:null,M=p?te(p.getValue())??null:null,E=[],N=[],O=[],ve=[],pe=(W,v,L)=>({isWholeLine:!1,className:W,glyphMarginClassName:`${W}-glyph`,glyphMarginHoverMessage:{value:`${v} ${L}`},hoverMessage:{value:`${v} ${L}`}});g.forEach(W=>{const{path:v,type:L,leftValue:Ve,rightValue:et}=W;if(!C[L])return;const F=ee(a,j,v),H=ee(p,M,v),Ie=F?F.nodeType===Ee(Ve):!1,Ae=H?H.nodeType===Ee(et):!1;L==="added"?H&&Ae&&(N.push({range:H.range,options:pe("json-diff-added","ðŸŸ¢ ì¶”ê°€",v)}),ve.push({side:"right",path:v,range:H.range})):L==="removed"?F&&Ie&&(E.push({range:F.range,options:pe("json-diff-removed","ðŸ”´ ì‚­ì œ",v)}),O.push({side:"left",path:v,range:F.range})):(F&&Ie&&(E.push({range:F.range,options:pe("json-diff-changed","ðŸŸ  ìˆ˜ì •",v)}),O.push({side:"left",path:v,range:F.range})),H&&Ae&&(N.push({range:H.range,options:pe("json-diff-changed","ðŸŸ  ìˆ˜ì •",v)}),ve.push({side:"right",path:v,range:H.range})))}),Y.current=n.deltaDecorations(Y.current,E),ae.current=i.deltaDecorations(ae.current,N),ie.current.clear(),Y.current.forEach((W,v)=>{const L=O[v];L&&ie.current.set(W,L)}),ae.current.forEach((W,v)=>{const L=ve[v];L&&ie.current.set(W,L)})},[g,C]);r.useEffect(()=>{Te(),P()},[Te,x,c,P]);const Qe=t.jsx("style",{children:`
        .monaco-editor .json-diff-added { background-color: rgba(16,185,129,0.25); border-bottom: 2px solid rgba(16,185,129,0.9); }
        .monaco-editor .json-diff-removed { background-color: rgba(239,68,68,0.25); border-bottom: 2px solid rgba(239,68,68,0.9); }
        .monaco-editor .json-diff-changed { background-color: rgba(245,158,11,0.25); border-bottom: 2px solid rgba(245,158,11,0.9); }
        .monaco-editor .json-diff-added-glyph,
        .monaco-editor .json-diff-removed-glyph,
        .monaco-editor .json-diff-changed-glyph { margin-left:6px; margin-top:2px; width:8px; height:8px; border-radius:50%;}
        .monaco-editor .json-diff-added-glyph    { background: rgba(16,185,129,0.9); }
        .monaco-editor .json-diff-removed-glyph  { background: rgba(239,68,68,0.9); }
        .monaco-editor .json-diff-changed-glyph  { background: rgba(245,158,11,0.9); }
        .monaco-editor .json-diff-focus { outline:2px solid rgba(59,130,246,0.9); background-color: rgba(59,130,246,0.12); }
        .monaco-editor, .monaco-editor .overflow-guard { overscroll-behavior: contain; }
        .monaco-editor .margin {
  cursor: pointer;
}
      `}),Ke=r.useMemo(()=>{const e=(x?.trim().length??0)>0&&!d,n=(c?.trim().length??0)>0&&!w;return e&&n},[x,c,d,w]),Ze=()=>{if(!Ke){const e=[];x?.trim()||e.push("ì™¼ìª½ JSONì´ ë¹„ì–´ ìžˆìŠµë‹ˆë‹¤."),c?.trim()||e.push("ì˜¤ë¥¸ìª½ JSONì´ ë¹„ì–´ ìžˆìŠµë‹ˆë‹¤."),d&&e.push(`ì™¼ìª½ íŒŒì‹± ì˜¤ë¥˜: ${d}`),w&&e.push(`ì˜¤ë¥¸ìª½ íŒŒì‹± ì˜¤ë¥˜: ${w}`),s(e.join(" "));return}s(""),de()},Pe="calc(100vh - 360px)",Je={px:1.25};return t.jsxs(ot,{sx:{p:1.25,display:"flex",flexDirection:"column",gap:1.25,flex:1,minHeight:785,height:"100%",width:1,maxWidth:"100%",overflowX:"hidden"},children:[Qe,t.jsxs(D,{direction:"row",spacing:1,alignItems:"center",justifyContent:"space-between",children:[t.jsx(D,{direction:"row",spacing:1,alignItems:"center",children:t.jsx(X,{variant:"outlined",size:"small",onClick:ye,disabled:!x.trim()&&!c.trim(),children:"JSON í¬ë§·"})}),t.jsxs(D,{direction:"row",spacing:1.25,alignItems:"center",justifyContent:"flex-end",children:[t.jsxs(D,{direction:"row",spacing:1,alignItems:"center",children:[t.jsx(st,{fontSize:"small",color:J?"primary":"disabled"}),t.jsx(ze,{size:"small",checked:J,onChange:e=>Q(e.target.checked)}),t.jsx(A,{variant:"caption",children:"ìŠ¤í¬ë¡¤ ë™ê¸°í™”"})]}),t.jsxs(D,{direction:"row",spacing:1,alignItems:"center",children:[t.jsx(A,{variant:"caption",children:"í‚¤ ì •ë ¬"}),t.jsx(ze,{size:"small",checked:ue,onChange:e=>G(e.target.checked)})]}),t.jsx(X,{variant:"outlined",size:"small",color:"primary",onClick:()=>U(!0),disabled:$.total===0||re,children:"ìš”ì•½ ë³´ê¸°"}),t.jsx(X,{variant:"contained",size:"small",color:"primary",startIcon:t.jsx(at,{}),onClick:Ze,disabled:re,children:"ë¹„êµ"})]})]}),t.jsxs(we,{open:o,onClose:()=>l(!1),maxWidth:"sm",children:[t.jsx(Ce,{sx:{pr:5},children:"ì˜¤ë¥˜ ì•ˆë‚´"}),t.jsx(Se,{dividers:!0,children:t.jsxs(A,{variant:"body2",children:[Z,Z&&(d||w)?" / ":"",d?`ì™¼ìª½: ${d}`:"",d&&w?" / ":"",w?`ì˜¤ë¥¸ìª½: ${w}`:""]})}),t.jsx(Re,{children:t.jsx(X,{size:"small",onClick:()=>l(!1),children:"ë‹«ê¸°"})})]}),re&&t.jsx(it,{}),t.jsxs(S,{ref:I,sx:{flex:1,minHeight:0,width:1,display:"grid",flexDirection:"row",gridTemplateColumns:`minmax(0, ${qe}fr) 6px minmax(0, ${Ge}fr)`,columnGap:1,gap:1,alignItems:"stretch",touchAction:"none",overflow:"hidden",overscrollBehavior:"contain",contain:"layout size paint"},children:[t.jsxs(D,{sx:{p:1.25,border:"1px solid",borderColor:"divider",borderRadius:1,bgcolor:"background.paper",display:"flex",flexDirection:"column",gap:1,minWidth:0,minHeight:0,overflow:"hidden"},children:[t.jsxs(D,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[t.jsx(A,{variant:"subtitle2",children:"JSON (ì›ë³¸)"}),t.jsxs(S,{children:[t.jsx("input",{id:u,type:"file",accept:".json,application/json",hidden:!0,onChange:e=>xe(e.target.files?.[0]??null)}),t.jsx("label",{htmlFor:u,children:t.jsx(X,{component:"span",variant:"contained",size:"small",startIcon:t.jsx(Be,{}),children:"JSON ì—…ë¡œë“œ"})})]})]}),t.jsx(S,{sx:{flex:1,height:Pe,minHeight:200,border:"1px solid",borderColor:"divider",borderRadius:1,overflow:"hidden",overscrollBehavior:"contain",position:"relative"},children:t.jsx(We,{height:"100%",language:"json",theme:je,value:x,onChange:e=>be(e??""),onMount:_e,options:{automaticLayout:!0,minimap:{enabled:!0},scrollBeyondLastLine:!1,lineNumbers:"on",glyphMargin:!0}})})]}),t.jsx(S,{sx:{width:6,justifySelf:"stretch",cursor:"col-resize",bgcolor:"divider","&:hover":{bgcolor:"action.hover"},borderRadius:1,display:"flex",alignItems:"center",justifyContent:"center",userSelect:"none"},onMouseDown:De,onTouchStart:De,children:t.jsxs(S,{sx:{display:"flex",flexDirection:"column",gap:.25},children:[t.jsx(S,{sx:{width:2,height:2,bgcolor:"text.secondary",borderRadius:"50%"}}),t.jsx(S,{sx:{width:2,height:2,bgcolor:"text.secondary",borderRadius:"50%"}}),t.jsx(S,{sx:{width:2,height:2,bgcolor:"text.secondary",borderRadius:"50%"}})]})}),t.jsxs(D,{sx:{p:1.25,border:"1px solid",borderColor:"divider",borderRadius:1,bgcolor:"background.paper",display:"flex",flexDirection:"column",gap:1,minWidth:0,minHeight:0,overflow:"hidden"},children:[t.jsxs(D,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[t.jsx(A,{variant:"subtitle2",children:"JSON (ë¹„êµ)"}),t.jsxs(S,{children:[t.jsx("input",{id:R,type:"file",accept:".json,application/json",hidden:!0,onChange:e=>T(e.target.files?.[0]??null)}),t.jsx("label",{htmlFor:R,children:t.jsx(X,{component:"span",variant:"contained",size:"small",startIcon:t.jsx(Be,{}),children:"JSON ì—…ë¡œë“œ"})})]})]}),t.jsx(S,{sx:{flex:1,height:Pe,minHeight:200,border:"1px solid",borderColor:"divider",borderRadius:1,overflow:"hidden",overscrollBehavior:"contain",position:"relative"},children:t.jsx(We,{height:"100%",language:"json",theme:je,value:c,onChange:e=>ce(e??""),onMount:Ye,options:{automaticLayout:!0,minimap:{enabled:!0},scrollBeyondLastLine:!1,lineNumbers:"on",glyphMargin:!0}})})]})]}),t.jsxs(we,{open:B,onClose:()=>U(!1),maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{maxWidth:680}},children:[t.jsx(Ce,{sx:{fontSize:14,fontWeight:600},children:"ìš”ì•½ ë³´ê¸°"}),t.jsx(Se,{dividers:!0,sx:{display:"flex",flexDirection:"column",gap:1.25},children:$.total===0?t.jsx(A,{variant:"body2",color:"text.secondary",children:"ë¹„êµëœ ë³€ê²½ ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤. JSONì„ ìž…ë ¥í•˜ê³  â€œë¹„êµâ€ë¥¼ ëˆŒëŸ¬ ì£¼ì„¸ìš”."}):t.jsxs(t.Fragment,{children:[t.jsxs(D,{direction:"row",spacing:1,alignItems:"center",justifyContent:"space-between",children:[t.jsxs(D,{direction:"row",spacing:1,alignItems:"center",children:[t.jsx(me,{label:`ì¶”ê°€ ${$.added}`,size:"small",color:"success",variant:C.added?"filled":"outlined",onClick:()=>b(e=>({...e,added:!e.added}))}),t.jsx(me,{label:`ì‚­ì œ ${$.removed}`,size:"small",color:"error",variant:C.removed?"filled":"outlined",onClick:()=>b(e=>({...e,removed:!e.removed}))}),t.jsx(me,{label:`ìˆ˜ì • ${$.changed}`,size:"small",color:"warning",variant:C.changed?"filled":"outlined",onClick:()=>b(e=>({...e,changed:!e.changed}))})]}),t.jsx(me,{label:`ë³€ê²½ëœ í‚¤ ${$.total}ê°œ`,size:"small",variant:"outlined"})]}),t.jsx(S,{sx:{maxHeight:360,overflowY:"auto"},children:he.length===0?t.jsx(A,{variant:"body2",color:"text.secondary",children:"ì„ íƒí•œ ìœ í˜•ì˜ ë³€ê²½ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤."}):t.jsxs(lt,{size:"small",sx:{tableLayout:"fixed","& th, & td":{fontSize:12}},children:[t.jsx(ct,{children:t.jsxs($e,{children:[t.jsx(q,{sx:{bgcolor:"action.hover",fontWeight:700,width:64},children:"êµ¬ë¶„"}),t.jsx(q,{sx:{bgcolor:"action.hover",fontWeight:700,width:72},children:"LINE"}),t.jsx(q,{sx:{bgcolor:"action.hover",fontWeight:700},children:"ì›ë³¸"}),t.jsx(q,{sx:{bgcolor:"action.hover",fontWeight:700},children:"ë¹„êµ"})]})}),t.jsx(dt,{children:Xe.map(e=>{const n=e.type!=="added"?ee(y.current?.getModel()??null,Fe,e.path)?.range?.startLineNumber:null,i=e.type!=="removed"?ee(h.current?.getModel()??null,He,e.path)?.range?.startLineNumber:null,a=n??i??"-";return t.jsxs($e,{children:[t.jsx(q,{sx:{width:64},children:e.type==="added"?"ì¶”ê°€":e.type==="removed"?"ì‚­ì œ":"ìˆ˜ì •"}),t.jsx(q,{sx:{width:72},children:a}),t.jsx(q,{sx:{maxWidth:200,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e.type!=="added"?JSON.stringify(e.leftValue):"-"}),t.jsx(q,{sx:{maxWidth:200,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e.type!=="removed"?JSON.stringify(e.rightValue):"-"})]},e.path)})})]})}),t.jsx(ut,{component:"div",rowsPerPageOptions:[fe],count:he.length,rowsPerPage:fe,page:se,onPageChange:(e,n)=>_(n),onRowsPerPageChange:()=>{}})]})}),t.jsx(Re,{children:t.jsx(X,{size:"small",sx:Je,onClick:()=>U(!1),children:"ë‹«ê¸°"})})]}),t.jsxs(we,{open:!!z,onClose:()=>K(null),maxWidth:"md",fullWidth:!0,children:[t.jsxs(Ce,{children:["Diff ìƒì„¸ â€“ ",z?.path]}),t.jsxs(Se,{dividers:!0,sx:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(240px, 1fr))",gap:1.25},children:[t.jsxs(S,{children:[t.jsx(A,{variant:"subtitle2",gutterBottom:!0,children:"ì™¼ìª½ (ì›ë³¸)"}),t.jsx(S,{component:"pre",sx:{m:0,p:1,borderRadius:1,bgcolor:"background.default",border:"1px solid",borderColor:"divider",fontSize:13,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:z?.type!=="added"?JSON.stringify(z?.leftValue,null,2):"(í•´ë‹¹ ì—†ìŒ)"})]}),t.jsxs(S,{children:[t.jsx(A,{variant:"subtitle2",gutterBottom:!0,children:"ì˜¤ë¥¸ìª½ (ë¹„êµ)"}),t.jsx(S,{component:"pre",sx:{m:0,p:1,borderRadius:1,bgcolor:"background.default",border:"1px solid",borderColor:"divider",fontSize:13,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:z?.type!=="removed"?JSON.stringify(z?.rightValue,null,2):"(í•´ë‹¹ ì—†ìŒ)"})]})]}),t.jsx(Re,{children:t.jsx(X,{size:"small",sx:Je,onClick:()=>K(null),children:"ë‹«ê¸°"})})]})]})},le=f=>Array.isArray(f)?f.map(le):f&&typeof f=="object"?Object.entries(f).sort(([c],[d])=>c.localeCompare(d)).reduce((c,[d,w])=>(c[d]=le(w),c),{}):f,ft=(f,x)=>{const c=JSON.parse(f),d=x?le(c):c;return JSON.stringify(d,null,2)},gt=()=>r.useCallback(async f=>f?new Promise((x,c)=>{const d=new FileReader;d.onerror=()=>c(new Error("íŒŒì¼ì„ ì½ëŠ” ì¤‘ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")),d.onload=w=>{const g=w.target?.result;typeof g=="string"?x(g):c(new Error("íŒŒì¼ ë‚´ìš©ì´ ë¹„ì–´ ìžˆìŠµë‹ˆë‹¤."))},d.readAsText(f)}):"",[]),pt=()=>{const[f,x]=r.useState("{}"),[c,d]=r.useState("{}"),[w,g]=r.useState(null),[xe,T]=r.useState(null),[be,ce]=r.useState([]),[ye,de]=r.useState(null),[re,ue]=r.useState(null),[G,ne]=r.useState(!1),[oe,J]=r.useState(!1),Q=gt(),C=r.useCallback((s,o,l,u=!1)=>{try{const R=ft(s,u);return o(R),l(null),R}catch(R){const y=R instanceof Error?R.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜";return l(`ìœ íš¨í•œ JSONì´ ì•„ë‹™ë‹ˆë‹¤. (${y})`),null}},[]),b=r.useCallback(()=>{ce([]),de(null),ue(null)},[]),z=r.useCallback(async s=>{try{const o=await Q(s);if(o&&!C(o,x,g))return;b()}catch(o){g(o instanceof Error?o.message:"ì™¼ìª½ JSONì„ ì½ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")}T(null)},[C,Q,b]),K=r.useCallback(async s=>{try{const o=await Q(s);if(o&&!C(o,d,T))return;b()}catch(o){T(o instanceof Error?o.message:"ì˜¤ë¥¸ìª½ JSONì„ ì½ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")}g(null)},[C,Q,b]),B=r.useCallback(s=>{x(s),g(null),b()},[b]),U=r.useCallback(s=>{d(s),T(null),b()},[b]),se=r.useCallback(()=>{const s=C(f,x,g),o=C(c,d,T);(s||o)&&b()},[C,f,b,c]),_=r.useCallback((s,o,l="root")=>{const u=[],R=y=>JSON.stringify(y);if(Array.isArray(s)&&Array.isArray(o)){const y=Math.max(s.length,o.length);for(let h=0;h<y;h+=1){const I=l==="root"?`[${h}]`:`${l}[${h}]`;h>=s.length?u.push({path:I,type:"added",rightValue:o[h]}):h>=o.length?u.push({path:I,type:"removed",leftValue:s[h]}):u.push(..._(s[h],o[h],I))}return u}if(s&&typeof s=="object"&&o&&typeof o=="object"){const y=Object.entries(s),h=Object.entries(o);return Array.from(new Set([...y.map(([m])=>m),...h.map(([m])=>m)])).sort((m,Y)=>m.localeCompare(Y)).forEach(m=>{const Y=Object.prototype.hasOwnProperty.call(s,m),ae=Object.prototype.hasOwnProperty.call(o,m),k=l==="root"?m:`${l}.${m}`;ae?Y?u.push(..._(s[m],o[m],k)):u.push({path:k,type:"added",rightValue:o[m]}):u.push({path:k,type:"removed",leftValue:s[m]})}),u}return R(s)!==R(o)&&u.push({path:l,type:"changed",leftValue:s,rightValue:o}),u},[]),Z=r.useCallback(async()=>{let s,o;J(!0);try{try{s=JSON.parse(f),g(null)}catch(l){const u=l instanceof Error?l.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜";return g(`ìœ íš¨í•œ JSONì´ ì•„ë‹™ë‹ˆë‹¤. (${u})`),b(),!1}try{o=JSON.parse(c),T(null)}catch(l){const u=l instanceof Error?l.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜";return T(`ìœ íš¨í•œ JSONì´ ì•„ë‹™ë‹ˆë‹¤. (${u})`),b(),!1}try{await new Promise(h=>setTimeout(h,0));const l=G?le(s):s,u=G?le(o):o,R=JSON.stringify(l,null,2),y=JSON.stringify(u,null,2);ce(_(l,u)),de(R),ue(y),G&&(x(R),d(y))}catch(l){const u=l instanceof Error?l.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜";return g(u),T(u),b(),!1}return!0}finally{J(!1)}},[_,f,b,c,G]);return{leftJson:f,rightJson:c,leftError:w,rightError:xe,handleLeftUpload:z,handleRightUpload:K,handleLeftTextChange:B,handleRightTextChange:U,formatBothJson:se,handleCompare:Z,isComparing:oe,diffNodes:be,comparisonLeft:ye,comparisonRight:re,sortBeforeCompare:G,setSortBeforeCompare:ne}},vt=()=>{const f=pt();return t.jsx(ht,{controller:f})};export{vt as default};

import{r as o,j as e}from"./vendor-BHnfqNCc.js";import{P as $e,B as l,ak as B,T as c,a7 as w,a as I,al as Ne,am as Ue,an as P,a1 as L,ao as qe,a9 as f,ap as H,n,a3 as Q,a4 as O,af as Ge,J as A,S as V,I as X,aq as ie,ar as oe,aa as ce,as as Ke,at as de,Y as Ye,a6 as xe}from"./mui-DWpzSE2I.js";import{u as Je,Q as ue,a as Ze}from"./qr-maker-controller-DQe8VLRl.js";import"./excel-CUMakpxJ.js";import"./monaco-BZh3GCvz.js";const ea=[{label:"L (7%)",value:"L"},{label:"M (15%)",value:"M"},{label:"Q (25%)",value:"Q"},{label:"H (30%)",value:"H"}],aa=[{label:"WPA/WPA2/3",value:"WPA"},{label:"WEP",value:"WEP"},{label:"Open (nopass)",value:"nopass"}],ta=[{label:"cover",value:"cover"},{label:"contain",value:"contain"},{label:"stretch",value:"stretch"}],$=20,p={dark:"#000000",light:"#ffffff"},la=/^#([0-9a-fA-F]{6})$/,na=/^#([0-9a-fA-F]{3})$/,j=(x,g)=>{const u=x.trim();return la.test(u)?u.toLowerCase():na.test(u)?`#${u.slice(1).split("").map(b=>`${b}${b}`).join("").toLowerCase()}`:g},he=(x,g)=>j(x,g),pe={width:28,height:28,border:0,p:0,bgcolor:"transparent",cursor:"pointer","&::-webkit-color-swatch-wrapper":{p:0},"&::-webkit-color-swatch":{borderRadius:"50%",border:"1px solid rgba(0,0,0,0.2)"},"&::-moz-color-swatch":{borderRadius:"50%",border:"1px solid rgba(0,0,0,0.2)"}},r={size:"small",margin:"dense"},v={componentsProps:{typography:{variant:"body2"}}},da=()=>{const x=o.useRef(null),g=o.useRef(null),u=o.useRef(null),M=o.useRef(null),b=o.useRef(null),{mode:R,setMode:ge,textDraft:me,setTextDraft:fe,vcardDraft:t,setVcardDraft:i,wifiDraft:d,setWifiDraft:k,isVCardValid:ve,isWifiValid:N,colorDark:W,setColorDark:y,colorLight:S,setColorLight:C,ecLevel:je,setEcLevel:be,withIcon:ye,setWithIcon:Ce,iconImg:we,iconScale:U,setIconScale:Ie,iconMargin:q,setIconMargin:Re,roundIcon:ke,setRoundIcon:We,iconFit:Se,setIconFit:Ee,errorMsg:G,setErrorMsg:F,exportSize:ze,setExportSize:De,exportSizeSafe:Pe,generateQR:K,resetAll:Le,handleIconFile:Ae,clearIcon:Me,downloadResult:Fe,drawToCanvas:Y}=Je(),[J,_e]=o.useState(()=>Math.max(1,window.devicePixelRatio||1)),[E,Te]=o.useState(320);o.useEffect(()=>{let a=0,s=-1;const h=()=>{const m=x.current;if(!m)return;const se=m.getBoundingClientRect(),D=getComputedStyle(m),Qe=(parseFloat(D.paddingLeft)||0)+(parseFloat(D.paddingRight)||0),Oe=(parseFloat(D.paddingTop)||0)+(parseFloat(D.paddingBottom)||0),Ve=Math.max(0,se.width-Qe-$*2),Xe=Math.max(0,se.height-Oe-$*2),T=Math.floor(Math.max(120,Math.min(Ve,Xe)));Math.abs(T-s)>.5&&(s=T,Te(T))},z=new ResizeObserver(()=>{cancelAnimationFrame(a),a=requestAnimationFrame(h)});[x.current,g.current,M.current,b.current,x.current?.parentElement??null].forEach(m=>m&&z.observe(m));const le=()=>_e(Math.max(1,window.devicePixelRatio||1)),ne=window.matchMedia(`(resolution: ${window.devicePixelRatio||1}dppx)`);ne.addEventListener?.("change",le);const re=()=>{cancelAnimationFrame(a),a=requestAnimationFrame(h)};return h(),window.addEventListener("resize",re),()=>{z.disconnect(),ne.removeEventListener?.("change",le),window.removeEventListener("resize",re),cancelAnimationFrame(a)}},[]);const Z=o.useMemo(()=>Math.round(E*J),[E,J]);o.useEffect(()=>{(async()=>{const s=u.current;if(s)try{await Y(s,Z),F("")}catch(h){F(h instanceof Error?h.message:"QR을 생성할 수 없습니다.")}})()},[Y,Z,F]);const Be=o.useMemo(()=>he(W,p.dark),[W]),He=o.useMemo(()=>he(S,p.light),[S]),ee=typeof window<"u"&&!!window.EyeDropper,ae=a=>{Fe(a,u.current)},te=o.useCallback(async a=>{if(!(typeof window>"u"||!window.EyeDropper))try{const h=await new window.EyeDropper().open(),z=p[a],_=j(h?.sRGBHex??"",z);a==="dark"?y(_):C(_)}catch(s){if(s instanceof DOMException&&s.name==="AbortError")return}},[y,C]);return e.jsx($e,{sx:{p:1.25,display:"flex",flexDirection:"column",gap:1.25,flex:1,minHeight:785,height:"100%",width:1,maxWidth:"100%",overflowX:"hidden"},children:e.jsxs(l,{sx:{flex:1,minHeight:0,display:"grid",gridTemplateColumns:"380px 1fr 380px",gap:1.25,alignItems:"stretch"},children:[e.jsxs(B,{ref:M,variant:"outlined",sx:{minHeight:770,flexDirection:"column",overflow:"hidden",height:"calc(100vh - 190px)"},children:[e.jsx(l,{sx:{position:"sticky",top:0,zIndex:1,borderBottom:"1px solid",borderColor:"divider",bgcolor:"background.paper",px:1.25,py:1.25},children:e.jsxs(l,{display:"flex",alignItems:"center",justifyContent:"space-between",gap:1,children:[e.jsx(c,{variant:"body2",sx:{fontWeight:600,color:"text.secondary"},children:"입력"}),e.jsxs(l,{display:"flex",gap:1,children:[e.jsx(w,{title:"현재 입력 값으로 QR 생성",children:e.jsx(I,{variant:"contained",size:"small",startIcon:e.jsx(Ne,{}),onClick:K,children:"QR 생성"})}),e.jsx(w,{title:"모든 입력/옵션 초기화 및 QR 제거",children:e.jsx(I,{variant:"outlined",color:"primary",size:"small",startIcon:e.jsx(Ue,{}),onClick:Le,children:"초기화"})})]})]})}),e.jsxs(P,{sx:{flex:1,minHeight:0,overflow:"auto",pt:1.25,pb:2,pr:2},children:[e.jsx(L,{sx:{mt:0},children:e.jsxs(qe,{row:!0,value:R,onChange:(a,s)=>ge(s??"text"),children:[e.jsx(f,{value:"text",control:e.jsx(H,{size:"small"}),label:"텍스트 / URL",...v}),e.jsx(f,{value:"vcard",control:e.jsx(H,{size:"small"}),label:"연락처 (vCard)",...v}),e.jsx(f,{value:"wifi",control:e.jsx(H,{size:"small"}),label:"Wi-Fi",...v})]})}),R==="text"&&e.jsx(l,{mt:1,display:"flex",flexDirection:"column",gap:1,children:e.jsx(n,{...r,label:"텍스트 / URL",value:me,onChange:a=>fe(a.target.value),fullWidth:!0,multiline:!0,minRows:3,helperText:"⌘/Ctrl + Enter 로 빠르게 생성",onKeyDown:a=>{(a.metaKey||a.ctrlKey)&&a.key==="Enter"&&(a.preventDefault(),K())}})}),R==="vcard"&&e.jsxs(l,{mt:1,display:"flex",flexDirection:"column",gap:0,children:[e.jsxs(l,{display:"flex",gap:1,children:[e.jsx(n,{...r,label:"성",value:t.lastName,onChange:a=>i({...t,lastName:a.target.value}),fullWidth:!0}),e.jsx(n,{...r,label:"이름",value:t.firstName,onChange:a=>i({...t,firstName:a.target.value}),fullWidth:!0})]}),e.jsx(n,{...r,label:"회사/조직",value:t.org,onChange:a=>i({...t,org:a.target.value}),fullWidth:!0}),e.jsx(n,{...r,label:"직함",value:t.title,onChange:a=>i({...t,title:a.target.value}),fullWidth:!0}),e.jsxs(l,{display:"flex",gap:1,children:[e.jsx(n,{...r,label:"휴대전화",value:t.mobile,onChange:a=>i({...t,mobile:a.target.value}),fullWidth:!0}),e.jsx(n,{...r,label:"전화",value:t.phone,onChange:a=>i({...t,phone:a.target.value}),fullWidth:!0})]}),e.jsxs(l,{display:"flex",gap:1,children:[e.jsx(n,{...r,label:"이메일",value:t.email,onChange:a=>i({...t,email:a.target.value}),fullWidth:!0}),e.jsx(n,{...r,label:"웹사이트",value:t.url,onChange:a=>i({...t,url:a.target.value}),fullWidth:!0})]}),e.jsx(n,{...r,label:"주소",value:t.street,onChange:a=>i({...t,street:a.target.value}),fullWidth:!0}),e.jsxs(l,{display:"flex",gap:1,children:[e.jsx(n,{...r,label:"도시",value:t.city,onChange:a=>i({...t,city:a.target.value}),fullWidth:!0}),e.jsx(n,{...r,label:"지역/주",value:t.region,onChange:a=>i({...t,region:a.target.value}),fullWidth:!0})]}),e.jsxs(l,{display:"flex",gap:1,children:[e.jsx(n,{...r,label:"우편번호",value:t.postal,onChange:a=>i({...t,postal:a.target.value}),fullWidth:!0}),e.jsx(n,{...r,label:"국가",value:t.country,onChange:a=>i({...t,country:a.target.value}),fullWidth:!0})]}),e.jsx(n,{...r,label:"메모",value:t.note,onChange:a=>i({...t,note:a.target.value}),fullWidth:!0,multiline:!0,minRows:2}),!ve&&e.jsx(c,{variant:"caption",color:"error",children:"이름/회사 1개 이상과 전화·휴대전화·이메일 중 1개 이상을 입력하세요."})]}),R==="wifi"&&e.jsxs(l,{mt:1,display:"flex",flexDirection:"column",gap:0,children:[e.jsx(n,{...r,label:"SSID",value:d.ssid,onChange:a=>k({...d,ssid:a.target.value}),fullWidth:!0}),e.jsxs(l,{display:"flex",gap:1,alignItems:"center",children:[e.jsx(L,{fullWidth:!0,margin:"dense",size:"small",children:e.jsx(Q,{value:d.security,onChange:a=>k({...d,security:a.target.value}),size:"small",children:aa.map(a=>e.jsx(O,{value:a.value,children:a.label},a.value))})}),e.jsx(n,{...r,label:"비밀번호",type:"password",value:d.password,onChange:a=>k({...d,password:a.target.value}),fullWidth:!0,disabled:d.security==="nopass"})]}),e.jsx(f,{...v,control:e.jsx(Ge,{size:"small",checked:d.hidden,onChange:a=>k({...d,hidden:a.target.checked})}),label:"SSID 숨김"}),e.jsx(c,{variant:"caption",color:N?"success.main":"error",children:N?"Wi-Fi QR 생성 가능":"SSID와 비밀번호를 확인하세요."})]}),G&&e.jsx(c,{variant:"body2",color:"error",mt:1,children:G})]})]}),e.jsx(B,{variant:"outlined",sx:{minWidth:0,minHeight:0,display:"flex",maxHeight:"100%",height:"auto"},children:e.jsx(P,{ref:x,sx:{flex:1,minHeight:0,p:`${$}px`,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(l,{ref:g,sx:{width:`${E}px`,height:`${E}px`,maxWidth:"100%",maxHeight:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("canvas",{ref:u,style:{width:"100%",height:"100%",imageRendering:"crisp-edges",display:"block",borderRadius:8,background:"#fff",boxShadow:"0 8px 24px rgba(0,0,0,0.06)"}})})})}),e.jsxs(B,{ref:b,variant:"outlined",sx:{height:"calc(100vh - 190px)",minHeight:770,flexDirection:"column",overflow:"hidden"},children:[e.jsxs(P,{sx:{flex:1,minHeight:0,overflow:"auto",pt:1.25,pb:2,px:1.25,display:"flex",flexDirection:"column",gap:1.25},children:[e.jsx(c,{variant:"body2",fontWeight:600,color:"text.secondary",children:"옵션"}),e.jsxs(l,{display:"flex",gap:1,children:[e.jsx(n,{...r,label:"QR",value:W,onChange:a=>y(a.target.value),onBlur:()=>y(j(W,p.dark)),InputProps:{startAdornment:e.jsx(A,{position:"start",children:e.jsx(oe,{fontSize:"small"})}),endAdornment:e.jsx(A,{position:"end",sx:{pl:1},children:e.jsxs(V,{direction:"row",spacing:.5,alignItems:"center",children:[ee&&e.jsx(w,{title:"스포이드로 화면에서 색상 선택",children:e.jsx(X,{size:"small",onClick:()=>te("dark"),"aria-label":"QR 색상 스포이드",children:e.jsx(ie,{fontSize:"small"})})}),e.jsx(l,{component:"input",type:"color",value:Be,onChange:a=>y(j(a.target.value,p.dark)),"aria-label":"QR color picker",title:"QR 색상 선택",sx:pe})]})})},fullWidth:!0}),e.jsx(n,{...r,label:"Background",value:S,onChange:a=>C(a.target.value),onBlur:()=>C(j(S,p.light)),InputProps:{startAdornment:e.jsx(A,{position:"start",children:e.jsx(oe,{fontSize:"small"})}),endAdornment:e.jsx(A,{position:"end",sx:{pl:1},children:e.jsxs(V,{direction:"row",spacing:.5,alignItems:"center",children:[ee&&e.jsx(w,{title:"스포이드로 화면에서 색상 선택",children:e.jsx(X,{size:"small",onClick:()=>te("light"),"aria-label":"Background 색상 스포이드",children:e.jsx(ie,{fontSize:"small"})})}),e.jsx(l,{component:"input",type:"color",value:He,onChange:a=>C(j(a.target.value,p.light)),"aria-label":"Background color picker",title:"Background 색상 선택",sx:pe})]})})},fullWidth:!0})]}),e.jsxs(L,{fullWidth:!0,children:[e.jsx(c,{variant:"body2",color:"text.secondary",sx:{mb:.5},children:"에러 보정(EC Level)"}),e.jsx(Q,{value:je,onChange:a=>be(a.target.value),size:"small",children:ea.map(a=>e.jsx(O,{value:a.value,children:a.label},a.value))})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:1,children:[e.jsx(f,{...v,control:e.jsx(ce,{size:"small",checked:ye,onChange:a=>Ce(a.target.checked)}),label:"아이콘 사용"}),e.jsx(f,{...v,control:e.jsx(ce,{size:"small",checked:ke,onChange:a=>We(a.target.checked)}),label:"아이콘 둥글게",sx:{ml:0}})]}),e.jsxs(l,{display:"flex",gap:1,alignItems:"center",children:[e.jsx(w,{title:"아이콘 업로드",children:e.jsxs(X,{component:"label",size:"small",children:[e.jsx(Ke,{}),e.jsx("input",{hidden:!0,type:"file",accept:"image/*",onChange:a=>Ae(a.target.files?.[0]??null)})]})}),we&&e.jsx(I,{size:"small",onClick:Me,children:"아이콘 제거"})]}),e.jsxs(l,{children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"baseline",sx:{mb:.5},children:[e.jsx(c,{variant:"body2",children:"아이콘 크기"}),e.jsxs(c,{variant:"caption",color:"text.secondary",children:[Math.round(U*100),"%"]})]}),e.jsx(de,{value:U,onChange:(a,s)=>Ie(s),min:.05,max:.35,step:.01})]}),e.jsxs(l,{children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"baseline",sx:{mb:.5},children:[e.jsx(c,{variant:"body2",children:"아이콘 여백"}),e.jsxs(c,{variant:"caption",color:"text.secondary",children:[q.toFixed(0),"px"]})]}),e.jsx(de,{value:q,onChange:(a,s)=>Re(s),min:0,max:20,step:1})]}),e.jsxs(L,{fullWidth:!0,children:[e.jsx(c,{variant:"body2",color:"text.secondary",sx:{mb:.5},children:"아이콘 맞춤"}),e.jsx(Q,{value:Se,onChange:a=>Ee(a.target.value),size:"small",children:ta.map(a=>e.jsx(O,{value:a.value,children:a.label},a.value))})]})]}),e.jsx(Ye,{}),e.jsx(l,{sx:{position:"sticky",bottom:0,bgcolor:"background.paper",borderTop:"1px solid",borderColor:"divider"},children:e.jsx(P,{sx:{display:"flex",flexWrap:"wrap",gap:1,alignItems:"center",justifyContent:"space-between",overflowX:"hidden",minWidth:0},children:e.jsxs(l,{sx:{display:"flex",flexDirection:"column",gap:.75,minWidth:0,flex:"1 1 240px"},children:[e.jsxs(V,{direction:"row",spacing:1,alignItems:"center",flexWrap:"wrap",children:[e.jsx(n,{label:`내보내기 (최대 ${ue.toLocaleString()}px)`,type:"number",value:ze,onChange:a=>De(Number(a.target.value||Ze)),sx:{width:170,flexShrink:0},inputProps:{min:64,max:ue,step:1.25},size:"small"}),e.jsx(I,{variant:"outlined",color:"primary",size:"small",startIcon:e.jsx(xe,{}),onClick:()=>ae("png"),children:"PNG"}),e.jsx(I,{variant:"outlined",color:"primary",size:"small",startIcon:e.jsx(xe,{}),onClick:()=>ae("svg"),children:"SVG"})]}),e.jsxs(c,{variant:"caption",color:"text.secondary",children:["결과 크기: ",Pe.toLocaleString(),"px"]})]})})})]})]})})};export{da as default};

import{r as n,j as e}from"./vendor-CRMzTT1s.js";import{u as te,p as ne,P as re,S as l,a as B,a5 as oe,a9 as se,T as D,af as ae,n as _,ag as ie,a6 as ce,B as h,J as le,I as H,ah as de,ai as ue,aj as he}from"./mui-IYt3SN0d.js";import{M as Q}from"./monaco-editor-DhOCRkbO.js";import"./excel-CUMakpxJ.js";import"./tree-sitter-aGyQ8e2w.js";const me=o=>{if(!o.trim())return null;try{return JSON.parse(o)}catch(s){return s instanceof Error?s.message:String(s)}},J=o=>Array.isArray(o)?o.map(J):o&&typeof o=="object"?Object.keys(o).sort((s,d)=>s.localeCompare(d)).reduce((s,d)=>(s[d]=J(o[d]),s),{}):o,fe=(o,s)=>JSON.stringify(o,null,s),pe=()=>{const[o,s]=n.useState(""),[d,R]=n.useState(""),[M,j]=n.useState(null),[y,z]=n.useState(2),[v,T]=n.useState(!1),C=a=>s(a),x=a=>{const i=a.target.files?.[0];if(!i)return;const c=new FileReader;c.onload=()=>{const w=c.result;typeof w=="string"&&s(w)},c.readAsText(i)},g=n.useCallback(()=>{const a=me(o);if(typeof a=="string"){j(a);return}if(a===null){R(""),j(null);return}const i=v?J(a):a;R(fe(i,y)),j(null)},[o,y,v]);return{raw:o,formatted:d,error:M,indent:y,sortKeys:v,setIndent:z,setSortKeys:T,handleRawChange:C,handleUpload:x,handleFormat:g,handleDownload:()=>{const a=new Blob([d],{type:"application/json"}),i=URL.createObjectURL(a),c=document.createElement("a");c.href=i,c.download="formatted.json",c.click(),URL.revokeObjectURL(i)}}},q="calc(100dvh - 320px)",ye=()=>{const{raw:o,formatted:s,indent:d,sortKeys:R,setIndent:M,setSortKeys:j,handleRawChange:y,handleUpload:z,handleFormat:v,handleDownload:T}=pe(),C=n.useRef(null),x=te(),g=ne(x.breakpoints.up("md")),F=x.palette.mode==="dark"?"vs-dark":"vs-light",a=n.useRef(null),i=n.useRef(!1),c=n.useRef(null),w=n.useRef(null),P=n.useRef([]),m=n.useRef([]),[O,W]=n.useState(.5),[S,A]=n.useState(""),[I,k]=n.useState(-1),[f,N]=n.useState(0),V=O,Y=1-O,E=n.useCallback(()=>{c.current?.layout(),w.current?.layout()},[]);n.useEffect(()=>{E()},[O,E]);const K=n.useCallback(t=>Math.min(Math.max(t,.2),.8),[]),b=n.useCallback(t=>{if(!a.current)return;const r=a.current.getBoundingClientRect();r.width<=0||W(K((t-r.left)/r.width))},[K]),X=n.useCallback(()=>{i.current=!1,document.body.style.cursor="",document.body.style.userSelect=""},[]),$=n.useCallback(t=>{if(g)if(i.current=!0,document.body.style.cursor="col-resize",document.body.style.userSelect="none","touches"in t){const r=t.touches[0];r&&b(r.clientX)}else b(t.clientX)},[g,b]);n.useEffect(()=>{const t=p=>{i.current&&(p.preventDefault(),b(p.clientX))},r=p=>{if(!i.current)return;const L=p.touches[0];L&&(p.preventDefault(),b(L.clientX))},u=()=>X();return window.addEventListener("mousemove",t),window.addEventListener("mouseup",u),window.addEventListener("touchmove",r,{passive:!1}),window.addEventListener("touchend",u),window.addEventListener("touchcancel",u),()=>{window.removeEventListener("mousemove",t),window.removeEventListener("mouseup",u),window.removeEventListener("touchmove",r),window.removeEventListener("touchend",u),window.removeEventListener("touchcancel",u)}},[X,b]),n.useEffect(()=>{g||(i.current=!1,document.body.style.cursor="",document.body.style.userSelect="",W(.5))},[g]);const G=n.useCallback(t=>{const r=w.current;if(!r)return;const u=r.getModel();if(P.current=r.deltaDecorations(P.current,[]),m.current=[],N(0),k(-1),!u||!t.trim())return;const p=u.findMatches(t,!1,!1,!1,null,!0,200),L=p.map(U=>({range:U.range,options:{inlineClassName:"formatter-search-hit"}}));P.current=r.deltaDecorations([],L),m.current=p.map(U=>U.range),N(m.current.length),k(m.current.length?0:-1),m.current[0]&&(r.revealRangeInCenter(m.current[0]),r.setSelection(m.current[0]))},[]);n.useEffect(()=>{G(S)},[s,S,G]),n.useEffect(()=>{if(I<0)return;const t=w.current,r=m.current[I];t&&r&&(t.revealRangeInCenter(r),t.setSelection(r))},[I]);const Z=()=>{f&&k(t=>t<=0?f-1:t-1)},ee=()=>{f&&k(t=>t>=f-1||t<0?0:t+1)};return e.jsxs(re,{sx:{p:1.25,display:"flex",flexDirection:"column",gap:1.25,flex:1,minHeight:785,height:"100%",width:1,maxWidth:"100%",overflowX:"hidden"},children:[e.jsxs(l,{spacing:1,children:[e.jsx("input",{ref:C,type:"file",accept:"application/json",hidden:!0,onChange:z}),e.jsxs(l,{direction:"row",justifyContent:"space-between",alignItems:{md:"center"},spacing:1.25,flexWrap:"wrap",children:[e.jsx(B,{variant:"outlined",size:"small",color:"primary",startIcon:e.jsx(oe,{}),onClick:()=>C.current?.click(),children:"JSON 업로드"}),e.jsxs(l,{direction:"row",spacing:1,alignItems:{md:"center"},flexWrap:"wrap",children:[e.jsx(se,{control:e.jsx(ae,{size:"small",checked:R,onChange:t=>j(t.target.checked)}),label:e.jsx(D,{variant:"body2",children:"키 정렬"})}),e.jsxs(l,{direction:"row",spacing:1,alignItems:"center",flexWrap:"wrap",children:[e.jsx(D,{variant:"body2",color:"text.secondary",children:"공백 크기"}),e.jsx(_,{select:!0,size:"small",value:d,onChange:t=>M(Number(t.target.value)),SelectProps:{native:!0},sx:{width:80},children:[2,4,8].map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsx(B,{variant:"contained",size:"small",startIcon:e.jsx(ie,{}),onClick:v,children:"포맷"}),e.jsx(B,{variant:"outlined",size:"small",color:"primary",startIcon:e.jsx(ce,{}),onClick:T,disabled:!s,children:"다운로드"})]})]})]}),e.jsxs(h,{ref:a,sx:{display:"grid",flexDirection:"row",gridTemplateColumns:`minmax(0, ${V}fr) 6px minmax(0, ${Y}fr)`,gap:{xs:2,md:0},columnGap:{md:1},minHeight:0,flex:1,touchAction:"none"},children:[e.jsxs(l,{sx:{p:1.25,border:"1px solid",borderColor:"divider",borderRadius:1,bgcolor:"background.paper",display:"flex",flexDirection:"column",gap:1,minWidth:0,minHeight:0,overflow:"hidden"},children:[e.jsxs(l,{direction:"row",justifyContent:"space-between",alignItems:"center",spacing:1,children:[e.jsx(D,{variant:"subtitle2",color:"text.secondary",children:"원본 JSON"}),e.jsx(h,{sx:{width:220,height:40}})]}),e.jsx(h,{sx:{flex:1,height:q,minHeight:685,border:"1px solid",borderColor:"divider",borderRadius:1,overflow:"hidden"},children:e.jsx(Q,{height:"100%",language:"json",theme:F,value:o,onMount:t=>{c.current=t,E()},onChange:t=>y(t??""),options:{automaticLayout:!0,minimap:{enabled:!0},fontSize:13,padding:{top:1.25,bottom:8},scrollBeyondLastLine:!1}})})]}),g&&e.jsx(h,{sx:{width:6,justifySelf:"stretch",cursor:"col-resize",bgcolor:"divider","&:hover":{bgcolor:"action.hover"},borderRadius:1,display:"flex",alignItems:"center",justifyContent:"center",userSelect:"none"},onMouseDown:$,onTouchStart:$,children:e.jsxs(h,{sx:{display:"flex",flexDirection:"column",gap:.25},children:[e.jsx(h,{sx:{width:2,height:2,bgcolor:"text.secondary",borderRadius:"50%"}}),e.jsx(h,{sx:{width:2,height:2,bgcolor:"text.secondary",borderRadius:"50%"}}),e.jsx(h,{sx:{width:2,height:2,bgcolor:"text.secondary",borderRadius:"50%"}})]})}),e.jsxs(l,{sx:{p:1.25,border:"1px solid",borderColor:"divider",borderRadius:1,bgcolor:"background.paper",display:"flex",flexDirection:"column",gap:1,minWidth:0,minHeight:0,overflow:"hidden","& .formatter-search-hit":{backgroundColor:x.palette.warning.light,color:x.palette.getContrastText(x.palette.warning.light)}},children:[e.jsxs(l,{direction:{xs:"column",md:"row"},justifyContent:"space-between",alignItems:{md:"center"},spacing:1,children:[e.jsx(_,{fullWidth:!0,size:"small",placeholder:"키/값 검색",value:S,onChange:t=>A(t.target.value),InputProps:{endAdornment:S?e.jsx(le,{position:"end",children:e.jsx(H,{size:"small",onClick:()=>A(""),children:e.jsx(de,{fontSize:"small"})})}):void 0},sx:{minWidth:220}}),e.jsx(l,{direction:"row",spacing:1,alignItems:"center",sx:{width:"auto"},children:e.jsxs(l,{direction:"row",spacing:.5,alignItems:"center",sx:{whiteSpace:"nowrap"},children:[e.jsx(D,{variant:"caption",color:"text.secondary",children:f?`${I+1}/${f}`:"0/0"}),e.jsx(H,{size:"small",onClick:Z,disabled:!f,sx:{bgcolor:"action.hover"},children:e.jsx(ue,{fontSize:"small"})}),e.jsx(H,{size:"small",onClick:ee,disabled:!f,sx:{bgcolor:"action.hover"},children:e.jsx(he,{fontSize:"small"})})]})})]}),e.jsx(h,{sx:{flex:1,height:q,minHeight:685,border:"1px solid",borderColor:"divider",borderRadius:1,overflow:"hidden"},children:e.jsx(Q,{height:"100%",language:"json",theme:F,value:s,onMount:t=>{w.current=t,E()},options:{readOnly:!0,automaticLayout:!0,minimap:{enabled:!0},fontSize:13,padding:{top:1.25,bottom:8},scrollBeyondLastLine:!1}})})]})]})]})};export{ye as default};

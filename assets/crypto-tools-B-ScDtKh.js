import{r as i,w as t,j as r}from"./vendor-DuO8O3Ni.js";import{M as X}from"./monaco-editor-CUhaLqMq.js";import{u as he,p as ge,P as be,B as m,S as f,a1 as K,a2 as G,a3 as J,a4 as Q,n as q,X as M,T as j,a as Y,W as me}from"./mui-BrtMkxyc.js";import"./excel-CUMakpxJ.js";import"./monaco-p3yQZa36.js";const C={symmetric:{label:"양방향 (대칭키)",description:"동일한 키와 IV로 암호화/복호화합니다.",algorithms:[{label:"AES-128 (CBC)",value:"AES-128-CBC",keyLength:16,ivRequired:!0},{label:"AES-128 (ECB)",value:"AES-128-ECB",keyLength:16,ivRequired:!1},{label:"AES-192 (CBC)",value:"AES-192-CBC",keyLength:24,ivRequired:!0},{label:"AES-192 (ECB)",value:"AES-192-ECB",keyLength:24,ivRequired:!1},{label:"AES-256 (CBC)",value:"AES-256-CBC",keyLength:32,ivRequired:!0},{label:"AES-256 (ECB)",value:"AES-256-ECB",keyLength:32,ivRequired:!1},{label:"DES (CBC)",value:"DES-CBC",keyLength:8,ivRequired:!0},{label:"3DES (CBC)",value:"TripleDES-CBC",keyLength:24,ivRequired:!0},{label:"Rabbit",value:"Rabbit",keyLength:16,ivRequired:!1},{label:"Rabbit Legacy",value:"RabbitLegacy",keyLength:16,ivRequired:!1},{label:"RC4",value:"RC4",keyLength:16,ivRequired:!1},{label:"RC4Drop",value:"RC4Drop",keyLength:16,ivRequired:!1}]},oneway:{label:"단방향 (해시)",description:"복호화가 불가능한 해시 알고리즘입니다.",algorithms:[{label:"SHA-256 (256bit)",value:"SHA256"},{label:"SHA-512 (512bit)",value:"SHA512"},{label:"MD5 (128bit)",value:"MD5"},{label:"SHA-1 (160bit)",value:"SHA1"},{label:"SHA-3 (512bit)",value:"SHA3"},{label:"RIPEMD160",value:"RIPEMD160"}]},encoding:{label:"인코딩/디코딩",description:"Base64·URL 인코딩을 빠르게 확인합니다.",algorithms:[{label:"Base64",value:"BASE64"},{label:"Base64 (No Padding)",value:"BASE64_NOPAD"},{label:"Base64 (URL-Safe)",value:"BASE64_URLSAFE"},{label:"Base64 (URL-Safe + Padding)",value:"BASE64_URLSAFE_PAD"},{label:"URL Encoding",value:"URL"}]}},fe=(e,g,o,n)=>{const l=t.enc.Utf8.parse(g),a={padding:t.pad.Pkcs7};switch(n.includes("CBC")&&(a.mode=t.mode.CBC,o&&(a.iv=t.enc.Utf8.parse(o))),n.includes("ECB")&&(a.mode=t.mode.ECB),!0){case n.startsWith("AES"):return t.AES.encrypt(e,l,a).toString();case n.startsWith("DES"):return t.DES.encrypt(e,l,a).toString();case n.startsWith("TripleDES"):return t.TripleDES.encrypt(e,l,a).toString();case n==="Rabbit":return t.Rabbit.encrypt(e,l,a).toString();case n==="RabbitLegacy":return t.RabbitLegacy.encrypt(e,l,a).toString();case n==="RC4":return t.RC4.encrypt(e,l,a).toString();case n==="RC4Drop":return t.RC4Drop.encrypt(e,l,a).toString();default:throw new Error("지원하지 않는 알고리즘")}},ye=(e,g,o,n)=>{const l=t.enc.Utf8.parse(g),a={padding:t.pad.Pkcs7};n.includes("CBC")&&(a.mode=t.mode.CBC,o&&(a.iv=t.enc.Utf8.parse(o))),n.includes("ECB")&&(a.mode=t.mode.ECB);let c;switch(!0){case n.startsWith("AES"):c=t.AES.decrypt(e,l,a);break;case n.startsWith("DES"):c=t.DES.decrypt(e,l,a);break;case n.startsWith("TripleDES"):c=t.TripleDES.decrypt(e,l,a);break;case n==="Rabbit":c=t.Rabbit.decrypt(e,l,a);break;case n==="RabbitLegacy":c=t.RabbitLegacy.decrypt(e,l,a);break;case n==="RC4":c=t.RC4.decrypt(e,l,a);break;case n==="RC4Drop":c=t.RC4Drop.decrypt(e,l,a);break;default:throw new Error("지원하지 않는 알고리즘")}return c.toString(t.enc.Utf8)},ve=(e,g,o="")=>{const n=`${e}${o}`;switch(g){case"SHA1":return t.SHA1(n).toString();case"SHA512":return t.SHA512(n).toString();case"MD5":return t.MD5(n).toString();case"SHA3":return t.SHA3(n,{outputLength:512}).toString();case"RIPEMD160":return t.RIPEMD160(n).toString();case"SHA256":default:return t.SHA256(n).toString()}},Z=(e,g,o)=>{switch(g){case"BASE64":return o==="encode"?t.enc.Base64.stringify(t.enc.Utf8.parse(e)):t.enc.Base64.parse(e).toString(t.enc.Utf8);case"BASE64_NOPAD":return o==="encode"?t.enc.Base64.stringify(t.enc.Utf8.parse(e)).replace(/=+$/u,""):t.enc.Base64.parse(e.padEnd(e.length+(4-e.length%4)%4,"=")).toString(t.enc.Utf8);case"BASE64_URLSAFE":{if(o==="encode")return t.enc.Base64.stringify(t.enc.Utf8.parse(e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/u,"");const n=e.replace(/-/g,"+").replace(/_/g,"/"),l=(4-n.length%4)%4,a=n+"=".repeat(l);return t.enc.Base64.parse(a).toString(t.enc.Utf8)}case"BASE64_URLSAFE_PAD":{if(o==="encode")return t.enc.Base64.stringify(t.enc.Utf8.parse(e)).replace(/\+/g,"-").replace(/\//g,"_");const n=e.replace(/-/g,"+").replace(/_/g,"/");return t.enc.Base64.parse(n).toString(t.enc.Utf8)}case"URL":return o==="encode"?encodeURIComponent(e):decodeURIComponent(e);default:throw new Error("지원하지 않는 인코딩 유형입니다.")}},Se=()=>{const[e,g]=i.useState("symmetric"),[o,n]=i.useState(C.symmetric.algorithms[0]?.value??""),[l,a]=i.useState(""),[c,E]=i.useState(""),[R,k]=i.useState(""),d=i.useMemo(()=>C[e].algorithms.find(p=>p.value===o),[e,o]),B=i.useCallback(()=>{a(""),E(""),k("")},[]),U=i.useCallback(p=>{g(p);const u=C[p].algorithms[0]?.value??"";n(u),a(""),E(""),k("")},[]),v=i.useCallback(()=>d?d.keyLength&&l.length!==d.keyLength?`키는 ${d.keyLength}자리를 정확히 맞춰주세요.`:d.ivRequired&&c.length!==16?"IV는 16자리를 입력해야 합니다.":null:"알고리즘을 다시 선택해 주세요.",[c.length,l.length,d]),D=i.useCallback(p=>{if(!p.trim())return{ok:!1,error:"먼저 입력값을 채워주세요."};try{if(e==="symmetric"){const u=v();return u?{ok:!1,error:u}:{ok:!0,value:fe(p,l,c,o)}}return e==="encoding"?{ok:!0,value:Z(p,o,"encode")}:{ok:!0,value:ve(p,o,R)}}catch(u){return console.error(u),{ok:!1,error:"암호화 처리 중 오류가 발생했습니다."}}},[c,l,e,R,v,o]),y=i.useCallback(p=>{if(e==="oneway")return{ok:!1,error:"단방향(해시)은 복호화할 수 없습니다."};if(!p.trim())return{ok:!1,error:"복호화할 값을 입력하세요."};try{if(e==="encoding")return{ok:!0,value:Z(p,o,"decode")};const u=v();return u?{ok:!1,error:u}:{ok:!0,value:ye(p,l,c,o)}}catch(u){return console.error(u),{ok:!1,error:"복호화에 실패했습니다. 키/IV/암호문을 확인하세요."}}},[c,l,e,v,o]);return{mode:e,setMode:U,variant:o,setVariant:n,key:l,setKey:a,iv:c,setIv:E,salt:R,setSalt:k,selectedAlgorithm:d,groupMeta:C[e],encrypt:D,decrypt:y,resetFields:B}},ee="min(60dvh, calc(100dvh - 300px))",te="calc(100dvh - 420px)",we=()=>{const{mode:e,setMode:g,variant:o,setVariant:n,key:l,setKey:a,iv:c,setIv:E,salt:R,setSalt:k,selectedAlgorithm:d,groupMeta:B,encrypt:U,decrypt:v}=Se(),D=he(),y=ge(D.breakpoints.up("md")),p=D.palette.mode==="dark"?"vs-dark":"vs-light",[u,I]=i.useState(""),[H,W]=i.useState(""),[P,S]=i.useState(null),[_,w]=i.useState(null),re=e==="encoding"?"Encode":"암호화 (Encrypt)",ne=e==="encoding"?"Decode":"복호화 (Decrypt)",T=i.useRef(null),L=i.useRef(!1),[z,V]=i.useState(.5),se=z,ae=1-z,F=i.useCallback(s=>Math.min(Math.max(s,.2),.8),[]),x=i.useCallback(s=>{if(!T.current)return;const h=T.current.getBoundingClientRect();if(h.width<=0)return;const b=(s-h.left)/h.width;V(F(b))},[F]),$=i.useCallback(()=>{L.current=!1,document.body.style.cursor="",document.body.style.userSelect=""},[]),N=i.useCallback(s=>{if(y)if(L.current=!0,document.body.style.cursor="col-resize",document.body.style.userSelect="none","touches"in s){const h=s.touches[0];h&&x(h.clientX)}else x(s.clientX)},[y,x]);i.useEffect(()=>{const s=A=>{L.current&&(A.preventDefault(),x(A.clientX))},h=A=>{if(!L.current)return;const O=A.touches[0];O&&(A.preventDefault(),x(O.clientX))},b=()=>$();return window.addEventListener("mousemove",s),window.addEventListener("mouseup",b),window.addEventListener("touchmove",h,{passive:!1}),window.addEventListener("touchend",b),window.addEventListener("touchcancel",b),()=>{window.removeEventListener("mousemove",s),window.removeEventListener("mouseup",b),window.removeEventListener("touchmove",h),window.removeEventListener("touchend",b),window.removeEventListener("touchcancel",b)}},[$,x]),i.useEffect(()=>{y||(L.current=!1,document.body.style.cursor="",document.body.style.userSelect="",V(.5))},[y]);const le=i.useMemo(()=>`${u.length} chars`,[u]),oe=i.useMemo(()=>`${H.length} chars`,[H]),ie=s=>{g(s.target.value),I(""),W(""),S(null),w(null)},ce=()=>{const s=U(u);if(!s.ok){S({type:"error",text:s.error}),w(null);return}S({type:"success",text:"암호화가 완료되었습니다. 결과 영역을 확인하세요."}),W(s.value),w("encrypt")},de=()=>{const s=v(u);if(!s.ok){S({type:"error",text:s.error}),w(null);return}S({type:"success",text:"복호화된 평문을 결과 영역에서 확인할 수 있습니다."}),W(s.value),w("decrypt")},ue=e==="oneway",pe=e==="oneway";return r.jsxs(be,{sx:{p:1.25,display:"flex",flexDirection:"column",gap:1.25,flex:1,minHeight:785,height:"100%",width:1,maxWidth:"100%",overflowX:"hidden"},children:[r.jsx(m,{sx:{p:1.25,border:"1px solid",borderColor:"divider",borderRadius:2,bgcolor:"background.paper"},children:r.jsxs(f,{spacing:1.25,children:[r.jsxs(f,{direction:"row",spacing:1.25,alignItems:"stretch",children:[r.jsxs(K,{size:"small",sx:{minWidth:200},fullWidth:!0,children:[r.jsx(G,{id:"crypto-mode-label",children:"암복호화 유형"}),r.jsx(J,{labelId:"crypto-mode-label",value:e,label:"암복호화 유형",onChange:ie,children:Object.entries(C).map(([s,h])=>r.jsx(Q,{value:s,children:h.label},s))})]}),r.jsxs(K,{size:"small",sx:{minWidth:220},fullWidth:!0,children:[r.jsx(G,{id:"crypto-algorithm-label",children:"알고리즘"}),r.jsx(J,{labelId:"crypto-algorithm-label",value:o,label:"알고리즘",onChange:s=>n(s.target.value),children:C[e].algorithms.map(s=>r.jsx(Q,{value:s.value,children:s.label},s.value))})]}),e==="symmetric"&&r.jsx(q,{size:"small",label:"Key",fullWidth:!0,value:l,onChange:s=>{const h=s.target.value,b=d?.keyLength??h.length;a(h.slice(0,b))},helperText:d?.keyLength?`정확히 ${d.keyLength}자 입력`:"필요 시 원하는 길이로 입력"}),d?.ivRequired&&r.jsx(q,{size:"small",label:"IV",fullWidth:!0,value:c,onChange:s=>E(s.target.value.slice(0,16)),helperText:"CBC 모드는 16자 IV 필수"}),ue&&r.jsx(q,{size:"small",label:"Salt",fullWidth:!0,value:R,onChange:s=>k(s.target.value),helperText:"선택 입력 · 동일 값을 반복 사용"})]}),r.jsxs(f,{direction:"row",spacing:1.25,alignItems:{xs:"stretch",sm:"center"},justifyContent:"space-between",children:[r.jsxs(m,{children:[r.jsxs(f,{direction:"row",spacing:1,flexWrap:"wrap",children:[r.jsx(M,{size:"small",color:"primary",variant:"outlined",label:B.label}),d&&r.jsx(M,{size:"small",label:d.label}),d?.keyLength&&r.jsx(M,{size:"small",variant:"outlined",label:`Key ${d.keyLength}자`}),e==="symmetric"&&d?.ivRequired&&r.jsx(M,{size:"small",label:"IV 필요"})]}),r.jsx(j,{variant:"caption",color:"text.secondary",display:"block",mt:.75,children:B.description})]}),r.jsxs(f,{direction:"row",spacing:1,width:"auto",children:[r.jsx(Y,{variant:"contained",fullWidth:!0,onClick:ce,children:re}),r.jsx(Y,{variant:"outlined",fullWidth:!0,color:"primary",onClick:de,disabled:pe,children:ne})]})]})]})}),P&&r.jsx(me,{severity:P.type,onClose:()=>S(null),sx:{borderRadius:2},children:P.text}),r.jsxs(m,{ref:T,sx:{flex:1,minHeight:0,width:1,display:{xs:"flex",md:"grid"},flexDirection:{xs:"column",md:"row"},gridTemplateColumns:{md:`minmax(0, ${se}fr) 6px minmax(0, ${ae}fr)`},gap:{xs:2,md:0},columnGap:{md:1.5},alignItems:"stretch",overflow:"hidden",touchAction:"none",contain:"size layout paint"},children:[r.jsxs(f,{sx:{p:{xs:1,md:1.5},border:"1px solid",borderColor:"divider",borderRadius:2,bgcolor:"background.paper",display:"flex",flexDirection:"column",gap:1,minWidth:0,minHeight:0,overflow:"hidden"},children:[r.jsxs(f,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[r.jsx(j,{variant:"subtitle1",children:"입력 (Plain / Cipher)"}),r.jsx(j,{variant:"caption",color:"text.secondary",children:le})]}),r.jsx(m,{sx:{flex:1,height:{xs:ee,md:te},border:"1px solid",borderColor:"divider",borderRadius:1.5,overflow:"hidden",bgcolor:"background.default"},children:r.jsx(X,{height:"100%",defaultLanguage:"plaintext",theme:p,value:u,onChange:s=>I(s??""),options:{wordWrap:"on",minimap:{enabled:!1},scrollBeyondLastLine:!1,automaticLayout:!0}})})]}),r.jsx(m,{sx:{display:{xs:"none",md:"flex"},width:6,justifySelf:"stretch",cursor:y?"col-resize":"default",bgcolor:"divider",borderRadius:1,alignItems:"center",justifyContent:"center",userSelect:"none"},role:"separator","aria-orientation":"vertical",onMouseDown:N,onTouchStart:N,children:r.jsxs(m,{sx:{display:"flex",flexDirection:"column",gap:.25},children:[r.jsx(m,{sx:{width:2,height:2,bgcolor:"text.secondary",borderRadius:"50%"}}),r.jsx(m,{sx:{width:2,height:2,bgcolor:"text.secondary",borderRadius:"50%"}}),r.jsx(m,{sx:{width:2,height:2,bgcolor:"text.secondary",borderRadius:"50%"}})]})}),r.jsxs(f,{sx:{p:{xs:1,md:1.5},border:"1px solid",borderColor:"divider",borderRadius:2,bgcolor:"background.paper",display:"flex",flexDirection:"column",gap:1,minWidth:0,minHeight:0,overflow:"hidden"},children:[r.jsxs(f,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[r.jsxs(j,{variant:"subtitle1",children:["결과 ",_?_==="encrypt"?"(암호문)":"(평문)":""]}),r.jsx(j,{variant:"caption",color:"text.secondary",children:oe})]}),r.jsx(m,{sx:{flex:1,height:{xs:ee,md:te},border:"1px solid",borderColor:"divider",borderRadius:1.5,overflow:"hidden",bgcolor:"background.default"},children:r.jsx(X,{height:"100%",defaultLanguage:"plaintext",theme:p,value:H,onChange:()=>{},options:{wordWrap:"on",minimap:{enabled:!1},scrollBeyondLastLine:!1,automaticLayout:!0,readOnly:!0}})})]})]})]})};export{we as default};
